<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Blog|CasonMo</title>
  
  
  <link href="https://cason.work/atom.xml" rel="self"/>
  
  <link href="https://cason.work/"/>
  <updated>2024-04-07T09:59:40.529Z</updated>
  <id>https://cason.work/</id>
  
  <author>
    <name>Cason Mo</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hexo giscusé…ç½®è¯„è®ºåŠŸèƒ½</title>
    <link href="https://cason.work/2024/04/07/Hexo-giscus%E9%85%8D%E7%BD%AE%E8%AF%84%E8%AE%BA%E5%8A%9F%E8%83%BD/"/>
    <id>https://cason.work/2024/04/07/Hexo-giscus%E9%85%8D%E7%BD%AE%E8%AF%84%E8%AE%BA%E5%8A%9F%E8%83%BD/</id>
    <published>2024-04-07T09:55:23.000Z</published>
    <updated>2024-04-07T09:59:40.529Z</updated>
    
    <content type="html"><![CDATA[<p>settings-&gt;General-&gt;Features</p><p>å·²åœ¨ä½ çš„ä»“åº“ä¸­å¯ç”¨DiscussionsåŠŸèƒ½</p><p>![image-20240407175728062](..&#x2F;..&#x2F;..&#x2F;..&#x2F;Library&#x2F;Mobile Documents&#x2F;com<del>apple</del>CloudDocs&#x2F;typora&#x2F;images&#x2F;image-20240407175728062.png)</p><p>å®‰è£…gisacus <a href="https://github.com/apps/giscus">https://github.com/apps/giscus</a></p><p>![image-20240407175530551](..&#x2F;..&#x2F;..&#x2F;..&#x2F;Library&#x2F;Mobile Documents&#x2F;com<del>apple</del>CloudDocs&#x2F;typora&#x2F;images&#x2F;image-20240407175530551.png)</p><p>![image-20240407175638999](..&#x2F;..&#x2F;..&#x2F;..&#x2F;Library&#x2F;Mobile Documents&#x2F;com<del>apple</del>CloudDocs&#x2F;typora&#x2F;images&#x2F;image-20240407175638999.png)</p><p>çœ‹åˆ°repo-id</p><p>![image-20240407175938792](..&#x2F;..&#x2F;..&#x2F;..&#x2F;Library&#x2F;Mobile Documents&#x2F;com<del>apple</del>CloudDocs&#x2F;typora&#x2F;images&#x2F;image-20240407175938792.png)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;settings-&amp;gt;General-&amp;gt;Features&lt;/p&gt;
&lt;p&gt;å·²åœ¨ä½ çš„ä»“åº“ä¸­å¯ç”¨DiscussionsåŠŸèƒ½&lt;/p&gt;
&lt;p&gt;![image-20240407175728062](..&amp;#x2F;..&amp;#x2F;..&amp;#x2F;..&amp;#x2F;Library</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨Github-ActionæŒç»­éƒ¨ç½²Springbootæˆ–vue</title>
    <link href="https://cason.work/2024/01/11/%E4%BD%BF%E7%94%A8Github-Action%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2Springboot%E6%88%96vue/"/>
    <id>https://cason.work/2024/01/11/%E4%BD%BF%E7%94%A8Github-Action%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2Springboot%E6%88%96vue/</id>
    <published>2024-01-11T02:45:13.000Z</published>
    <updated>2024-01-11T03:20:54.861Z</updated>
    
    <content type="html"><![CDATA[<p>GitHub Actions æ˜¯ GitHub æä¾›çš„ä¸€é¡¹æŒç»­é›†æˆ (CI) å’ŒæŒç»­éƒ¨ç½² (CD) æœåŠ¡ã€‚å®ƒå…è®¸ä½ åœ¨ä»£ç ä»“åº“ä¸­å®šä¹‰å’Œè¿è¡Œè‡ªåŠ¨åŒ–çš„å·¥ä½œæµç¨‹ï¼Œä»¥å“åº”å­˜å‚¨åº“ä¸­çš„äº‹ä»¶æˆ–è°ƒåº¦ã€‚GitHub Actions å¯ä»¥ç”¨äºæ„å»ºã€æµ‹è¯•ã€æ‰“åŒ…å’Œéƒ¨ç½²é¡¹ç›®ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œå…¶ä»–è‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚</p><blockquote><p>è¯¦ç»†github actionç›¸å…³ä¿¡æ¯è¯·çœ‹æœ€åº•éƒ¨</p></blockquote><p><strong>ç¬¬ä¸€æ­¥éœ€è¦å…ˆé…ç½®secretsï¼Œä¿è¯æˆ‘ä»¬çš„æœåŠ¡å™¨ä¿¡æ¯ä¸æš´éœ²</strong></p><p>GitHub Actions ä¸­çš„ secrets å’Œ variables éƒ½æ˜¯ç”¨äºå­˜å‚¨å’Œè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–é…ç½®çš„æœºåˆ¶</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/image-20240111105350117.png" alt="image-20240111105350117"></p><p>å› ä¸ºæˆ‘çš„æœåŠ¡å™¨ç”¨çš„å®å¡”é¢æ¿ç¯å¢ƒï¼ŒåŠ ä¸Šæ„å»ºå‡ºæ¥çš„åŒ…å’Œæ–‡ä»¶å¹¶ä¸æ˜¯å¾ˆå¤§ï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ–¹å¼æ˜¯å…ˆåœ¨github actionçš„ç¯å¢ƒæ„å»ºæ‰“åŒ…ï¼Œç„¶åå°†åŒ…å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨github actioné‡Œè®©ç›®æ ‡æœåŠ¡å™¨æ‰§è¡Œå‘½ä»¤å»åšgitï¼Œæ„å»ºï¼Œéƒ¨ç½²ï¼Œå¯åŠ¨ç­‰ç­‰ç›¸å…³çš„</p><h2 id="Springboot"><a href="#Springboot" class="headerlink" title="Springboot"></a>Springboot</h2><figure class="highlight yaml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Java</span> <span class="hljs-string">CI</span> <span class="hljs-string">with</span> <span class="hljs-string">Maven</span><br><br><span class="hljs-attr">on:</span><br>  <span class="hljs-attr">push:</span><br>    <span class="hljs-attr">branches:</span> [ <span class="hljs-string">&quot;master&quot;</span> ]<br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">build:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <br>    <span class="hljs-attr">steps:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Set</span> <span class="hljs-string">up</span> <span class="hljs-string">JDK</span> <span class="hljs-number">17</span><br>      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-java@v3</span><br>      <span class="hljs-attr">with:</span><br>        <span class="hljs-attr">java-version:</span> <span class="hljs-string">&#x27;17&#x27;</span><br>        <span class="hljs-attr">distribution:</span> <span class="hljs-string">&#x27;temurin&#x27;</span><br>        <span class="hljs-attr">cache:</span> <span class="hljs-string">maven</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">with</span> <span class="hljs-string">Maven</span><br>      <span class="hljs-attr">run:</span> <span class="hljs-string">mvn</span> <span class="hljs-string">-B</span> <span class="hljs-string">package</span> <span class="hljs-string">--file</span> <span class="hljs-string">pom.xml</span><br><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">copy</span> <span class="hljs-string">jar</span><br>      <span class="hljs-attr">uses:</span> <span class="hljs-string">cross-the-world/ssh-scp-ssh-pipelines@latest</span><br>      <span class="hljs-attr">with:</span><br>        <span class="hljs-attr">host:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.HOST</span> <span class="hljs-string">&#125;&#125;</span><br>        <span class="hljs-attr">user:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.USERNAME</span> <span class="hljs-string">&#125;&#125;</span><br>        <span class="hljs-attr">pass:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.PASSWORD</span> <span class="hljs-string">&#125;&#125;</span><br>        <span class="hljs-attr">port:</span> <span class="hljs-number">22</span><br>        <span class="hljs-attr">scp:</span> <span class="hljs-string">|</span><br><span class="hljs-string">          ./target/springboot.jar =&gt; /home/</span><br><span class="hljs-string"></span>        <span class="hljs-attr">last_ssh:</span> <span class="hljs-string">|</span><br><span class="hljs-string">          JAR_NAME=&quot;springboot.jar&quot;; PID=$(ps aux | grep &quot;$JAR_NAME&quot; | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27;); if [ -n &quot;$PID&quot; ]; then kill -9 $PID &amp;&amp; echo &quot;è¿›ç¨‹ $PID å·²è¢«æ€æ­»&quot;; else echo &quot;æœªæ‰¾åˆ°ä¸ $JAR_NAME ç›¸å…³çš„è¿›ç¨‹&quot;; fi</span><br><span class="hljs-string">          /usr/bin/java -jar -Xmx1024M -Xms256M  /home/springboot.jar &amp;</span><br></code></pre></td></tr></table></figure><h2 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">Server</span><br><span class="hljs-attr">on:</span><br>  <span class="hljs-attr">push:</span><br>    <span class="hljs-attr">branches:</span> [ <span class="hljs-string">&quot;master&quot;</span> ]<br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">deploy:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span> <br><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v3</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-attr">node-version:</span> <span class="hljs-number">16</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">dependencies</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">yarn</span> <br><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">project</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">yarn</span> <span class="hljs-string">generate</span> <br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">zip</span> <span class="hljs-string">dist</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">zip</span> <span class="hljs-string">-r</span> <span class="hljs-string">dist.zip</span> <span class="hljs-string">dist/</span><br><br>        <span class="hljs-comment"># éƒ¨ç½²åˆ°æœåŠ¡å™¨</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">ğŸš€</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">cross-the-world/ssh-scp-ssh-pipelines@latest</span><br>        <span class="hljs-attr">with:</span><br>            <span class="hljs-attr">host:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.HOST</span> <span class="hljs-string">&#125;&#125;</span><br>            <span class="hljs-attr">user:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.USERNAME</span> <span class="hljs-string">&#125;&#125;</span><br>            <span class="hljs-attr">pass:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.PASSWORD</span> <span class="hljs-string">&#125;&#125;</span><br>            <span class="hljs-attr">port:</span> <span class="hljs-number">22</span><br>            <span class="hljs-attr">scp:</span> <span class="hljs-string">|</span><br><span class="hljs-string">                &#x27;./dist.zip&#x27; =&gt; /home</span><br><span class="hljs-string"></span>            <span class="hljs-attr">last_ssh:</span> <span class="hljs-string">|</span><br><span class="hljs-string">                cd /home/</span><br><span class="hljs-string">                rm -rf dist/ || true</span><br><span class="hljs-string">                unzip dist.zip</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><h2 id="å¸¸è§çš„-GitHub-Actions-YAML-è¯­æ³•å’Œå…³é”®æ¦‚å¿µ"><a href="#å¸¸è§çš„-GitHub-Actions-YAML-è¯­æ³•å’Œå…³é”®æ¦‚å¿µ" class="headerlink" title="å¸¸è§çš„ GitHub Actions YAML è¯­æ³•å’Œå…³é”®æ¦‚å¿µ"></a>å¸¸è§çš„ GitHub Actions YAML è¯­æ³•å’Œå…³é”®æ¦‚å¿µ</h2><p>GitHub Actions ä½¿ç”¨ YAML æ–‡ä»¶æ¥å®šä¹‰å·¥ä½œæµç¨‹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ GitHub Actions YAML è¯­æ³•å’Œå…³é”®æ¦‚å¿µï¼š</p><h3 id="å·¥ä½œæµç¨‹ï¼ˆWorkflowï¼‰çš„å®šä¹‰ï¼š"><a href="#å·¥ä½œæµç¨‹ï¼ˆWorkflowï¼‰çš„å®šä¹‰ï¼š" class="headerlink" title="å·¥ä½œæµç¨‹ï¼ˆWorkflowï¼‰çš„å®šä¹‰ï¼š"></a>å·¥ä½œæµç¨‹ï¼ˆWorkflowï¼‰çš„å®šä¹‰ï¼š</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">My</span> <span class="hljs-string">Workflow</span><br><span class="hljs-attr">on:</span><br>  <span class="hljs-attr">push:</span><br>    <span class="hljs-attr">branches:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">main</span><br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">my_job:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span> <span class="hljs-string">Repository</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span><br>      <span class="hljs-comment"># å…¶ä»–æ­¥éª¤...</span><br></code></pre></td></tr></table></figure><ul><li><code>name</code>: å·¥ä½œæµç¨‹çš„åç§°ã€‚</li><li><code>on</code>: è§¦å‘å·¥ä½œæµç¨‹çš„äº‹ä»¶ï¼Œä¾‹å¦‚ <code>push</code> åˆ°ç‰¹å®šåˆ†æ”¯ã€‚</li><li><code>jobs</code>: åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªä»»åŠ¡çš„éƒ¨åˆ†ã€‚</li></ul><h3 id="ä»»åŠ¡ï¼ˆJobï¼‰çš„å®šä¹‰ï¼š"><a href="#ä»»åŠ¡ï¼ˆJobï¼‰çš„å®šä¹‰ï¼š" class="headerlink" title="ä»»åŠ¡ï¼ˆJobï¼‰çš„å®šä¹‰ï¼š"></a><strong>ä»»åŠ¡ï¼ˆJobï¼‰çš„å®šä¹‰ï¼š</strong></h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">my_job:</span><br>  <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>  <span class="hljs-attr">steps:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Step</span> <span class="hljs-number">1</span><br>      <span class="hljs-attr">run:</span> <span class="hljs-string">echo</span> <span class="hljs-string">&quot;Hello, World!&quot;</span><br>    <span class="hljs-comment"># å…¶ä»–æ­¥éª¤...</span><br></code></pre></td></tr></table></figure><ul><li><code>runs-on</code>: æŒ‡å®šä»»åŠ¡è¿è¡Œçš„æ“ä½œç³»ç»Ÿå’Œç¯å¢ƒã€‚</li><li><code>steps</code>: åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ­¥éª¤çš„åˆ—è¡¨ã€‚</li></ul><h3 id="æ­¥éª¤ï¼ˆStepsï¼‰çš„å®šä¹‰ï¼š"><a href="#æ­¥éª¤ï¼ˆStepsï¼‰çš„å®šä¹‰ï¼š" class="headerlink" title="æ­¥éª¤ï¼ˆStepsï¼‰çš„å®šä¹‰ï¼š"></a><strong>æ­¥éª¤ï¼ˆStepsï¼‰çš„å®šä¹‰ï¼š</strong></h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">steps:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Step</span> <span class="hljs-number">1</span><br>    <span class="hljs-attr">run:</span> <span class="hljs-string">echo</span> <span class="hljs-string">&quot;Hello, World!&quot;</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Step</span> <span class="hljs-number">2</span><br>    <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v3</span><br>    <span class="hljs-attr">with:</span><br>      <span class="hljs-attr">node-version:</span> <span class="hljs-string">&#x27;14&#x27;</span><br>  <span class="hljs-comment"># å…¶ä»–æ­¥éª¤...</span><br></code></pre></td></tr></table></figure><ul><li><code>name</code>: æ­¥éª¤çš„åç§°ã€‚</li><li><code>run</code>: æ‰§è¡Œçš„å‘½ä»¤æˆ–è„šæœ¬ã€‚</li><li><code>uses</code>: ä½¿ç”¨çš„åŠ¨ä½œï¼ˆå¯ä»¥æ˜¯å†…ç½®åŠ¨ä½œæˆ–è‡ªå®šä¹‰åŠ¨ä½œï¼‰ã€‚</li><li><code>with</code>: ä¼ é€’ç»™åŠ¨ä½œçš„å‚æ•°ã€‚</li></ul><h3 id="è§¦å‘å™¨ï¼ˆTriggerï¼‰çš„å®šä¹‰ï¼š"><a href="#è§¦å‘å™¨ï¼ˆTriggerï¼‰çš„å®šä¹‰ï¼š" class="headerlink" title="è§¦å‘å™¨ï¼ˆTriggerï¼‰çš„å®šä¹‰ï¼š"></a><strong>è§¦å‘å™¨ï¼ˆTriggerï¼‰çš„å®šä¹‰ï¼š</strong></h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">on:</span><br>  <span class="hljs-attr">push:</span><br>    <span class="hljs-attr">branches:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">main</span><br>  <span class="hljs-attr">pull_request:</span><br>    <span class="hljs-attr">branches:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">feature/*</span><br></code></pre></td></tr></table></figure><ul><li><code>on</code>: è§¦å‘å·¥ä½œæµç¨‹çš„äº‹ä»¶ã€‚</li><li><code>push</code>: ä»£ç æ¨é€äº‹ä»¶ã€‚</li><li><code>pull_request</code>: åˆå¹¶è¯·æ±‚äº‹ä»¶ã€‚</li></ul><h3 id="ç¯å¢ƒå˜é‡ï¼ˆEnvironment-Variablesï¼‰çš„å®šä¹‰ï¼š"><a href="#ç¯å¢ƒå˜é‡ï¼ˆEnvironment-Variablesï¼‰çš„å®šä¹‰ï¼š" class="headerlink" title="ç¯å¢ƒå˜é‡ï¼ˆEnvironment Variablesï¼‰çš„å®šä¹‰ï¼š"></a><strong>ç¯å¢ƒå˜é‡ï¼ˆEnvironment Variablesï¼‰çš„å®šä¹‰ï¼š</strong></h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">my_job:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attr">env:</span><br>      <span class="hljs-attr">MY_VARIABLE:</span> <span class="hljs-string">my_value</span><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-comment"># æ­¥éª¤...</span><br></code></pre></td></tr></table></figure><ul><li><code>env</code>: å®šä¹‰ä»»åŠ¡è¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡ã€‚</li></ul><h2 id="Secrets-å’Œ-Variables"><a href="#Secrets-å’Œ-Variables" class="headerlink" title="Secrets å’Œ Variables"></a>Secrets å’Œ Variables</h2><h3 id="ä½¿ç”¨-Secretsï¼š"><a href="#ä½¿ç”¨-Secretsï¼š" class="headerlink" title="ä½¿ç”¨ Secretsï¼š"></a>ä½¿ç”¨ Secretsï¼š</h3><p>GitHub Actions çš„ secrets æ˜¯ç”¨äºå­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ API å¯†é’¥ã€è®¿é—®ä»¤ç‰Œç­‰ã€‚è¿™äº› secrets å¯ä»¥è¢«å·¥ä½œæµç¨‹ä¸­çš„æ­¥éª¤å¼•ç”¨ï¼Œä½†å®ƒä»¬æ˜¯åŠ å¯†çš„ï¼Œå¹¶ä¸”åªæœ‰åœ¨è¿è¡Œå·¥ä½œæµç¨‹æ—¶æ‰ä¼šæš´éœ²ç»™æ­¥éª¤ã€‚</p><ol><li><p><strong>åœ¨ GitHub å­˜å‚¨åº“ä¸­åˆ›å»º secretï¼š</strong></p><ul><li>è½¬åˆ° GitHub å­˜å‚¨åº“çš„é¡µé¢ã€‚</li><li>åœ¨å­˜å‚¨åº“é¡¶éƒ¨å¯¼èˆªæ ä¸­ï¼Œç‚¹å‡» â€œSettingsâ€ã€‚</li><li>åœ¨å·¦ä¾§è¾¹æ ä¸­ï¼Œé€‰æ‹© â€œSecretsâ€ã€‚</li><li>ç‚¹å‡» â€œNew repository secretâ€ï¼Œç„¶åè¾“å…¥ secret åç§°å’Œå€¼ã€‚</li></ul></li><li><p><strong>åœ¨å·¥ä½œæµç¨‹ä¸­ä½¿ç”¨ secretï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">my_job:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Use</span> <span class="hljs-string">secret</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">echo</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.MY_SECRET</span> <span class="hljs-string">&#125;&#125;</span><br></code></pre></td></tr></table></figure></li></ol><p>è¿™é‡Œ <code>MY_SECRET</code> æ˜¯ä½ åˆ›å»ºçš„ secret çš„åç§°ï¼Œå¯ä»¥åœ¨æ­¥éª¤ä¸­ä½¿ç”¨ <code>$&#123;&#123; secrets.MY_SECRET &#125;&#125;</code> å¼•ç”¨å®ƒã€‚</p><h3 id="ä½¿ç”¨-Variablesï¼š"><a href="#ä½¿ç”¨-Variablesï¼š" class="headerlink" title="ä½¿ç”¨ Variablesï¼š"></a>ä½¿ç”¨ Variablesï¼š</h3><p>GitHub Actions çš„ variables æ˜¯ç”± GitHub æä¾›çš„ä¸€ç»„é»˜è®¤ç¯å¢ƒå˜é‡ï¼ŒåŒæ—¶ä½ ä¹Ÿå¯ä»¥å®šä¹‰è‡ªå·±çš„ç¯å¢ƒå˜é‡ã€‚è¿™äº›å˜é‡å¯ä»¥åœ¨å·¥ä½œæµç¨‹çš„ä»»ä½•æ­¥éª¤ä¸­ä½¿ç”¨ã€‚</p><ol><li><p><strong>åœ¨å·¥ä½œæµç¨‹ä¸­ä½¿ç”¨ GitHub æä¾›çš„ variablesï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">my_job:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Use</span> <span class="hljs-string">GitHub-provided</span> <span class="hljs-string">variable</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">echo</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">github.event_name</span> <span class="hljs-string">&#125;&#125;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„ <code>github.event_name</code> æ˜¯ GitHub æä¾›çš„ä¸€ä¸ªé»˜è®¤å˜é‡ï¼Œè¡¨ç¤ºè§¦å‘å·¥ä½œæµç¨‹çš„äº‹ä»¶çš„åç§°ã€‚</p></li><li><p><strong>åœ¨å·¥ä½œæµç¨‹ä¸­å®šä¹‰è‡ªå·±çš„ variablesï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">my_job:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attr">env:</span><br>      <span class="hljs-attr">MY_VARIABLE:</span> <span class="hljs-string">my_value</span><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Use</span> <span class="hljs-string">custom</span> <span class="hljs-string">variable</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">echo</span> <span class="hljs-string">$MY_VARIABLE</span><br></code></pre></td></tr></table></figure></li></ol><p>åœ¨ <code>env</code> éƒ¨åˆ†å®šä¹‰è‡ªå·±çš„ç¯å¢ƒå˜é‡ï¼Œç„¶ååœ¨æ­¥éª¤ä¸­ä½¿ç”¨ <code>$MY_VARIABLE</code> å¼•ç”¨å®ƒã€‚</p><p>æ³¨æ„ï¼šGitHub Actions ä¸­çš„ç¯å¢ƒå˜é‡ï¼ˆåŒ…æ‹¬ secrets å’Œ variablesï¼‰åœ¨æ­¥éª¤ä¸­çš„å¼•ç”¨æ–¹å¼ä½¿ç”¨ <code>$&#123;&#123; ... &#125;&#125;</code> è¯­æ³•ã€‚æ­¤å¤–ï¼Œsecrets åªèƒ½åœ¨å·¥ä½œæµç¨‹çš„åŒä¸€å­˜å‚¨åº“ä¸­ä½¿ç”¨ï¼Œè€Œ variables åˆ™å¯ä»¥åœ¨ä¸åŒå­˜å‚¨åº“çš„å·¥ä½œæµç¨‹ä¸­å…±äº«ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;GitHub Actions æ˜¯ GitHub æä¾›çš„ä¸€é¡¹æŒç»­é›†æˆ (CI) å’ŒæŒç»­éƒ¨ç½² (CD) æœåŠ¡ã€‚å®ƒå…è®¸ä½ åœ¨ä»£ç ä»“åº“ä¸­å®šä¹‰å’Œè¿è¡Œè‡ªåŠ¨åŒ–çš„å·¥ä½œæµç¨‹ï¼Œä»¥å“åº”å­˜å‚¨åº“ä¸­çš„äº‹ä»¶æˆ–è°ƒåº¦ã€‚GitHub Actions å¯ä»¥ç”¨äºæ„å»ºã€æµ‹è¯•ã€æ‰“åŒ…å’Œéƒ¨ç½²é¡¹ç›®ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œå…¶ä»–è‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚</summary>
      
    
    
    
    
    <category term="github action" scheme="https://cason.work/tags/github-action/"/>
    
    <category term="springboot" scheme="https://cason.work/tags/springboot/"/>
    
    <category term="vue" scheme="https://cason.work/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>Easypoi-å¤§æ•°æ®é‡å¯¼å‡º</title>
    <link href="https://cason.work/2024/01/09/Easypoi-%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%AF%BC%E5%87%BA/"/>
    <id>https://cason.work/2024/01/09/Easypoi-%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%AF%BC%E5%87%BA/</id>
    <published>2024-01-09T08:52:27.000Z</published>
    <updated>2024-01-09T09:15:10.388Z</updated>
    
    <content type="html"><![CDATA[<p>EasyExcel åœ¨å¤„ç† Excel æ–‡ä»¶æ—¶ï¼Œéœ€è¦å ç”¨ä¸€å®šçš„å†…å­˜ã€‚å¦‚æœå¯¼å‡ºçš„æ•°æ®é‡è¿‡å¤§ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ï¼Œä»è€Œå¼•å‘ CPU è¿‡é«˜çš„é—®é¢˜ã€‚å¹¶å‘è®¿é—®å¯¼å‡ºæ¥å£ä¹Ÿä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥å°½é‡åœ¨æ•°æ®é‡æ¯”è¾ƒå¤§çš„å¯¼å‡ºæ¥å£æ·»åŠ é”æ§åˆ¶ã€‚</p><blockquote><p>ä»¥ä¸‹æ˜¯è™šåŒ–ä¸šåŠ¡åçš„ä»£ç ï¼Œè®°å½•ä¸€ä¸‹é‡åˆ°çš„é—®é¢˜è§£å†³æ–¹æ¡ˆ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></div></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å¯¼å‡ºå¤§æ•°æ®é‡Excelæ–‡ä»¶</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> response HttpServletResponseå¯¹è±¡ï¼Œç”¨äºè®¾ç½®å“åº”å¤´å’Œè¾“å‡ºæµ</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> requestForm åŒ…å«æŸ¥è¯¢å‚æ•°çš„è¡¨å•å¯¹è±¡</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> ParseException å½“æ—¥æœŸè§£æå‘ç”Ÿé”™è¯¯æ—¶æŠ›å‡ºå¼‚å¸¸</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> IOException å½“è¾“å…¥æˆ–è¾“å‡ºæ“ä½œå‘ç”Ÿé”™è¯¯æ—¶æŠ›å‡ºå¼‚å¸¸</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exportBigExcelist</span><span class="hljs-params">(HttpServletResponse response, RequestForm requestForm)</span> <span class="hljs-keyword">throws</span> ParseException, IOException &#123;<br>    <span class="hljs-comment">// è®¾ç½®Excelå¯¼å‡ºå‚æ•°ï¼ŒåŒ…æ‹¬æ ‡é¢˜å’Œsheetåç§°</span><br>    <span class="hljs-type">ExportParams</span> <span class="hljs-variable">params</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExportParams</span>(<span class="hljs-string">&quot;æ ‡é¢˜&quot;</span>, <span class="hljs-string">&quot;sheetåç§°&quot;</span>);<br><br>    <span class="hljs-comment">// ä½¿ç”¨EasyExcelå·¥å…·ç±»å¯¼å‡ºå¤§æ•°æ®Excelæ–‡ä»¶</span><br>    <span class="hljs-type">Workbook</span> <span class="hljs-variable">workbook</span> <span class="hljs-operator">=</span> ExcelExportUtil.exportBigExcel(params, ExcelDto.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">IExcelExportServer</span>() &#123;<br>        <span class="hljs-meta">@SneakyThrows</span><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> List&lt;Object&gt; <span class="hljs-title function_">selectListForExcelExport</span><span class="hljs-params">(Object queryParams, <span class="hljs-type">int</span> page)</span> &#123;<br>            <span class="hljs-comment">// å¼ºåˆ¶è½¬æ¢æŸ¥è¯¢å‚æ•°ä¸ºRequestFormå¯¹è±¡</span><br>            <span class="hljs-type">RequestForm</span> <span class="hljs-variable">tempForm</span> <span class="hljs-operator">=</span> (RequestForm) queryParams;<br>            <br>            <span class="hljs-comment">// è®¾ç½®åˆ†é¡µå‚æ•°</span><br>            tempForm.setPage(page);<br>            tempForm.setPageSize(<span class="hljs-number">10000</span>);<br>            <br>            <span class="hljs-comment">// è°ƒç”¨ä¸šåŠ¡æœåŠ¡è¿›è¡Œåˆ†é¡µæŸ¥è¯¢é€»è¾‘</span><br>            List&lt;ExcelDto&gt; list = service.selectlist(tempForm);<br>            <br>            <span class="hljs-comment">// å°†æŸ¥è¯¢ç»“æœè½¬åŒ–ä¸ºList&lt;Object&gt;</span><br>            List&lt;Object&gt; objects = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(list);<br>            <br>            <span class="hljs-comment">// å¦‚æœæŸ¥è¯¢ç»“æœä¸ºç©ºï¼Œåˆ™è¿”å›null</span><br>            <span class="hljs-keyword">if</span> (list.size() == <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>            <br>            <span class="hljs-keyword">return</span> objects;<br>        &#125;<br>    &#125;, requestForm);<br><br>    <span class="hljs-comment">// è®¾ç½®å“åº”å¤´ï¼ŒæŒ‡å®šå¯¼å‡ºæ–‡ä»¶ç±»å‹ä¸ºExcel</span><br>    response.setHeader(<span class="hljs-string">&quot;content-Type&quot;</span>, <span class="hljs-string">&quot;application/vnd.ms-excel&quot;</span>);<br>    <span class="hljs-comment">// è®¾ç½®å“åº”å¤´ï¼ŒæŒ‡å®šå¯¼å‡ºæ–‡ä»¶çš„åç§°ï¼Œå¹¶å¯¹æ–‡ä»¶åè¿›è¡ŒUTF-8ç¼–ç </span><br>    response.setHeader(<span class="hljs-string">&quot;Content-Disposition&quot;</span>, <span class="hljs-string">&quot;attachment;filename=&quot;</span> + URLEncoder.encode(<span class="hljs-string">&quot;filename.xls&quot;</span>, <span class="hljs-string">&quot;UTF-8&quot;</span>));<br>    <br>    <span class="hljs-comment">// å°†ç”Ÿæˆçš„Excelæ–‡ä»¶å†™å…¥åˆ°å“åº”è¾“å‡ºæµ</span><br>    workbook.write(response.getOutputStream());<br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;EasyExcel åœ¨å¤„ç† Excel æ–‡ä»¶æ—¶ï¼Œéœ€è¦å ç”¨ä¸€å®šçš„å†…å­˜ã€‚å¦‚æœå¯¼å‡ºçš„æ•°æ®é‡è¿‡å¤§ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ï¼Œä»è€Œå¼•å‘ CPU è¿‡é«˜çš„é—®é¢˜ã€‚å¹¶å‘è®¿é—®å¯¼å‡ºæ¥å£ä¹Ÿä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥å°½é‡åœ¨æ•°æ®é‡æ¯”è¾ƒå¤§çš„å¯¼å‡ºæ¥å£æ·»åŠ é”æ§åˆ¶ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯è™šåŒ–ä¸š</summary>
      
    
    
    
    <category term="Springboot" scheme="https://cason.work/categories/Springboot/"/>
    
    
    <category term="Easypoi" scheme="https://cason.work/tags/Easypoi/"/>
    
    <category term="Excel" scheme="https://cason.work/tags/Excel/"/>
    
  </entry>
  
  <entry>
    <title>Threadlocal-å†…å­˜æ³„éœ²é—®é¢˜</title>
    <link href="https://cason.work/2024/01/03/Threadlocal-%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E9%97%AE%E9%A2%98/"/>
    <id>https://cason.work/2024/01/03/Threadlocal-%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E9%97%AE%E9%A2%98/</id>
    <published>2024-01-03T06:57:14.000Z</published>
    <updated>2024-01-03T07:13:45.586Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://cason.work/2022/06/16/Threadlocal%E7%9A%84%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3%E5%92%8C%E9%83%A8%E5%88%86%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">Threadlocalçš„ç®€å•ç†è§£å’Œéƒ¨åˆ†æºç åˆ†æ - Blog|CasonMo</a></p></blockquote><p>åœ¨ThreadLocalMapä¸­ï¼Œç”¨Entryæ¥ä¿å­˜K-Vç»“æ„æ•°æ®çš„ã€‚Entryçš„æ„é€ æ–¹æ³•å·²ç»é™å®šEntryä¸­keyåªèƒ½æ˜¯ThreadLocalå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entry</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WeakReference</span>&lt;ThreadLocal&gt; &#123;<br>    <span class="hljs-comment">/** The value associated with this ThreadLocal. */</span><br>    Object value;<br><br>    Entry(ThreadLocal k, Object v) &#123;<br>        <span class="hljs-built_in">super</span>(k);<br>        value = v;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Entryç»§æ‰¿è‡ªWeakReferenceï¼ˆå¼±å¼•ç”¨ï¼Œç”Ÿå‘½å‘¨æœŸåªèƒ½å­˜æ´»åˆ°ä¸‹æ¬¡GCå‰ï¼‰ï¼Œä½†åªæœ‰Keyæ˜¯å¼±å¼•ç”¨ç±»å‹çš„ï¼ŒValueå¹¶éå¼±å¼•ç”¨ã€‚ï¼ˆé—®é¢˜é©¬ä¸Šå°±æ¥äº†ï¼‰</p><blockquote><h4 id="å››ç§å¼•ç”¨ç±»å‹"><a href="#å››ç§å¼•ç”¨ç±»å‹" class="headerlink" title="å››ç§å¼•ç”¨ç±»å‹"></a>å››ç§å¼•ç”¨ç±»å‹</h4><ol><li>å¼ºå¼•ç”¨ï¼ˆStrongReferenceï¼‰</li></ol><p>  ç±»ä¼¼Object obj &#x3D; new Object()è¿™ç±»ä¼¼çš„å¼•ç”¨ï¼Œå¼ºå¼•ç”¨åœ¨ç¨‹åºä»£ç ä¸­æ™®éå­˜åœ¨ï¼Œåªè¦å¼ºå¼•ç”¨åœ¨ï¼Œåƒåœ¾æœé›†å™¨æ°¸è¿œä¸ä¼šæœé›†è¢«å¼•ç”¨çš„å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å®æ„¿å‡ºç°å†…å­˜æº¢å‡ºï¼ˆOutOfMemoryErrorï¼‰ï¼Œä¹Ÿä¸ä¼šå›æ”¶è¿™äº›å¯¹è±¡</strong></p><ol start="2"><li>è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰</li></ol><p>  åœ¨Javaä¸­ç”¨java.lang.ref.SoftReferenceç±»æ¥è¡¨ç¤ºã€‚<strong>å¯¹äºè½¯å¼•ç”¨å…³è”ç€çš„å¯¹è±¡ï¼Œåªæœ‰åœ¨å†…å­˜ä¸è¶³çš„æ—¶å€™JVMæ‰ä¼šå›æ”¶è¯¥å¯¹è±¡</strong></p><ol start="3"><li>å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰</li></ol><p>  å¼±å¼•ç”¨ä¹Ÿæ˜¯ç”¨æ¥æè¿°éå¿…éœ€å¯¹è±¡çš„ï¼Œç”¨java.lang.ref.WeakReferenceç±»æ¥è¡¨ç¤ºï¼Œ<strong>å½“JVMè¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œæ— è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ã€‚</strong></p><ol start="4"><li>è™šå¼•ç”¨ ï¼ˆPhantomReferenceï¼‰</li></ol><p>  java.lang.ref.PhantomReferenceç±»è¡¨ç¤ºã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸è™šå¼•ç”¨å…³è”ï¼Œåˆ™è·Ÿæ²¡æœ‰å¼•ç”¨ä¸ä¹‹å…³è”ä¸€æ ·ï¼Œ<strong>åœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶</strong>ã€‚</p><p>  è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åŒºåˆ«ï¼š<strong>è™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—è”åˆä½¿ç”¨ã€‚</strong></p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br><span class="hljs-type">ReferenceQueue</span> <span class="hljs-variable">queue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReferenceQueue</span> ();<br><span class="hljs-type">PhantomReference</span> <span class="hljs-variable">pr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PhantomReference</span> (object, queue); <br></code></pre></td></tr></table></figure></blockquote><p>ç”±äºThreadLocalMapçš„keyæ˜¯å¼±å¼•ç”¨ï¼Œè€ŒValueæ˜¯å¼ºå¼•ç”¨ã€‚è¿™å°±å¯¼è‡´äº†ä¸€ä¸ªé—®é¢˜ï¼ŒThreadLocalåœ¨æ²¡æœ‰å¤–éƒ¨å¯¹è±¡å¼ºå¼•ç”¨æ—¶ï¼Œå‘ç”ŸGCæ—¶å¼±å¼•ç”¨Keyä¼šè¢«å›æ”¶ï¼Œè€ŒValueä¸ä¼šå›æ”¶ã€‚</p><p>å½“çº¿ç¨‹æ²¡æœ‰ç»“æŸï¼Œä½†æ˜¯ThreadLocalå·²ç»è¢«å›æ”¶ï¼Œåˆ™å¯èƒ½å¯¼è‡´çº¿ç¨‹ä¸­å­˜åœ¨<code>ThreadLocalMap&lt;null, Object&gt;</code>çš„é”®å€¼å¯¹ï¼Œé€ æˆå†…å­˜æ³„éœ²ã€‚ï¼ˆThreadLocalè¢«å›æ”¶ï¼ŒThreadLocalå…³è”çš„çº¿ç¨‹å…±äº«å˜é‡è¿˜å­˜åœ¨ï¼‰ã€‚</p><h2 id="å¦‚ä½•é¿å…æ³„æ¼"><a href="#å¦‚ä½•é¿å…æ³„æ¼" class="headerlink" title="å¦‚ä½•é¿å…æ³„æ¼"></a>å¦‚ä½•é¿å…æ³„æ¼</h2><p>ä¸ºäº†é˜²æ­¢æ­¤ç±»æƒ…å†µçš„å‡ºç°ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ‰‹æ®µã€‚</p><ul><li><p>ä½¿ç”¨å®Œçº¿ç¨‹å…±äº«å˜é‡åï¼Œæ˜¾ç¤ºè°ƒç”¨<code>ThreadLocalMap.remove</code>æ–¹æ³•æ¸…é™¤çº¿ç¨‹å…±äº«å˜é‡ï¼›</p><p>æ—¢ç„¶Keyæ˜¯å¼±å¼•ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦åšçš„äº‹ï¼Œå°±æ˜¯åœ¨è°ƒç”¨ThreadLocalçš„<code>get()</code>ã€<code>set()</code>æ–¹æ³•æ—¶å®Œæˆåå†è°ƒç”¨removeæ–¹æ³•ï¼Œå°†EntryèŠ‚ç‚¹å’ŒMapçš„å¼•ç”¨å…³ç³»ç§»é™¤ï¼Œè¿™æ ·æ•´ä¸ªEntryå¯¹è±¡åœ¨GC Rootsåˆ†æåå°±å˜æˆä¸å¯è¾¾äº†ï¼Œä¸‹æ¬¡GCçš„æ—¶å€™å°±å¯ä»¥è¢«å›æ”¶ã€‚</p></li><li><p>JDKå»ºè®®ThreadLocalå®šä¹‰ä¸º<code>private static</code>ï¼Œè¿™æ ·ThreadLocalçš„å¼±å¼•ç”¨é—®é¢˜åˆ™ä¸å­˜åœ¨äº†ã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://cason.work/2022/06/16/Threadlocal%E7%9A%84%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3%E5%92%8C%E9%83%A8%E5%88%86%E</summary>
      
    
    
    
    <category term="å¹¶å‘ç¼–ç¨‹" scheme="https://cason.work/categories/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="ThreadLocal" scheme="https://cason.work/tags/ThreadLocal/"/>
    
  </entry>
  
  <entry>
    <title>Mybatisplus-åŠ¨æ€è·å–sqlå­—ç¬¦ä¸²</title>
    <link href="https://cason.work/2023/12/11/Mybatisplus-%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96sql%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    <id>https://cason.work/2023/12/11/Mybatisplus-%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96sql%E5%AD%97%E7%AC%A6%E4%B8%B2/</id>
    <published>2023-12-11T08:35:41.000Z</published>
    <updated>2023-12-11T08:57:27.692Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è®°å½•è´´</p></blockquote><p>å€ŸåŠ©mybatisplusæ„å»ºåŠ¨æ€ SQL æŸ¥è¯¢è¯­å¥çš„åŠŸèƒ½ï¼Œæ¥åŠ¨æ€æ„å»ºsqlæ¥åšprestoæŸ¥è¯¢ï¼Œè¿™æ ·å°±ä¸ç”¨åœ¨ä»£ç é‡Œå†™sqläº†</p><p><code>getBoundSql</code> æ˜¯ MyBatis ä¸­ <code>org.apache.ibatis.mapping.BoundSql</code> æ¥å£çš„æ–¹æ³•ï¼Œç”¨äºè·å–ä¸€ä¸ªè¡¨ç¤º SQL è¯­å¥å’Œç›¸å…³å‚æ•°æ˜ å°„çš„å¯¹è±¡ã€‚<code>BoundSql</code> å®ä¾‹åŒ…å«äº†é¢„ç¼–è¯‘çš„ SQL è¯­å¥ä»¥åŠå‚æ•°æ˜ å°„ä¿¡æ¯ï¼Œå¯ä»¥ç”¨äºæ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></div></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.apache.ibatis.mapping.BoundSql;<br><span class="hljs-keyword">import</span> org.apache.ibatis.mapping.MappedStatement;<br><span class="hljs-keyword">import</span> org.apache.ibatis.mapping.ParameterMapping;<br><span class="hljs-keyword">import</span> org.apache.ibatis.reflection.MetaObject;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.Configuration;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicSqlUtils</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> SqlSession sqlSession;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getSql</span><span class="hljs-params">(Class clz,String method, Object obj)</span> &#123;<br>        <span class="hljs-type">Configuration</span> <span class="hljs-variable">configuration</span> <span class="hljs-operator">=</span> sqlSession.getConfiguration();<br>        <span class="hljs-type">MappedStatement</span> <span class="hljs-variable">ms</span> <span class="hljs-operator">=</span> configuration.getMappedStatement(clz.getName() + <span class="hljs-string">&quot;.&quot;</span> + method);<br>        <span class="hljs-type">BoundSql</span> <span class="hljs-variable">boundSql</span> <span class="hljs-operator">=</span> ms.getBoundSql(obj);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">parsedSql</span> <span class="hljs-operator">=</span> boundSql.getSql();<br>      <span class="hljs-comment">// #&#123;&#125;ä¼šè¢«æ›¿æ¢æˆ? ,$&#123;&#125;æ‰ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span><br>        <span class="hljs-comment">// è·å–å‚æ•°æ˜ å°„</span><br>        List&lt;ParameterMapping&gt; parameterMappings = boundSql.getParameterMappings();<br>        <span class="hljs-comment">// è·å–å‚æ•°å¯¹è±¡</span><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">parameterObject</span> <span class="hljs-operator">=</span> boundSql.getParameterObject();<br>        <span class="hljs-comment">// æ‰“å°å‚æ•°å ä½ç¬¦å’Œå¯¹åº”çš„å‚æ•°å€¼</span><br>        <span class="hljs-keyword">for</span> (ParameterMapping parameterMapping : parameterMappings) &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">property</span> <span class="hljs-operator">=</span> parameterMapping.getProperty();<br>            <span class="hljs-comment">// è·å–å‚æ•°å€¼</span><br>            <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">if</span> (boundSql.hasAdditionalParameter(property)) &#123;<br>                <span class="hljs-comment">// å¯¹äºé¢å¤–çš„å‚æ•°ï¼Œç›´æ¥è·å–</span><br>                value = boundSql.getAdditionalParameter(property);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parameterObject != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-comment">// å¯¹äºå‚æ•°å¯¹è±¡ï¼Œé€šè¿‡åå°„è·å–å±æ€§å€¼</span><br>                <span class="hljs-type">MetaObject</span> <span class="hljs-variable">metaObject</span> <span class="hljs-operator">=</span> configuration.newMetaObject(parameterObject);<br>                value = metaObject.getValue(property);<br>            &#125;<br>            <span class="hljs-comment">// æ›¿æ¢ SQL è¯­å¥ä¸­çš„å ä½ç¬¦</span><br>            parsedSql = parsedSql.replaceFirst(<span class="hljs-string">&quot;\\?&quot;</span>, <span class="hljs-string">&quot;&#x27;&quot;</span>+value.toString()+<span class="hljs-string">&quot;&#x27;&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> parsedSql;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;demoList&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.*.dto.DemoDTO&quot;</span>&gt;</span><br>  select * from t demo where 1=1<br>  <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;form.status != null&quot;</span>&gt;</span><br>     and  t.status = #&#123;form.status&#125;<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>mapper</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">DemoMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;DemoEntity&gt; &#123;<br>List&lt;DemoDTO&gt; <span class="hljs-title function_">demoList</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;form&quot;)</span> DemoForm form)</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>è°ƒç”¨</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½¿ç”¨äº†@Param(â€œformâ€)ç»™æ–¹æ³•å‚æ•°èµ·åˆ«åï¼Œé‚£ä¹ˆå°±è¦ä½¿ç”¨Mapæ¥åŒ…è£…ä¸€ä¸‹map.put(â€œformâ€,åŸæ¥çš„formå¯¹è±¡)ï¼Œå¦åˆ™è·å–ä¸åˆ°form</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">Map&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>Map&lt;String, Object&gt; map2 = JSON.parseObject(JSON.toJSONString(demoForm), <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeReference</span>&lt;Map&lt;String, Object&gt;&gt;() &#123;&#125;);<br>map.put(<span class="hljs-string">&quot;form&quot;</span>, map2);<br>String sql=dynamicSqlUtils.getSql(DemoMapper.class, <span class="hljs-string">&quot;demoList&quot;</span>, map);<br><span class="hljs-comment">//presto.query(sql) æˆ–è€… hive.query(sql)</span><br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;è®°å½•è´´&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å€ŸåŠ©mybatisplusæ„å»ºåŠ¨æ€ SQL æŸ¥è¯¢è¯­å¥çš„åŠŸèƒ½ï¼Œæ¥åŠ¨æ€æ„å»ºsqlæ¥åšprestoæŸ¥è¯¢ï¼Œè¿™æ ·å°±ä¸ç”¨åœ¨ä»£ç é‡Œå†™sqläº†&lt;/p&gt;
&lt;p&gt;&lt;code&gt;getBoundSql&lt;/code&gt; æ˜¯ M</summary>
      
    
    
    
    <category term="Springboot" scheme="https://cason.work/categories/Springboot/"/>
    
    
    <category term="Mybatis" scheme="https://cason.work/tags/Mybatis/"/>
    
    <category term="presto" scheme="https://cason.work/tags/presto/"/>
    
    <category term="SQL" scheme="https://cason.work/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>ç®€å•å®ç°åˆ†æµåŠŸèƒ½</title>
    <link href="https://cason.work/2023/12/11/%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0%E5%88%86%E6%B5%81%E5%8A%9F%E8%83%BD/"/>
    <id>https://cason.work/2023/12/11/%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0%E5%88%86%E6%B5%81%E5%8A%9F%E8%83%BD/</id>
    <published>2023-12-11T08:06:02.000Z</published>
    <updated>2023-12-11T08:14:55.300Z</updated>
    
    <content type="html"><![CDATA[<p>é€»è¾‘æ¯”è¾ƒç®€å•å°±æ˜¯å¯¹å­—ç¬¦ä¸²ä¸€é¡¿åŠ è§£å¯†æ“ä½œç„¶åhashcodeç„¶åå–æ¨¡100ï¼Œç„¶åçœ‹å–æ¨¡ç»“æœè½åœ¨å“ªä¸ªç»„çš„åŒºé—´</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight java"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></div></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;<br><span class="hljs-keyword">import</span> org.springframework.util.CollectionUtils;<br><span class="hljs-keyword">import</span> org.springframework.util.DigestUtils;<br><br><span class="hljs-keyword">import</span> java.math.BigDecimal;<br><span class="hljs-keyword">import</span> java.math.RoundingMode;<br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Percent</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æµé‡åˆ‡åˆ†ç®—æ³•ï¼ˆéšæœºï¼‰</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> rid       rid</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> groupMap å¯¹ç…§ç»„</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> åˆ†ç»„</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">choose</span><span class="hljs-params">(String rid, Map&lt;String, Double&gt; groupMap)</span> &#123;<br>        <span class="hljs-keyword">if</span> (groupMap == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>        List&lt;String&gt; groups = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(groupMap.keySet());<br>        List&lt;Double&gt; rates = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(groupMap.values());<br>        <span class="hljs-keyword">if</span> (CollectionUtils.isEmpty(groupMap) || CollectionUtils.isEmpty(rates)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">digest</span> <span class="hljs-operator">=</span> DigestUtils.md5DigestAsHex(rid.getBytes());<br>        <span class="hljs-type">int</span> <span class="hljs-variable">hashCode</span> <span class="hljs-operator">=</span> digest.hashCode();<br>        <span class="hljs-comment">//ç™¾åˆ†æ¯”</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">random</span> <span class="hljs-operator">=</span> Math.abs(hashCode) % <span class="hljs-number">100</span>;<br>        <span class="hljs-comment">//murmur3_32ç®—æ³•æ¯”è¾ƒå¥½ï¼Œåˆ†å¸ƒå¾ˆå‡åŒ€</span><br>        <span class="hljs-comment">//int random = Math.abs(Hashing.murmur3_32().hashString(rid, Charset.forName(&quot;utf-8&quot;)).asInt())%100;</span><br><br>        <span class="hljs-type">double</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.0</span>;<br>        <span class="hljs-type">double</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.0</span>;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; rates.size(); i++) &#123;<br>            end = end + rates.get(i);<br>            <span class="hljs-keyword">if</span> (start &lt;= random &amp;&amp; random &lt; end) &#123;<br>                <span class="hljs-type">String</span> <span class="hljs-variable">group</span> <span class="hljs-operator">=</span> groups.get(i);<br>                <span class="hljs-keyword">for</span> (String tempGroup : groups) &#123;<br>                    <span class="hljs-keyword">if</span> (group.equals(tempGroup)) &#123;<br>                        log.info(<span class="hljs-string">&quot;choose [rid]: &#123;&#125; [group]: &#123;&#125; random ;&#123;&#125;&quot;</span>, rid, group, random);<br>                        <span class="hljs-keyword">return</span> group;<br>                    &#125;<br>                &#125;<br>            &#125;<br>            start = start + rates.get(i);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>å†™ä¸ªmainæ–¹æ³•æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    Map&lt;String, Double&gt; groups = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>    groups.put(<span class="hljs-string">&quot;g1&quot;</span>, <span class="hljs-number">15d</span>);<br>    groups.put(<span class="hljs-string">&quot;g2&quot;</span>, <span class="hljs-number">25d</span>);<br>    groups.put(<span class="hljs-string">&quot;g3&quot;</span>, <span class="hljs-number">30d</span>);<br>    groups.put(<span class="hljs-string">&quot;g4&quot;</span>, <span class="hljs-number">30d</span>);<br>    Map&lt;String, Integer&gt; groupCountMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>    <span class="hljs-type">long</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-number">100000</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">long</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; total; i++) &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">group_super_id</span> <span class="hljs-operator">=</span> choose(UUID.randomUUID().toString(), groups);<br>        <span class="hljs-keyword">if</span> (!groupCountMap.containsKey(group_super_id)) &#123;<br>            groupCountMap.put(group_super_id, <span class="hljs-number">1</span>);<br>        &#125;<br>        groupCountMap.put(group_super_id, groupCountMap.get(group_super_id) + <span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (Map.Entry&lt;String, Integer&gt; entry : groupCountMap.entrySet()) &#123;<br>        log.info(<span class="hljs-string">&quot;group : &#123;&#125; count : &#123;&#125; percent :&#123;&#125;&quot;</span>, entry.getKey(), entry.getValue(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(entry.getValue()).divide(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(total), <span class="hljs-number">4</span>, RoundingMode.UP).multiply(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-number">100</span>)) + <span class="hljs-string">&quot;%&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœé€¼è¿‘é¢„è®¾å€¼</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/image-20231211160804894.png" alt="image-20231211160804894"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;é€»è¾‘æ¯”è¾ƒç®€å•å°±æ˜¯å¯¹å­—ç¬¦ä¸²ä¸€é¡¿åŠ è§£å¯†æ“ä½œç„¶åhashcodeç„¶åå–æ¨¡100ï¼Œç„¶åçœ‹å–æ¨¡ç»“æœè½åœ¨å“ªä¸ªç»„çš„åŒºé—´&lt;/p&gt;
&lt;h3 id=&quot;ä»£ç &quot;&gt;&lt;a href=&quot;#ä»£ç &quot; class=&quot;headerlink&quot; title=&quot;ä»£ç &quot;&gt;&lt;/a&gt;ä»£ç &lt;/h3&gt;&lt;figure class</summary>
      
    
    
    
    <category term="Springboot" scheme="https://cason.work/categories/Springboot/"/>
    
    
    <category term="Java" scheme="https://cason.work/tags/Java/"/>
    
    <category term="ç®—æ³•" scheme="https://cason.work/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="åˆ†æµ" scheme="https://cason.work/tags/%E5%88%86%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>Hexo-ç”Ÿæˆç«™ç‚¹åœ°å›¾ï¼ˆsitemapï¼‰</title>
    <link href="https://cason.work/2023/12/08/Hexo-%E7%94%9F%E6%88%90%E7%AB%99%E7%82%B9%E5%9C%B0%E5%9B%BE%EF%BC%88sitemap%EF%BC%89/"/>
    <id>https://cason.work/2023/12/08/Hexo-%E7%94%9F%E6%88%90%E7%AB%99%E7%82%B9%E5%9C%B0%E5%9B%BE%EF%BC%88sitemap%EF%BC%89/</id>
    <published>2023-12-08T09:36:00.000Z</published>
    <updated>2023-12-08T09:56:07.545Z</updated>
    
    <content type="html"><![CDATA[<h3 id="SiteMapæ˜¯ä»€ä¹ˆ"><a href="#SiteMapæ˜¯ä»€ä¹ˆ" class="headerlink" title="SiteMapæ˜¯ä»€ä¹ˆ"></a>SiteMapæ˜¯ä»€ä¹ˆ</h3><p>Sitemap æ˜¯ä¸€ç§åˆ—ä¸¾äº†ç½‘ç«™ä¸­æ‰€æœ‰é¡µé¢çš„ XML æ–‡ä»¶ã€‚å®ƒå¯ä»¥è¢«æœç´¢å¼•æ“ï¼ˆå¦‚ Googleã€Bingï¼‰ç”¨æ¥æ›´æœ‰æ•ˆåœ°æŠ“å–ç½‘ç«™ï¼Œäº†è§£ç½‘ç«™çš„ç»“æ„ã€‚Sitemap æ–‡ä»¶æä¾›äº†ç½‘ç«™ä¸Šæ¯ä¸ªé¡µé¢çš„é“¾æ¥ä»¥åŠæœ‰å…³é¡µé¢æœ€åä¿®æ”¹æ—¶é—´ã€æ›´æ–°é¢‘ç‡å’Œç›¸å¯¹é‡è¦æ€§çš„é™„åŠ ä¿¡æ¯ï¼Œè¿™æœ‰åŠ©äºæœç´¢å¼•æ“ç¡®å®šå“ªäº›é¡µé¢åº”è¯¥ä¼˜å…ˆè€ƒè™‘ä»¥åŠå¤šä¹…æŠ“å–ä¸€æ¬¡è¿™äº›é¡µé¢ã€‚</p><p>å¯¹äºå¤§å‹ç½‘ç«™ã€å…·æœ‰è®¸å¤šåŠ¨æ€é¡µé¢çš„ç½‘ç«™æˆ–æ–°ç½‘ç«™ï¼ŒSitemap å°¤å…¶é‡è¦ï¼Œå› ä¸ºå®ƒèƒ½ç¡®ä¿æœç´¢å¼•æ“èƒ½å¤Ÿå‘ç°å¹¶ç´¢å¼•ç½‘ç«™ä¸Šçš„æ‰€æœ‰é‡è¦é¡µé¢ã€‚å³ä¾¿å¯¹äºå°å‹ç½‘ç«™ï¼Œæ‹¥æœ‰ Sitemap ä¹Ÿæœ‰åŠ©äºæé«˜SEOï¼ˆæœç´¢å¼•æ“ä¼˜åŒ–ï¼‰çš„æ•ˆæœã€‚</p><p>ç«™ç‚¹åœ°å›¾æœ‰ä¸¤ç§å¸¸è§ç±»å‹ï¼š</p><ol><li><p>XML Sitemapï¼š<br>è¿™æ˜¯ç»™æœç´¢å¼•æ“çš„ï¼Œè§„èŒƒå®šä¹‰æ¯”è¾ƒä¸¥æ ¼ï¼Œå®ƒä½¿ç”¨ XML è¯­è¨€ç¼–å†™ï¼Œä¸€èˆ¬ä¼šæ”¾åœ¨ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ï¼Œå¹¶å¯ä»¥é€šè¿‡ &#x2F;sitemap.xml è®¿é—®ã€‚è¿™æ ·åšå¯ä»¥ä½¿æœç´¢å¼•æ“æ›´å®¹æ˜“æ‰¾åˆ°å’ŒæŠ“å–æ‰€æœ‰çš„é¡µé¢ã€‚</p></li><li><p>HTML Sitemapï¼š<br>è¿™ç±» Sitemap æ˜¯ç»™ç”¨æˆ·çš„ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªç®€å•çš„ HTML é¡µé¢ï¼ŒåŒ…å«äº†ç½‘ç«™ä¸Šæ‰€æœ‰æˆ–æ˜¯æœ€é‡è¦çš„é¡µé¢çš„é“¾æ¥ã€‚è¿™å¯ä»¥å¸®åŠ©ç”¨æˆ·å¿«é€Ÿå¯¼èˆªåˆ°ä»–ä»¬æƒ³è¦æ‰¾çš„é¡µé¢ï¼Œå¹¶æé«˜ç½‘ç«™çš„ç”¨æˆ·ä½“éªŒã€‚</p></li></ol><h3 id="Hexoå¦‚ä½•ç”ŸæˆSitemap"><a href="#Hexoå¦‚ä½•ç”ŸæˆSitemap" class="headerlink" title="Hexoå¦‚ä½•ç”ŸæˆSitemap"></a>Hexoå¦‚ä½•ç”ŸæˆSitemap</h3><ul><li><p>Google ç‰ˆæœ¬</p><p><code>npm install hexo-generator-sitemap --save</code></p></li><li><p>Baidu ç‰ˆæœ¬</p><p><code>npm install hexo-generator-baidu-sitemap --save</code></p></li><li><p>åœ¨<code>_config.yml</code>ä¸­æ‰¾åˆ°<code>url</code>ï¼Œæ”¹æˆä½ è‡ªå·±çš„åŸŸåï¼Œå½±å“ç”Ÿæˆçš„sitemapä¸‹çš„æ¯ä¸€æ¡é“¾æ¥</p><figure class="highlight yaml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># URL</span><br><span class="hljs-comment">## Set your site url here. For example, if you use GitHub Page, set url as &#x27;https://username.github.io/project&#x27;</span><br><span class="hljs-attr">url:</span> <span class="hljs-string">&lt;è¿™é‡Œ&gt;</span><br><span class="hljs-attr">permalink:</span> <span class="hljs-string">:year/:month/:day/:title/</span><br><span class="hljs-attr">permalink_defaults:</span><br><span class="hljs-attr">pretty_urls:</span><br>  <span class="hljs-attr">trailing_index:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># Set to false to remove trailing &#x27;index.html&#x27; from permalinks</span><br>  <span class="hljs-attr">trailing_html:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># Set to false to remove trailing &#x27;.html&#x27; from permalinks</span><br></code></pre></td></tr></table></figure></li><li><p>æ‰“åŒ…è‡ªåŠ¨åœ¨<code>public</code>ä¸‹ç”Ÿæˆ<code>sitemap.xml</code>å’Œ<code>baidusitemap.xml</code></p><p><code>hexo g -d</code></p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/image-20231208174125354.png" alt="image-20231208174125354"></p><p>æµè§ˆå™¨è®¿é—®<code>https://&lt;åŸŸå&gt;/sitemap.xml</code>å’Œ<code>https://&lt;åŸŸå&gt;/baidusitemap.xml</code>å³å¯çœ‹åˆ°å†…å®¹<img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/image-20231208174254230.png" alt="image-20231208174254230"></p></li></ul><h3 id="æäº¤ç«™ç‚¹åˆ°ç™¾åº¦"><a href="#æäº¤ç«™ç‚¹åˆ°ç™¾åº¦" class="headerlink" title="æäº¤ç«™ç‚¹åˆ°ç™¾åº¦"></a>æäº¤ç«™ç‚¹åˆ°ç™¾åº¦</h3><ul><li><p>åˆ°ç™¾åº¦èµ„æºå¹³å°æäº¤ç«™ç‚¹</p><blockquote><p><a href="https://ziyuan.baidu.com/site/index#/">ç«™ç‚¹ç®¡ç†_ç«™é•¿å·¥å…·_ç™¾åº¦æœç´¢èµ„æºå¹³å° (baidu.com)</a></p></blockquote><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/image-20231208174539329.png" alt="image-20231208174539329"></p></li><li><p>æäº¤Sitemap<br><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/image-20231208174443927.png" alt="image-20231208174443927"></p></li></ul><h3 id="æäº¤ç«™ç‚¹åˆ°è°·æ­Œ"><a href="#æäº¤ç«™ç‚¹åˆ°è°·æ­Œ" class="headerlink" title="æäº¤ç«™ç‚¹åˆ°è°·æ­Œ"></a>æäº¤ç«™ç‚¹åˆ°è°·æ­Œ</h3><ul><li><p>åˆ°google search console æäº¤ç«™ç‚¹</p><blockquote><p><a href="https://search.google.com/search-console">https://search.google.com/search-console</a></p></blockquote><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/image-20231208174713820.png" alt="image-20231208174713820"></p></li><li><p>æäº¤ç«™ç‚¹åœ°å›¾Sitemap</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/image-20231208174929691.png" alt="image-20231208174929691"></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;SiteMapæ˜¯ä»€ä¹ˆ&quot;&gt;&lt;a href=&quot;#SiteMapæ˜¯ä»€ä¹ˆ&quot; class=&quot;headerlink&quot; title=&quot;SiteMapæ˜¯ä»€ä¹ˆ&quot;&gt;&lt;/a&gt;SiteMapæ˜¯ä»€ä¹ˆ&lt;/h3&gt;&lt;p&gt;Sitemap æ˜¯ä¸€ç§åˆ—ä¸¾äº†ç½‘ç«™ä¸­æ‰€æœ‰é¡µé¢çš„ XML æ–‡ä»¶ã€‚å®ƒå¯ä»¥è¢«æœç´¢å¼•æ“</summary>
      
    
    
    
    <category term="Hexo" scheme="https://cason.work/categories/Hexo/"/>
    
    
    <category term="Hexo" scheme="https://cason.work/tags/Hexo/"/>
    
    <category term="Seo" scheme="https://cason.work/tags/Seo/"/>
    
    <category term="Sitemap" scheme="https://cason.work/tags/Sitemap/"/>
    
  </entry>
  
  <entry>
    <title>Easypoi-å¯¼å‡ºexcelå•å…ƒæ ¼æ·»åŠ ä¸‹æ‹‰åˆ—è¡¨</title>
    <link href="https://cason.work/2023/12/08/Easypoi-%E5%AF%BC%E5%87%BAexcel%E5%8D%95%E5%85%83%E6%A0%BC%E6%B7%BB%E5%8A%A0%E4%B8%8B%E6%8B%89%E5%88%97%E8%A1%A8/"/>
    <id>https://cason.work/2023/12/08/Easypoi-%E5%AF%BC%E5%87%BAexcel%E5%8D%95%E5%85%83%E6%A0%BC%E6%B7%BB%E5%8A%A0%E4%B8%8B%E6%8B%89%E5%88%97%E8%A1%A8/</id>
    <published>2023-12-08T08:09:38.000Z</published>
    <updated>2023-12-11T08:21:28.412Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬åœ¨ä½¿ç”¨excelè¿›è¡Œæ‰¹é‡å¯¼å…¥çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šæä¾›å¯¼å…¥æ¨¡æ¿excelæ¥ç»™ç”¨æˆ·æ¥è§„èŒƒç”¨æˆ·çš„è¾“å…¥ï¼Œå…¶ä¸­å°±ä¼šç”¨åˆ°ä¸‹æ‹‰é€‰é¡¹æ¥çº¦æŸè¿™ä¸€ç§æ–¹å¼</p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/image-20231208165732976.png" alt="image-20231208165732976" style="zoom:50%;" /><h3 id="æ–¹æ³•ä¸€ï¼š-Excel"><a href="#æ–¹æ³•ä¸€ï¼š-Excel" class="headerlink" title="æ–¹æ³•ä¸€ï¼š@Excel"></a>æ–¹æ³•ä¸€ï¼š@Excel</h3><figure class="highlight java"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Excel(name = &quot;çŠ¶æ€&quot;, width = 25, replace = &#123;&quot;å¾…å®¡_1&quot;, &quot;é€šè¿‡_2&quot;, &quot;é©³å›_3&quot;&#125;,addressList = true,orderNum = &quot;25&quot;)</span><br><span class="hljs-keyword">private</span> Integer status;<br></code></pre></td></tr></table></figure><p>ä¸»è¦æ˜¯replaceå’ŒaddressListè¿™ä¸¤ä¸ªå±æ€§é…ç½®ã€‚</p><p><code>replace</code>ï¼šæ›¿æ¢å­—æ®µå†…å®¹ï¼Œé€šå¸¸ç”¨äºçŠ¶æ€å­—æ®µçš„æ˜¾ç¤ºï¼ˆä¾‹å¦‚ï¼šâ€ç”·_1,å¥³_2â€ï¼‰ã€‚</p><p><code>addressList</code>ï¼šæ˜¯å¦ç”Ÿæˆä¸‹æ‹‰çš„é€‰é¡¹ã€‚</p><blockquote><p><code>@Excel</code> æ˜¯ easypoi ä¸­ç”¨äº Excel å¯¼å…¥å¯¼å‡ºçš„æ³¨è§£ï¼Œå¯ä»¥ç”¨äºå®ä½“ç±»çš„å­—æ®µä¸Šï¼Œç”¨ä»¥å®šä¹‰è¯¥å­—æ®µæ•°æ®ä¸ Excel æ–‡ä»¶ä¸­çš„åˆ—çš„å¯¹åº”å…³ç³»ä»¥åŠè¿›è¡Œå¯¼å…¥å¯¼å‡ºæ—¶çš„å„ç§è®¾ç½®ã€‚ä»¥ä¸‹æ˜¯ <code>@Excel</code> æ³¨è§£çš„ä¸€äº›ä¸»è¦å±æ€§å’Œå®ƒä»¬çš„åŠŸèƒ½ï¼š</p><ol><li><code>name</code>ï¼šè®¾ç½®å¯¼å‡ºæ—¶åœ¨è¡¨æ ¼ä¸­çš„æ˜¾ç¤ºåç§°ã€‚</li><li><code>width</code>ï¼šåˆ—å®½åº¦ï¼Œå•ä½ä¸ºå­—ç¬¦ã€‚</li><li><code>height</code>ï¼šè¡Œé«˜åº¦ï¼Œå•ä½ä¸ºå­—ç¬¦ã€‚</li><li><code>orderNum</code>ï¼šå¯¼å‡ºæ’åºé¡ºåºï¼Œæ•°å€¼å°çš„å…ˆå¯¼å‡ºã€‚</li><li><code>needMerge</code>ï¼šæ˜¯å¦éœ€è¦åˆå¹¶å•å…ƒæ ¼ã€‚</li><li><code>mergeVertical</code>ï¼šçºµå‘åˆå¹¶å†…å®¹ç›¸åŒçš„å•å…ƒæ ¼ã€‚</li><li><code>mergeRely</code>ï¼šåˆå¹¶ä¾èµ–äºæŸäº›åˆ—çš„æƒ…å†µã€‚</li><li><code>replace</code>ï¼šæ›¿æ¢å­—æ®µå†…å®¹ï¼Œé€šå¸¸ç”¨äºçŠ¶æ€å­—æ®µçš„æ˜¾ç¤ºï¼ˆä¾‹å¦‚ï¼šâ€ç”·_1,å¥³_2â€ï¼‰ã€‚</li><li><code>suffix</code>ï¼šæ–‡æœ¬åç¼€ï¼Œå¦‚%ã€å…ƒã€ä¸ªã€‚</li><li><code>isImportField</code>ï¼šæ˜¯å¦ä¸ºå¯¼å…¥å­—æ®µï¼Œå¯¼å…¥æ¨¡æ¿æ—¶æ˜¯å¦éœ€è¦æ˜¾ç¤ºã€‚</li><li><code>exportType</code>ï¼šå¯¼å‡ºç±»å‹ï¼ŒæŒ‡å¯¼å‡ºæ–‡æœ¬è¿˜æ˜¯å¯¼å‡ºå›¾ç‰‡ç­‰ç±»å‹ã€‚</li><li><code>format</code>ï¼šæ—¶é—´æ ¼å¼åŒ–ï¼Œæ¯”å¦‚ï¼šâ€yyyy-MM-ddâ€ã€‚</li><li><code>databaseFormat</code>ï¼šæ•°æ®åº“æ ¼å¼ï¼Œé€šå¸¸é…åˆ <code>format</code> ä½¿ç”¨ã€‚</li><li><code>dict</code>ï¼šæ•°æ®å­—å…¸æ ‡è¯†ã€‚</li><li><code>savePath</code>ï¼šå›¾ç‰‡ç­‰æ–‡ä»¶ä¿å­˜è·¯å¾„ã€‚</li><li><code>type</code>ï¼šå­—æ®µç±»å‹ï¼ˆæ–‡æœ¬ã€å›¾ç‰‡ã€æ–‡ä»¶ï¼‰ã€‚</li><li><code>imageType</code>ï¼šå›¾ç‰‡ç±»å‹ï¼Œæ§åˆ¶å¯¼å‡ºå›¾ç‰‡çš„æ–¹å¼ã€‚</li><li><code>suffix</code>ï¼šæ–‡æœ¬ç±»å‹çš„å­—æ®µåç¼€æ ‡è®°ã€‚</li><li><code>statistics</code>ï¼šæ˜¯å¦ç»Ÿè®¡å½“å‰åˆ—ï¼Œç”Ÿæˆç»Ÿè®¡è¡Œã€‚</li></ol></blockquote><h3 id="æ–¹æ³•äºŒï¼šDataValidation"><a href="#æ–¹æ³•äºŒï¼šDataValidation" class="headerlink" title="æ–¹æ³•äºŒï¼šDataValidation"></a>æ–¹æ³•äºŒï¼šDataValidation</h3><p>ç”±äºæœ‰çš„æ—¶å€™æˆ‘ä»¬çš„ä¸‹æ‹‰åˆ—è¡¨é€‰é¡¹æ¥è‡ªæ•°æ®åº“ï¼Œå¯ä»¥ä½¿ç”¨dictå±æ€§æ­é…IExcelDictHandlerï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨workbookä¸Šæ“ä½œï¼ŒæŠŠåˆ—è¡¨çº¦æŸä½œç”¨åˆ°æŒ‡å®šå•å…ƒæ ¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * firstRow å¼€å§‹è¡Œå· æ ¹æ®æ­¤é¡¹ç›®ï¼Œé»˜è®¤ä¸º2(ä¸‹æ ‡0å¼€å§‹)</span><br><span class="hljs-comment">     * lastRow  æ ¹æ®æ­¤é¡¹ç›®ï¼Œé»˜è®¤ä¸ºæœ€å¤§65535</span><br><span class="hljs-comment">     * firstCol åŒºåŸŸä¸­ç¬¬ä¸€ä¸ªå•å…ƒæ ¼çš„åˆ—å· (ä¸‹æ ‡0å¼€å§‹)</span><br><span class="hljs-comment">     * lastCol åŒºåŸŸä¸­æœ€åä¸€ä¸ªå•å…ƒæ ¼çš„åˆ—å·</span><br><span class="hljs-comment">     * strings ä¸‹æ‹‰å†…å®¹</span><br><span class="hljs-comment">     * */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addDropdown</span><span class="hljs-params">(Workbook workbook,<span class="hljs-type">int</span> firstRow, <span class="hljs-type">int</span> col, String[] strings )</span>&#123;<br>       <span class="hljs-comment">//å¯¹å·¥ä½œç°¿ä¸­ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨è¿›è¡Œæ“ä½œ</span><br>        <span class="hljs-type">Sheet</span> <span class="hljs-variable">sheet</span> <span class="hljs-operator">=</span> workbook.getSheetAt(<span class="hljs-number">0</span>);<br>       <span class="hljs-comment">// åˆ›å»º`CellRangeAddressList`å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æŒ‡å®šä¸‹æ‹‰åˆ—è¡¨çš„é€‚ç”¨åŒºåŸŸï¼š</span><br>      <span class="hljs-comment">//è¯¥åŒºåŸŸä»`firstRow`èµ·å§‹è¡Œï¼ˆåŒ…å«ï¼‰åˆ°ç¬¬65535è¡Œï¼ˆåŒ…å«ï¼‰ï¼Œåœ¨`col`åˆ—ä¸Šã€‚ï¼ˆç”±äºæˆ‘ä»¬ä½œç”¨äºåŒä¸€åˆ—ï¼Œæ‰€ä»¥firstCol=lastColï¼‰</span><br>        <span class="hljs-type">CellRangeAddressList</span> <span class="hljs-variable">cellRangeAddressList</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CellRangeAddressList</span>(firstRow, <span class="hljs-number">65535</span>, col,col);<br>        <span class="hljs-type">DataValidationHelper</span> <span class="hljs-variable">helper</span> <span class="hljs-operator">=</span> sheet.getDataValidationHelper();<br>       <span class="hljs-comment">//ä½¿ç”¨ä¼ å…¥çš„å­—ç¬¦ä¸²æ•°ç»„åˆ›å»ºä¸€ä¸ªæ˜¾å¼åˆ—è¡¨çº¦æŸï¼Œç¡®å®šä¸‹æ‹‰åˆ—è¡¨ä¸­çš„é€‰é¡¹</span><br>        <span class="hljs-type">DataValidationConstraint</span> <span class="hljs-variable">dvConstraint</span> <span class="hljs-operator">=</span> helper.createExplicitListConstraint(strings);<br>       <span class="hljs-comment">//æŠŠåˆ›å»ºçš„åˆ—è¡¨çº¦æŸä½œç”¨åˆ°é‚£äº›èŒƒå›´å†…çš„å•å…ƒæ ¼</span><br>        <span class="hljs-type">DataValidation</span> <span class="hljs-variable">validation</span> <span class="hljs-operator">=</span> helper.createValidation(dvConstraint, cellRangeAddressList);<br>       <span class="hljs-comment">//  ä½œç”¨åˆ°sheetä¸Š</span><br>        sheet.addValidationData(validation);<br>    &#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ä»¥ä¸Šä»£ç æœ‰ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå¦‚æœä¸‹æ‹‰é€‰é¡¹è¿‡å¤šï¼Œä¼šæ— æ³•æ˜¾ç¤ºï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦å€ŸåŠ©ä¸€ä¸ªéšè—çš„å­—å…¸sheetï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä¿®æ”¹ä¸€ä¸‹ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addLongDropdown</span><span class="hljs-params">(Workbook workbook,<span class="hljs-type">int</span> firstRow, <span class="hljs-type">int</span> col, String[] strings )</span>&#123;<br>       <span class="hljs-type">XSSFSheet</span> <span class="hljs-variable">sheet</span> <span class="hljs-operator">=</span> (XSSFSheet)workbook.getSheetAt(<span class="hljs-number">0</span>);<br>       <span class="hljs-comment">//é»˜è®¤ä¸ºæœ€å¤§65535</span><br>       <span class="hljs-type">int</span> <span class="hljs-variable">endRow</span> <span class="hljs-operator">=</span><span class="hljs-number">65535</span>;<br>       <span class="hljs-comment">//éšä¾¿èµ·ä¸ªsheetå</span><br>       <span class="hljs-type">String</span> <span class="hljs-variable">hiddenName</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hidden&quot;</span>+col;<br>       <span class="hljs-comment">//1.åˆ›å»ºéšè—çš„sheeté¡µã€‚</span><br>       <span class="hljs-type">XSSFSheet</span> <span class="hljs-variable">hidden</span> <span class="hljs-operator">=</span> (XSSFSheet)workbook.createSheet(hiddenName);<br>       <span class="hljs-comment">//2.å¾ªç¯èµ‹å€¼ï¼ˆä¸ºäº†é˜²æ­¢ä¸‹æ‹‰æ¡†çš„è¡Œæ•°ä¸éšè—åŸŸçš„è¡Œæ•°ç›¸å¯¹åº”ï¼Œå°†éšè—åŸŸåŠ åˆ°ç»“æŸè¡Œä¹‹åï¼‰</span><br>       <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, length = strings.length; i &lt; length; i++) &#123;<br>           hidden.createRow(endRow + i).createCell(col).setCellValue(strings[i]);<br>       &#125;<br>       <span class="hljs-comment">//åˆ›å»ºå¯è¢«å…¶ä»–å•å…ƒæ ¼å¼•ç”¨çš„åç§°</span><br>       <span class="hljs-type">Name</span> <span class="hljs-variable">workbookName</span> <span class="hljs-operator">=</span> workbook.createName();<br>       workbookName.setNameName(hiddenName);<br>       <span class="hljs-comment">//3 A1:Aä»£è¡¨éšè—åŸŸåˆ›å»ºç¬¬Nåˆ—createCell(N)æ—¶ã€‚ä»¥A1åˆ—å¼€å§‹Aè¡Œæ•°æ®è·å–ä¸‹æ‹‰æ•°ç»„</span><br>       workbookName.setRefersToFormula(hiddenName + <span class="hljs-string">&quot;!A1:A&quot;</span> + (strings.length + endRow));<br>       <span class="hljs-type">DataValidationHelper</span> <span class="hljs-variable">helper</span> <span class="hljs-operator">=</span> sheet.getDataValidationHelper();<br>       <span class="hljs-type">DataValidationConstraint</span> <span class="hljs-variable">constraint</span> <span class="hljs-operator">=</span> helper.createFormulaListConstraint(hiddenName);<br>       <span class="hljs-type">CellRangeAddressList</span> <span class="hljs-variable">addressList</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CellRangeAddressList</span>(firstRow, endRow, col, col);<br>       <span class="hljs-type">DataValidation</span> <span class="hljs-variable">dataValidation</span> <span class="hljs-operator">=</span> helper.createValidation(constraint, addressList);<br>       <span class="hljs-keyword">if</span> (dataValidation <span class="hljs-keyword">instanceof</span> XSSFDataValidation) &#123;<br>           <span class="hljs-comment">// æ•°æ®æ ¡éªŒ</span><br>           dataValidation.setSuppressDropDownArrow(<span class="hljs-literal">true</span>);<br>           dataValidation.setShowErrorBox(<span class="hljs-literal">true</span>);<br>       &#125; <span class="hljs-keyword">else</span> &#123;<br>           dataValidation.setSuppressDropDownArrow(<span class="hljs-literal">false</span>);<br>       &#125;<br>       <span class="hljs-comment">// ä½œç”¨åœ¨ç›®æ ‡sheetä¸Š</span><br>       sheet.addValidationData(dataValidation);<br>       <span class="hljs-comment">// ä¸ºäº†ç”¨æˆ·å‹å¥½ï¼Œè®¾ç½®hiddenSheetéšè—</span><br>       workbook.setSheetHidden(workbook.getSheetIndex(hiddenName), <span class="hljs-literal">true</span>);<br>   &#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æˆ‘ä»¬åœ¨ä½¿ç”¨excelè¿›è¡Œæ‰¹é‡å¯¼å…¥çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šæä¾›å¯¼å…¥æ¨¡æ¿excelæ¥ç»™ç”¨æˆ·æ¥è§„èŒƒç”¨æˆ·çš„è¾“å…¥ï¼Œå…¶ä¸­å°±ä¼šç”¨åˆ°ä¸‹æ‹‰é€‰é¡¹æ¥çº¦æŸè¿™ä¸€ç§æ–¹å¼&lt;/p&gt;
&lt;img src=&quot;https://raw.githubusercontent.com/CasonMo/pic-go/master/i</summary>
      
    
    
    
    <category term="Springboot" scheme="https://cason.work/categories/Springboot/"/>
    
    
    <category term="Easypoi" scheme="https://cason.work/tags/Easypoi/"/>
    
    <category term="Excel" scheme="https://cason.work/tags/Excel/"/>
    
  </entry>
  
  <entry>
    <title>Arthas:æ’æŸ¥cpuå¼‚å¸¸è¿‡é«˜çš„é—®é¢˜</title>
    <link href="https://cason.work/2023/10/27/Arthas-%E6%8E%92%E6%9F%A5cpu%E5%BC%82%E5%B8%B8%E8%BF%87%E9%AB%98%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>https://cason.work/2023/10/27/Arthas-%E6%8E%92%E6%9F%A5cpu%E5%BC%82%E5%B8%B8%E8%BF%87%E9%AB%98%E7%9A%84%E9%97%AE%E9%A2%98/</id>
    <published>2023-10-27T03:24:17.000Z</published>
    <updated>2023-12-26T06:56:13.140Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸‹è½½arthas</p><p><code>curl -O https://alibaba.github.io/arthas/arthas-boot.jar</code></p><p>å¯åŠ¨arthas</p><p><code>java -jar arthas-boot.jar</code></p><p>dashboard ä»ªè¡¨æ¿</p><blockquote><p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯æ˜¾ç¤ºJVMä¸­è¿è¡Œçš„æ‰€æœ‰çº¿ç¨‹ï¼šæ‰€åœ¨çº¿ç¨‹ç»„ï¼Œä¼˜å…ˆçº§ï¼Œçº¿ç¨‹çš„çŠ¶æ€ï¼ŒCPUçš„å ç”¨ç‡ï¼Œæ˜¯å¦æ˜¯åå°è¿›ç¨‹ç­‰</p><p>ç¬¬äºŒéƒ¨åˆ†æ˜¾ç¤ºçš„JVMå†…å­˜çš„ä½¿ç”¨æƒ…å†µ</p><p>ç¬¬ä¸‰éƒ¨åˆ†æ˜¯æ“ä½œç³»ç»Ÿçš„ä¸€äº›ä¿¡æ¯å’ŒJavaç‰ˆæœ¬å·</p></blockquote><p><code>dashboard</code></p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/image-20231226145518601.png" alt="image-20231226145518601"></p><p>é€šè¿‡ thread å‘½ä»¤æ¥è·å–çº¿ç¨‹ä¿¡æ¯</p><blockquote><p>1ã€å½“æ²¡æœ‰å‚æ•°æ—¶ï¼Œæ˜¾ç¤ºæ‰€æœ‰çº¿ç¨‹çš„ä¿¡æ¯</p><p>thread<br>2ã€å±•ç¤ºå½“å‰æœ€å¿™çš„å‰3ä¸ªçº¿ç¨‹å¹¶æ‰“å°å †æ ˆ</p><p>thread -n 3<br>3ã€æ˜¾ç¤º1å·çº¿ç¨‹çš„è¿è¡Œå †æ ˆ</p><p>thread 1<br>4ã€æ‰¾å‡ºå½“å‰é˜»å¡å…¶ä»–çº¿ç¨‹çš„çº¿ç¨‹ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å‘ç°åº”ç”¨å¡ä½äº†ï¼Œ é€šå¸¸æ˜¯ç”±äºæŸä¸ªçº¿ç¨‹æ‹¿ä½äº†æŸä¸ªé”ï¼Œ å¹¶ä¸”å…¶ä»–çº¿ç¨‹éƒ½åœ¨ç­‰å¾…è¿™æŠŠé”é€ æˆçš„ã€‚ ä¸ºäº†æ’æŸ¥è¿™ç±»é—®é¢˜ï¼Œ arthasæä¾›äº†thread -bï¼Œ ä¸€é”®æ‰¾å‡ºé‚£ä¸ªç½ªé­ç¥¸é¦–ã€‚</p><p>thread -b<br>5ã€æŒ‡å®šé‡‡æ ·æ—¶é—´é—´éš”ï¼Œæ¯è¿‡1000æ¯«ç§’é‡‡æ ·ï¼Œæ˜¾ç¤ºæœ€å æ—¶é—´çš„3ä¸ªçº¿ç¨‹</p><p>thread -i 1000 -n 3<br>6ã€æŸ¥çœ‹å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹</p></blockquote><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/image-20231226145349492.png" alt="image-20231226145349492"></p><p>æ‰¾å¯¹å¯¹åº”æ–¹æ³•è§£å†³</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¸‹è½½arthas&lt;/p&gt;
&lt;p&gt;&lt;code&gt;curl -O https://alibaba.github.io/arthas/arthas-boot.jar&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¯åŠ¨arthas&lt;/p&gt;
&lt;p&gt;&lt;code&gt;java -jar arthas-boot.</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Elasticseatchç®€å•å®è·µ</title>
    <link href="https://cason.work/2023/09/05/Elasticseatch%E7%AE%80%E5%8D%95%E5%AE%9E%E8%B7%B5/"/>
    <id>https://cason.work/2023/09/05/Elasticseatch%E7%AE%80%E5%8D%95%E5%AE%9E%E8%B7%B5/</id>
    <published>2023-09-05T02:59:45.000Z</published>
    <updated>2023-09-05T07:12:52.154Z</updated>
    
    <content type="html"><![CDATA[<p>Elasticsearchæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼æœç´¢å’Œåˆ†æå¼•æ“ï¼Œç”¨äºå­˜å‚¨ã€æœç´¢å’Œåˆ†æå¤§é‡æ•°æ®ã€‚å®ƒæœ€åˆç”±Elasticsearch BVï¼ˆç°åœ¨ç§°ä¸ºElastic NVï¼‰å¼€å‘ï¼Œæ˜¯Elastic Stackï¼ˆä»¥å‰ç§°ä¸ºELK Stackï¼‰çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ã€‚Elastic Stackæ˜¯ä¸€ä¸ªç”¨äºæ—¥å¿—å’Œæ•°æ®åˆ†æçš„å¼€æºè§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬Elasticsearchã€Logstashå’ŒKibanaã€‚</p><p>Elasticsearchçš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p><ol><li>åˆ†å¸ƒå¼æ€§èƒ½ï¼šElasticsearchå¯ä»¥è½»æ¾åœ°æ‰©å±•åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼Œä»¥å¤„ç†å¤§è§„æ¨¡çš„æ•°æ®å’ŒæŸ¥è¯¢ã€‚å®ƒä½¿ç”¨åˆ†ç‰‡å’Œå¤åˆ¶æ¥ç¡®ä¿æ•°æ®çš„é«˜å¯ç”¨æ€§å’Œæ€§èƒ½ã€‚</li><li>å®æ—¶æœç´¢ï¼šElasticsearchèƒ½å¤Ÿåœ¨æ–‡æ¡£è¢«ç´¢å¼•åå‡ ä¹ç«‹å³æä¾›å®æ—¶æœç´¢ç»“æœï¼Œä½¿å…¶éå¸¸é€‚ç”¨äºå„ç§åº”ç”¨ï¼ŒåŒ…æ‹¬æ—¥å¿—åˆ†æã€æœç´¢å¼•æ“ã€ç›‘æ§å’Œä»ªè¡¨æ¿ç­‰ã€‚</li><li>å¤šæ•°æ®ç±»å‹æ”¯æŒï¼šElasticsearchæ”¯æŒå¤šç§æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€æ•°å€¼ã€æ—¥æœŸã€åœ°ç†ä½ç½®ç­‰ã€‚è¿™ä½¿å¾—å®ƒéå¸¸çµæ´»ï¼Œå¯ä»¥åº”ç”¨äºå„ç§ä¸åŒç±»å‹çš„æ•°æ®åˆ†æä»»åŠ¡ã€‚</li><li>å¼ºå¤§çš„æŸ¥è¯¢åŠŸèƒ½ï¼šElasticsearchæä¾›äº†ä¸°å¯Œçš„æŸ¥è¯¢è¯­è¨€å’ŒåŠŸèƒ½ï¼ŒåŒ…æ‹¬å…¨æ–‡æœç´¢ã€æ¨¡ç³Šæœç´¢ã€èŒƒå›´æŸ¥è¯¢ã€èšåˆåˆ†æç­‰ï¼Œä½¿ç”¨æˆ·å¯ä»¥é’ˆå¯¹ä¸åŒçš„æ•°æ®è¿›è¡Œå¤æ‚çš„æŸ¥è¯¢å’Œåˆ†æã€‚</li><li>å¯æ‰©å±•æ€§å’Œæ’ä»¶ç”Ÿæ€ç³»ç»Ÿï¼šElasticsearchå…·æœ‰ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€ç³»ç»Ÿï¼Œå¯ä»¥æ‰©å±•å…¶åŠŸèƒ½ï¼ŒåŒ…æ‹¬å®‰å…¨æ€§ã€ç›‘æ§ã€æŠ¥å‘Šç­‰æ–¹é¢ã€‚</li><li>å¼€æºå’Œå…è´¹ï¼šElasticsearchæ˜¯å¼€æºè½¯ä»¶ï¼Œå¯å…è´¹ä½¿ç”¨ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªæ´»è·ƒçš„ç¤¾åŒºæ”¯æŒå’Œç»´æŠ¤ã€‚</li></ol><p>Elasticsearché€šå¸¸ä¸å…¶ä»–Elastic Stackç»„ä»¶ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚Logstashç”¨äºæ•°æ®æ”¶é›†å’Œå¤„ç†ï¼ŒKibanaç”¨äºæ•°æ®å¯è§†åŒ–å’Œä»ªè¡¨æ¿åˆ›å»ºã€‚è¿™äº›ç»„ä»¶å…±åŒæ„å»ºäº†å¼ºå¤§çš„æ•°æ®åˆ†æå’Œæœç´¢è§£å†³æ–¹æ¡ˆï¼Œå¹¿æ³›ç”¨äºå„ç§åº”ç”¨é¢†åŸŸï¼ŒåŒ…æ‹¬ä¼ä¸šæœç´¢ã€æ—¥å¿—åˆ†æã€å®‰å…¨ä¿¡æ¯å’Œäº‹ä»¶ç®¡ç†ï¼ˆSIEMï¼‰ã€ç”µå­å•†åŠ¡æœç´¢ç­‰ã€‚</p><h2 id="å®‰è£…ElasticSearch"><a href="#å®‰è£…ElasticSearch" class="headerlink" title="å®‰è£…ElasticSearch"></a>å®‰è£…ElasticSearch</h2><ul><li><p>ä»Dockeré•œåƒä»“åº“ï¼ˆé€šå¸¸æ˜¯Docker Hubæˆ–å…¶ä»–é•œåƒä»“åº“ï¼‰ä¸‹è½½ï¼ˆæˆ–æ‹‰å–ï¼‰elasticsearché•œåƒåˆ°æœ¬åœ°è®¡ç®—æœº</p><figure class="highlight shell"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs shell">docker pull elasticsearch:7.16.2<br></code></pre></td></tr></table></figure></li><li><p>åˆ›å»ºå¯åŠ¨ä¸€ä¸ªåä¸º â€œesâ€ çš„åå°è¿è¡Œçš„Elasticsearchå®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d --name es -p 9200:9200 -p 9300:9300 -e ES_JAVA_OPTS=&quot;-Xms256m -Xmx256m&quot; -e &quot;discovery.type=single-node&quot; -v es:/usr/share/elasticsearch/data  elasticsearch:7.16.2<br></code></pre></td></tr></table></figure><blockquote><ol><li><code>docker run</code>: è¿™æ˜¯Dockerå‘½ä»¤è¡Œå·¥å…·ä¸­ç”¨äºåˆ›å»ºå’Œè¿è¡Œå®¹å™¨çš„å‘½ä»¤ã€‚</li><li><code>-d</code>: è¿™æ˜¯ä¸€ä¸ªé€‰é¡¹ï¼Œè¡¨ç¤ºå®¹å™¨å°†ä»¥åå°ï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰æ¨¡å¼è¿è¡Œï¼Œå³ä¸ä¼šé˜»æ­¢ç»ˆç«¯ã€‚</li><li><code>--name es</code>: è¿™æ˜¯ä¸€ä¸ªé€‰é¡¹ï¼Œç”¨äºæŒ‡å®šå®¹å™¨çš„åç§°ä¸º â€œesâ€ã€‚è¿™å°†ä½¿æ‚¨èƒ½å¤Ÿä½¿ç”¨å®¹å™¨åç§°å¼•ç”¨å®¹å™¨ï¼Œè€Œä¸å¿…ä¾èµ–äºå®¹å™¨çš„IDã€‚</li><li><code>-p 9200:9200 -p 9300:9300</code>: è¿™æ˜¯ç”¨äºç«¯å£æ˜ å°„çš„é€‰é¡¹ã€‚å®ƒå°†å®¹å™¨å†…éƒ¨çš„9200ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„9200ç«¯å£ï¼ŒåŒæ—¶å°†å®¹å™¨å†…éƒ¨çš„9300ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„9300ç«¯å£ã€‚è¿™äº›ç«¯å£æ˜¯Elasticsearchç”¨äºä¸å¤–éƒ¨é€šä¿¡çš„ç«¯å£ï¼Œå…¶ä¸­9200ç”¨äºHTTPè¯·æ±‚ï¼Œ9300ç”¨äºå†…éƒ¨èŠ‚ç‚¹é€šä¿¡ã€‚</li><li><code>-e ES_JAVA_OPTS=&quot;-Xms256m -Xmx256m&quot;</code>: è¿™æ˜¯ä¸€ä¸ªé€‰é¡¹ï¼Œç”¨äºè®¾ç½®Elasticsearchçš„Javaè™šæ‹Ÿæœºé€‰é¡¹ã€‚åœ¨è¿™é‡Œï¼Œå®ƒè®¾ç½®äº†åˆå§‹å †å¤§å°ï¼ˆXmsï¼‰å’Œæœ€å¤§å †å¤§å°ï¼ˆXmxï¼‰éƒ½ä¸º256MBï¼Œä»¥æ§åˆ¶Elasticsearchä½¿ç”¨çš„å†…å­˜ã€‚</li><li><code>-e &quot;discovery.type=single-node&quot;</code>: è¿™æ˜¯å¦ä¸€ä¸ªé€‰é¡¹ï¼Œç”¨äºè®¾ç½®Elasticsearchçš„å‘ç°ç±»å‹ä¸º â€œsingle-nodeâ€ã€‚è¿™è¡¨ç¤ºElasticsearchå°†ä½œä¸ºå•èŠ‚ç‚¹è¿è¡Œï¼Œé€‚ç”¨äºå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒã€‚</li><li><code>-v es:/usr/share/elasticsearch/data</code>: è¿™æ˜¯ä¸€ä¸ªé€‰é¡¹ï¼Œç”¨äºå°†ä¸»æœºçš„ä¸€ä¸ªå·ï¼ˆvolumeï¼‰æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨çš„ç›®å½•ã€‚è¿™é‡Œå°†ä¸»æœºä¸Šçš„åä¸º â€œesâ€ çš„å·æŒ‚è½½åˆ°å®¹å™¨å†…çš„ â€œ&#x2F;usr&#x2F;share&#x2F;elasticsearch&#x2F;dataâ€ ç›®å½•ï¼Œç”¨äºæŒä¹…åŒ–å­˜å‚¨Elasticsearchçš„æ•°æ®ã€‚</li><li><code>elasticsearch:7.16.2</code>: è¿™æ˜¯è¦è¿è¡Œçš„Dockeré•œåƒçš„åç§°å’Œæ ‡ç­¾ã€‚å…·ä½“æ¥è¯´ï¼Œè¿™æ˜¯Elasticsearch 7.16.2é•œåƒçš„æ ‡è¯†ï¼ŒDockerå°†æ ¹æ®æ­¤æ ‡è¯†ä»Docker Hubæ‹‰å–é•œåƒå¹¶åˆ›å»ºå®¹å™¨ã€‚</li></ol></blockquote></li><li><p>è¿›å…¥åä¸º â€œesâ€ çš„å®¹å™¨ï¼Œå¹¶ä»¥äº¤äº’æ–¹å¼ï¼ˆ<code>-it</code>æ ‡å¿—ï¼‰å¯åŠ¨ä¸€ä¸ªbash shellã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker exec -it es /bin/bash<br></code></pre></td></tr></table></figure></li><li><p>åœ¨å®¹å™¨å†…å®‰è£…ikä¸­æ–‡åˆ†è¯å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">bin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.16.2/elasticsearch-analysis-ik-7.16.2.zip<br></code></pre></td></tr></table></figure></li><li><p>é‡å¯eså®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker restart es<br></code></pre></td></tr></table></figure></li><li><p>éªŒè¯åˆ†è¯æ’ä»¶æ˜¯å¦å®‰è£…æˆåŠŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">// å¢åŠ ä¸€ä¸ªå«test001çš„ç´¢å¼•<br>curl -X PUT http://localhost:9200/test001<br>// æˆåŠŸè¿”å› &#123;&quot;acknowledged&quot;:true,&quot;shards_acknowledged&quot;:true,&quot;index&quot;:&quot;test001&quot;&#125;<br><br>// ik_smartåˆ†è¯<br>curl -X POST \<br>&#x27;http://127.0.0.1:9200/test001/_analyze?pretty=true&#x27; \<br>-H &#x27;Content-Type: application/json&#x27; \<br>-d &#x27;&#123;&quot;text&quot;:&quot;æˆ‘ä»¬æ˜¯è½¯ä»¶å·¥ç¨‹å¸ˆ&quot;,&quot;tokenizer&quot;:&quot;ik_smart&quot;&#125;&#x27;<br><br>// ik_max_wordåˆ†è¯<br>curl -X POST \<br>&#x27;http://127.0.0.1:9200/test001/_analyze?pretty=true&#x27; \<br>-H &#x27;Content-Type: application/json&#x27; \<br>-d &#x27;&#123;&quot;text&quot;:&quot;æˆ‘ä»¬æ˜¯è½¯ä»¶å·¥ç¨‹å¸ˆ&quot;,&quot;tokenizer&quot;:&quot;ik_max_word&quot;&#125;&#x27;<br></code></pre></td></tr></table></figure></li><li><p>æˆ‘ä»¬å¯ä»¥åœ¨æœ¬æœºçš„ host æ–‡ä»¶ä¸­ï¼Œæ·»åŠ æ˜ å°„ï¼Œå°† <code>127.0.0.1 host.docker.internal</code>;</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">host.docker.internal 127.0.0.1<br></code></pre></td></tr></table></figure></li><li><p>åˆ›å»ºå¯åŠ¨ä¸€ä¸ªåä¸º â€œkibanaâ€ çš„åå°è¿è¡Œçš„kibanaå®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run --name kibana -e ELASTICSEARCH_HOSTS=http://host.docker.internal:9200 -p 5601:5601 -d kibana:7.16.2<br></code></pre></td></tr></table></figure></li><li><p>è®¿é—®<a href="http://localhost:5601åˆ¤æ–­kibanaæ˜¯å¦å¯åŠ¨æˆåŠŸ">http://localhost:5601åˆ¤æ–­kibanaæ˜¯å¦å¯åŠ¨æˆåŠŸ</a></p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202309051448318.png" alt="image-20230905114036359"></p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202309051448326.png" alt="image-20230905114212959"></p></li></ul><h2 id="é›†æˆSpringboot"><a href="#é›†æˆSpringboot" class="headerlink" title="é›†æˆSpringboot"></a>é›†æˆSpringboot</h2><ul><li><p>æ·»åŠ Elasticsearchå®¢æˆ·ç«¯åº“ä¾èµ–é¡¹ï¼šè¿™é‡Œæˆ‘æ˜¯è·Ÿç€springbootçš„ç‰ˆæœ¬ 2.3.9.RELEASE</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-elasticsearch<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>åœ¨<code>application.properties</code>æˆ–<code>application.yml</code>é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®Elasticsearchè¿æ¥ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä¸»æœºåã€ç«¯å£å·ç­‰ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">data:</span><br>    <span class="hljs-attr">elasticsearch:</span><br>      <span class="hljs-attr">client:</span><br>        <span class="hljs-attr">reactive:</span><br>          <span class="hljs-attr">endpoints:</span> <span class="hljs-string">http://localhost:9200</span><br></code></pre></td></tr></table></figure></li><li><p>åˆ›å»ºå®ä½“ç±»ï¼š åˆ›å»ºä¸€ä¸ªå®ä½“ç±»ï¼Œè¡¨ç¤ºè¦å­˜å‚¨åœ¨Elasticsearchä¸­çš„æ–‡æ¡£ã€‚è¯¥å®ä½“ç±»éœ€è¦ä½¿ç”¨<code>@Document</code>æ³¨è§£æ¥æŒ‡å®šä¸Elasticsearchç´¢å¼•çš„æ˜ å°„ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@Document(indexName = &quot;test_index&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestIndex</span> &#123;<br>    <span class="hljs-meta">@Id</span><br>    <span class="hljs-keyword">private</span> String id;<br>    <span class="hljs-keyword">private</span> String title;<br>    <span class="hljs-keyword">private</span> String content;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;TestIndex&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&#x27;&quot;</span> + id + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, title=&#x27;&quot;</span> + title + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, content=&#x27;&quot;</span> + content + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>åˆ›å»ºElasticsearchå­˜å‚¨åº“ï¼ˆRepositoryï¼‰ï¼š åˆ›å»ºä¸€ä¸ªElasticsearchå­˜å‚¨åº“æ¥å£ï¼Œå®ƒå°†ç»§æ‰¿è‡ªSpring Data Elasticsearchçš„<code>ElasticsearchRepository</code>ã€‚è¿™ä¸ªå­˜å‚¨åº“å°†ç”¨äºå®šä¹‰ä¸Elasticsearchç´¢å¼•çš„äº¤äº’ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">TestIndexElasticsearchRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ElasticsearchRepository</span>&lt;TestIndex, String&gt; &#123;<br>    List&lt;TestIndex&gt; <span class="hljs-title function_">findAllByContent</span><span class="hljs-params">(String content)</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>åœ¨testä¸‹åˆ›å»ºæµ‹è¯•ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseTest</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> TestIndexElasticsearchRepository testIndexElasticsearchRepository;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">save</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">TestIndex</span> <span class="hljs-variable">testIndex</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestIndex</span>();<br>        testIndex.setId(<span class="hljs-string">&quot;1&quot;</span>);<br>        testIndex.setTitle(<span class="hljs-string">&quot;ä½ å¥½&quot;</span>);<br>        testIndex.setContent(<span class="hljs-string">&quot;æˆ‘æ˜¯javaå¼€å‘å·¥ç¨‹å¸ˆ&quot;</span>);<br>        <span class="hljs-type">TestIndex</span> <span class="hljs-variable">save</span> <span class="hljs-operator">=</span> testIndexElasticsearchRepository.save(testIndex);<br>        System.out.println(save);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">search</span><span class="hljs-params">()</span> &#123;<br>        List&lt;TestIndex&gt; testIndices = testIndexElasticsearchRepository.findAllByContent(<span class="hljs-string">&quot;java&quot;</span>);<br>        <span class="hljs-keyword">for</span> (TestIndex index : testIndices) &#123;<br>            System.out.println(index);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">find</span><span class="hljs-params">()</span> &#123;<br>        Iterable&lt;TestIndex&gt; testIndices = testIndexElasticsearchRepository.findAll();<br>        <span class="hljs-keyword">for</span> (TestIndex index : testIndices) &#123;<br>            System.out.println(index);<br>        &#125;<br>        <span class="hljs-type">TestIndex</span> <span class="hljs-variable">testIndex</span> <span class="hljs-operator">=</span> testIndexElasticsearchRepository.findById(<span class="hljs-string">&quot;1&quot;</span>).get();<br>        System.out.println(testIndex);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">()</span> &#123;<br>        testIndexElasticsearchRepository.deleteById(<span class="hljs-string">&quot;1&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æ£€æŸ¥æ‰§è¡Œç»“æœ</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202309051448825.png" alt="image-20230905144512754"></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Elasticsearchæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼æœç´¢å’Œåˆ†æå¼•æ“ï¼Œç”¨äºå­˜å‚¨ã€æœç´¢å’Œåˆ†æå¤§é‡æ•°æ®ã€‚å®ƒæœ€åˆç”±Elasticsearch BVï¼ˆç°åœ¨ç§°ä¸ºElastic NVï¼‰å¼€å‘ï¼Œæ˜¯Elastic Stackï¼ˆä»¥å‰ç§°ä¸ºELK Stackï¼‰çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ã€‚Elastic Stackæ˜¯ä¸€ä¸ª</summary>
      
    
    
    
    <category term="Springboot" scheme="https://cason.work/categories/Springboot/"/>
    
    
    <category term="åˆ†å¸ƒå¼ç³»ç»Ÿ" scheme="https://cason.work/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"/>
    
    <category term="ElasticSearch" scheme="https://cason.work/tags/ElasticSearch/"/>
    
    <category term="æœç´¢ä¸åˆ†æå¼•æ“" scheme="https://cason.work/tags/%E6%90%9C%E7%B4%A2%E4%B8%8E%E5%88%86%E6%9E%90%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†å¸ƒå¼äº‹åŠ¡-Seataç®€å•å®è·µ</title>
    <link href="https://cason.work/2023/08/28/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1-Seata%E7%AE%80%E5%8D%95%E5%AE%9E%E8%B7%B5/"/>
    <id>https://cason.work/2023/08/28/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1-Seata%E7%AE%80%E5%8D%95%E5%AE%9E%E8%B7%B5/</id>
    <published>2023-08-28T12:19:45.000Z</published>
    <updated>2023-09-05T07:10:15.558Z</updated>
    
    <content type="html"><![CDATA[<p>å½“æ¶‰åŠå¤šä¸ªä¸åŒçš„è®¡ç®—æœºæˆ–ç³»ç»Ÿä¹‹é—´çš„æ“ä½œæ—¶ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡æ˜¯ç¡®ä¿è¿™äº›æ“ä½œåœ¨ä¸€ç»„ç›¸å…³çš„äº‹åŠ¡ä¸­ä¿æŒä¸€è‡´æ€§å’Œéš”ç¦»æ€§çš„æœºåˆ¶ã€‚åœ¨ä¼ ç»Ÿçš„å•æœºäº‹åŠ¡ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ•°æ®åº“çš„äº‹åŠ¡æ¥ç¡®ä¿æ“ä½œçš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§ã€‚ç„¶è€Œï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ•°æ®åˆ†å¸ƒåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œå¯èƒ½æ¶‰åŠç½‘ç»œé—®é¢˜ã€èŠ‚ç‚¹æ•…éšœç­‰ï¼Œä½¿å¾—ä¿æŒä¸€è‡´æ€§å˜å¾—æ›´åŠ å¤æ‚ã€‚åˆ†å¸ƒå¼äº‹åŠ¡éœ€è¦è§£å†³ä»¥ä¸‹æŒ‘æˆ˜ï¼š</p><ol><li><strong>åŸå­æ€§ï¼ˆAtomicityï¼‰</strong>ï¼šåˆ†å¸ƒå¼äº‹åŠ¡è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼Œä¸èƒ½åªå®Œæˆéƒ¨åˆ†æ“ä½œã€‚è¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªæ“ä½œå¤±è´¥ï¼Œæ‰€æœ‰æ¶‰åŠçš„æ“ä½œéƒ½å¿…é¡»å›æ»šã€‚</li><li><strong>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰</strong>ï¼šäº‹åŠ¡å¼€å§‹å‰å’Œç»“æŸåï¼Œç³»ç»Ÿå¿…é¡»ä¿æŒä¸€è‡´çŠ¶æ€ã€‚å³ä½¿åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œäº‹åŠ¡ä¹Ÿå¿…é¡»ç¡®ä¿æ•°æ®ä¸ä¼šè¿›å…¥ä¸ä¸€è‡´çŠ¶æ€ã€‚</li><li><strong>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</strong>ï¼šåœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå„ä¸ªäº‹åŠ¡ä¹‹é—´åº”è¯¥ç›¸äº’éš”ç¦»ï¼Œä»¥é¿å…å¹¶å‘æ‰§è¡Œå¯¼è‡´çš„é—®é¢˜ï¼Œä¾‹å¦‚è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚</li><li><strong>æŒä¹…æ€§ï¼ˆDurabilityï¼‰</strong>ï¼šä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œå…¶ç»“æœåº”è¯¥æŒä¹…ä¿å­˜ï¼Œå³ä½¿å‘ç”Ÿç³»ç»Ÿæ•…éšœä¹Ÿä¸åº”ä¸¢å¤±ã€‚</li></ol><p>åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å¼</p><ol><li><strong>XAæ¨¡å¼</strong>ï¼š XAæ˜¯ä¸€ç§æ ‡å‡†çš„åˆ†å¸ƒå¼äº‹åŠ¡åè®®ï¼Œå®ƒåœ¨ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰çš„åŸºç¡€ä¸Šå®ç°äº†åˆ†å¸ƒå¼äº‹åŠ¡çš„ACIDå±æ€§ã€‚XAæ¶‰åŠä¸¤ä¸ªè§’è‰²ï¼šäº‹åŠ¡ç®¡ç†å™¨ï¼ˆTMï¼‰å’Œèµ„æºç®¡ç†å™¨ï¼ˆRMï¼‰ã€‚åœ¨ç¬¬ä¸€é˜¶æ®µï¼ŒTMè¦æ±‚æ‰€æœ‰RMé¢„æäº¤äº‹åŠ¡ã€‚åœ¨ç¬¬äºŒé˜¶æ®µï¼ŒTMå‘é€å…¨å±€æäº¤æˆ–å›æ»šå‘½ä»¤ï¼ŒRMæ‰§è¡Œå¯¹åº”æ“ä½œã€‚è™½ç„¶XAç¡®ä¿äº†ä¸€è‡´æ€§ï¼Œä½†å®ƒçš„ç¼ºç‚¹æ˜¯å¯èƒ½ä¼šå¯¼è‡´é˜»å¡ï¼Œå°¤å…¶æ˜¯åœ¨ç½‘ç»œæ•…éšœæˆ–å‚ä¸è€…æ•…éšœçš„æƒ…å†µä¸‹ã€‚</li><li><strong>ATæ¨¡å¼ï¼ˆAutomatic Transactionï¼‰</strong>ï¼š ATæ¨¡å¼æ˜¯ä¸€ç§åŸºäºæ•°æ®åº“çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡è‡ªåŠ¨åŒ–äº‹åŠ¡çš„æäº¤å’Œå›æ»šæ¥å®ç°ä¸€è‡´æ€§ã€‚æ¯ä¸ªå‚ä¸è€…èŠ‚ç‚¹åœ¨æ‰§è¡Œäº‹åŠ¡ä¹‹å‰ä¼šå…ˆå°è¯•æ‰§è¡Œæ“ä½œï¼Œç„¶åè®°å½•æ“ä½œäº§ç”Ÿçš„å½±å“ã€‚å¦‚æœæ‰€æœ‰å‚ä¸è€…çš„æ“ä½œéƒ½æˆåŠŸï¼Œé‚£ä¹ˆäº‹åŠ¡å°±ä¼šè¢«è‡ªåŠ¨æäº¤ã€‚å¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªå‚ä¸è€…çš„æ“ä½œå¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡ä¼šè¢«å›æ»šã€‚ATæ¨¡å¼é¿å…äº†2PCçš„é˜»å¡é—®é¢˜ï¼Œä½†å¯èƒ½å¯¼è‡´éƒ¨åˆ†å¤±è´¥é—®é¢˜ã€‚</li><li><strong>TCCæ¨¡å¼ï¼ˆTry-Confirm-Cancelï¼‰</strong>ï¼š TCCæ¨¡å¼é€šè¿‡å°†ä¸€ä¸ªå¤§äº‹åŠ¡åˆ†è§£ä¸ºä¸‰ä¸ªé˜¶æ®µæ¥å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå°è¯•ï¼ˆTryï¼‰ã€ç¡®è®¤ï¼ˆConfirmï¼‰å’Œå–æ¶ˆï¼ˆCancelï¼‰ã€‚åœ¨å°è¯•é˜¶æ®µï¼Œæ‰€æœ‰å‚ä¸è€…éƒ½ä¼šå°è¯•æ‰§è¡Œæ“ä½œã€‚åœ¨ç¡®è®¤é˜¶æ®µï¼Œå¦‚æœæ‰€æœ‰å‚ä¸è€…çš„æ“ä½œéƒ½æˆåŠŸï¼Œå°±ä¼šè¿›è¡Œç¡®è®¤æ“ä½œã€‚å¦‚æœä»»ä½•æ“ä½œå¤±è´¥ï¼Œå°±ä¼šè¿›è¡Œå–æ¶ˆæ“ä½œã€‚TCCæ¨¡å¼æä¾›äº†æ›´ç»†ç²’åº¦çš„æ§åˆ¶ï¼Œä½†éœ€è¦åœ¨ä»£ç ä¸­æ˜¾å¼ç¼–å†™ç¡®è®¤å’Œå–æ¶ˆé€»è¾‘ã€‚</li><li><strong>Sagaæ¨¡å¼</strong>ï¼š Sagaæ¨¡å¼å°†ä¸€ä¸ªå¤§äº‹åŠ¡æ‹†åˆ†ä¸ºä¸€ç³»åˆ—å°æ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½æ˜¯ä¸€ä¸ªåŸå­æ“ä½œã€‚æ¯ä¸ªæ­¥éª¤éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„è¡¥å¿æ“ä½œï¼Œç”¨äºæ’¤é”€è¯¥æ­¥éª¤çš„å½±å“ã€‚å¦‚æœä¸€ä¸ªæ­¥éª¤å¤±è´¥ï¼Œå°±ä¼šè§¦å‘å…¶å…³è”çš„è¡¥å¿æ“ä½œï¼Œå°†ç³»ç»ŸçŠ¶æ€å›æ»šåˆ°ä¸€è‡´çŠ¶æ€ã€‚Sagaæ¨¡å¼é€‚ç”¨äºåˆ†å¸ƒå¼ç¯å¢ƒä¸­çš„é•¿æ—¶é—´äº‹åŠ¡ï¼Œä½†éœ€è¦å¼€å‘äººå‘˜ä»”ç»†è®¾è®¡è¡¥å¿é€»è¾‘ã€‚</li></ol><h2 id="Seata"><a href="#Seata" class="headerlink" title="Seata"></a>Seata</h2><h3 id="å®‰è£…é…ç½®"><a href="#å®‰è£…é…ç½®" class="headerlink" title="å®‰è£…é…ç½®"></a>å®‰è£…é…ç½®</h3><ul><li><p>ä¸‹è½½</p><p>ç‚¹å‡»é“¾æ¥è¿›å»ä¸‹è½½ï¼š<a href="https://seata.io/zh-cn/blog/download.html">https://seata.io/zh-cn/blog/download.html</a></p><p>æœ¬æ–‡çš„seataç‰ˆæœ¬ä¸º1.7.0</p></li><li><p>é…ç½®</p><ul><li><p>å‚è€ƒconf&#x2F;application.example.ymlä¿®æ”¹conf&#x2F;application.yml</p><figure class="highlight yaml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></div></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">7091</span><br><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">seata-server</span><br><br><span class="hljs-attr">logging:</span><br>  <span class="hljs-attr">config:</span> <span class="hljs-string">classpath:logback-spring.xml</span><br>  <span class="hljs-attr">file:</span><br>    <span class="hljs-attr">path:</span> <span class="hljs-string">$&#123;user.home&#125;/logs/seata</span><br><br><span class="hljs-attr">console:</span><br>  <span class="hljs-attr">user:</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">seata</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-string">seata</span><br><span class="hljs-attr">seata:</span><br>  <span class="hljs-attr">config:</span><br>    <span class="hljs-comment"># support: nacos, consul, apollo, zk, etcd3</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">nacos</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span><br>      <span class="hljs-attr">namespace:</span><br>      <span class="hljs-attr">group:</span> <span class="hljs-string">SEATA_GROUP</span><br>      <span class="hljs-attr">username:</span> <span class="hljs-string">nacos</span><br>      <span class="hljs-attr">password:</span> <span class="hljs-string">nacos</span><br>      <span class="hljs-attr">context-path:</span><br>      <span class="hljs-comment">##if use MSE Nacos with auth, mutex with username/password attribute</span><br>      <span class="hljs-comment">#access-key:</span><br>      <span class="hljs-comment">#secret-key:</span><br>      <span class="hljs-attr">data-id:</span> <span class="hljs-string">seataServer.properties</span><br>    <span class="hljs-attr">consul:</span><br>  <span class="hljs-attr">registry:</span><br>    <span class="hljs-comment"># support: nacos, eureka, redis, zk, consul, etcd3, sofa</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">nacos</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-attr">application:</span> <span class="hljs-string">seata-server</span><br>      <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span><br>      <span class="hljs-attr">group:</span> <span class="hljs-string">SEATA_GROUP</span><br>      <span class="hljs-attr">namespace:</span><br>      <span class="hljs-attr">cluster:</span> <span class="hljs-string">default</span><br>      <span class="hljs-attr">username:</span> <span class="hljs-string">nacos</span><br>      <span class="hljs-attr">password:</span> <span class="hljs-string">nacos</span><br>      <span class="hljs-attr">context-path:</span><br>  <span class="hljs-attr">store:</span><br>    <span class="hljs-comment"># support: file ã€ db ã€ redis</span><br>    <span class="hljs-attr">mode:</span> <span class="hljs-string">db</span><br>    <span class="hljs-attr">db:</span><br>      <span class="hljs-attr">datasource:</span> <span class="hljs-string">druid</span><br>      <span class="hljs-attr">db-type:</span> <span class="hljs-string">mysql</span><br>      <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.jdbc.Driver</span><br>      <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://127.0.0.1:3306/seata?rewriteBatchedStatements=true</span><br>      <span class="hljs-attr">user:</span> <span class="hljs-string">root</span><br>      <span class="hljs-attr">password:</span> <span class="hljs-string">root</span><br>      <span class="hljs-attr">min-conn:</span> <span class="hljs-number">10</span><br>      <span class="hljs-attr">max-conn:</span> <span class="hljs-number">100</span><br>      <span class="hljs-attr">global-table:</span> <span class="hljs-string">global_table</span><br>      <span class="hljs-attr">branch-table:</span> <span class="hljs-string">branch_table</span><br>      <span class="hljs-attr">lock-table:</span> <span class="hljs-string">lock_table</span><br>      <span class="hljs-attr">distributed-lock-table:</span> <span class="hljs-string">distributed_lock</span><br>      <span class="hljs-attr">query-limit:</span> <span class="hljs-number">1000</span><br>      <span class="hljs-attr">max-wait:</span> <span class="hljs-number">5000</span><br><span class="hljs-comment">#  server:</span><br><span class="hljs-comment">#    service-port: 8091 #If not configured, the default is &#x27;$&#123;server.port&#125; + 1000&#x27;</span><br>  <span class="hljs-attr">security:</span><br>    <span class="hljs-attr">secretKey:</span> <span class="hljs-string">SeataSecretKey0c382ef121d778043159209298fd40bf3850a017</span><br>    <span class="hljs-attr">tokenValidityInMilliseconds:</span> <span class="hljs-number">1800000</span><br>    <span class="hljs-attr">ignore:</span><br>      <span class="hljs-attr">urls:</span> <span class="hljs-string">/,/**/*.css,/**/*.js,/**/*.html,/**/*.map,/**/*.svg,/**/*.png,/**/*.jpeg,/**/*.ico,/api/v1/auth/login</span><br></code></pre></td></tr></table></figure></li><li><p>mysqlæ•°æ®åº“åˆ›å»ºseataåº“å¹¶æ‰§è¡Œ&#x2F;seata&#x2F;script&#x2F;server&#x2F;db&#x2F;mysql.sql</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs mysql">-- -------------------------------- The script used when storeMode is &#x27;db&#x27; --------------------------------<br>-- the table to store GlobalSession data<br>CREATE TABLE IF NOT EXISTS `global_table`<br>(<br>    `xid`                       VARCHAR(128) NOT NULL,<br>    `transaction_id`            BIGINT,<br>    `status`                    TINYINT      NOT NULL,<br>    `application_id`            VARCHAR(32),<br>    `transaction_service_group` VARCHAR(32),<br>    `transaction_name`          VARCHAR(128),<br>    `timeout`                   INT,<br>    `begin_time`                BIGINT,<br>    `application_data`          VARCHAR(2000),<br>    `gmt_create`                DATETIME,<br>    `gmt_modified`              DATETIME,<br>    PRIMARY KEY (`xid`),<br>    KEY `idx_status_gmt_modified` (`status` , `gmt_modified`),<br>    KEY `idx_transaction_id` (`transaction_id`)<br>) ENGINE = InnoDB<br>  DEFAULT CHARSET = utf8mb4;<br><br>-- the table to store BranchSession data<br>CREATE TABLE IF NOT EXISTS `branch_table`<br>(<br>    `branch_id`         BIGINT       NOT NULL,<br>    `xid`               VARCHAR(128) NOT NULL,<br>    `transaction_id`    BIGINT,<br>    `resource_group_id` VARCHAR(32),<br>    `resource_id`       VARCHAR(256),<br>    `branch_type`       VARCHAR(8),<br>    `status`            TINYINT,<br>    `client_id`         VARCHAR(64),<br>    `application_data`  VARCHAR(2000),<br>    `gmt_create`        DATETIME(6),<br>    `gmt_modified`      DATETIME(6),<br>    PRIMARY KEY (`branch_id`),<br>    KEY `idx_xid` (`xid`)<br>) ENGINE = InnoDB<br>  DEFAULT CHARSET = utf8mb4;<br><br>-- the table to store lock data<br>CREATE TABLE IF NOT EXISTS `lock_table`<br>(<br>    `row_key`        VARCHAR(128) NOT NULL,<br>    `xid`            VARCHAR(128),<br>    `transaction_id` BIGINT,<br>    `branch_id`      BIGINT       NOT NULL,<br>    `resource_id`    VARCHAR(256),<br>    `table_name`     VARCHAR(32),<br>    `pk`             VARCHAR(36),<br>    `status`         TINYINT      NOT NULL DEFAULT &#x27;0&#x27; COMMENT &#x27;0:locked ,1:rollbacking&#x27;,<br>    `gmt_create`     DATETIME,<br>    `gmt_modified`   DATETIME,<br>    PRIMARY KEY (`row_key`),<br>    KEY `idx_status` (`status`),<br>    KEY `idx_branch_id` (`branch_id`),<br>    KEY `idx_xid` (`xid`)<br>) ENGINE = InnoDB<br>  DEFAULT CHARSET = utf8mb4;<br><br>CREATE TABLE IF NOT EXISTS `distributed_lock`<br>(<br>    `lock_key`       CHAR(20) NOT NULL,<br>    `lock_value`     VARCHAR(20) NOT NULL,<br>    `expire`         BIGINT,<br>    primary key (`lock_key`)<br>) ENGINE = InnoDB<br>  DEFAULT CHARSET = utf8mb4;<br><br>INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (&#x27;AsyncCommitting&#x27;, &#x27; &#x27;, 0);<br>INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (&#x27;RetryCommitting&#x27;, &#x27; &#x27;, 0);<br>INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (&#x27;RetryRollbacking&#x27;, &#x27; &#x27;, 0);<br>INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (&#x27;TxTimeoutCheck&#x27;, &#x27; &#x27;, 0);<br></code></pre></td></tr></table></figure></li></ul></li><li><p>å¯åŠ¨</p><p>åœ¨seataç›®å½•ä¸‹æ‰§è¡Œseata-server.sh æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">bin/seata-server.sh <br></code></pre></td></tr></table></figure><p>è®¿é—®<a href="http://localhost:7091/%EF%BC%8C%E5%87%BA%E7%8E%B0%E4%BB%A5%E4%B8%8B%E7%94%BB%E9%9D%A2%E4%BB%A3%E8%A1%A8%E6%88%90%E5%8A%9F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E5%B0%B1%E6%98%AF%E5%9C%A8application.yml%E9%85%8D%E7%BD%AE%E7%9A%84console.user.username%E5%92%8Cconsole.user.password">http://localhost:7091/ï¼Œå‡ºç°ä»¥ä¸‹ç”»é¢ä»£è¡¨æˆåŠŸè´¦å·å¯†ç å°±æ˜¯åœ¨application.ymlé…ç½®çš„console.user.usernameå’Œconsole.user.password</a></p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308282051746.png" alt="image-20230828204423604"></p><p>ä¹Ÿå¯ä»¥åœ¨nacosé¡µé¢ä¸­æŸ¥çœ‹æœåŠ¡æ˜¯å¦æ³¨å†ŒæˆåŠŸ</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308282051341.png" alt="image-20230828205059592"></p></li></ul><p>â€‹</p><h3 id="å¾®æœåŠ¡é›†æˆSeata"><a href="#å¾®æœåŠ¡é›†æˆSeata" class="headerlink" title="å¾®æœåŠ¡é›†æˆSeata"></a>å¾®æœåŠ¡é›†æˆSeata</h3><ul><li><p>å¼•å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-seata<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.5.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>              <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>                  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.seata<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>seata-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>              <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>          <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.seata<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>seata-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.7.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li></ul><h4 id="XA"><a href="#XA" class="headerlink" title="XA"></a>XA</h4><h5 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h5><p>æ”¯æŒXA äº‹åŠ¡çš„æ•°æ®åº“ã€‚<br>Java åº”ç”¨ï¼Œé€šè¿‡ JDBC è®¿é—®æ•°æ®åº“ã€‚</p><h5 id="æ•´ä½“æœºåˆ¶"><a href="#æ•´ä½“æœºåˆ¶" class="headerlink" title="æ•´ä½“æœºåˆ¶"></a>æ•´ä½“æœºåˆ¶</h5><p>åœ¨ Seata å®šä¹‰çš„åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶å†…ï¼Œåˆ©ç”¨äº‹åŠ¡èµ„æºï¼ˆæ•°æ®åº“ã€æ¶ˆæ¯æœåŠ¡ç­‰ï¼‰å¯¹ XA åè®®çš„æ”¯æŒï¼Œä»¥ XA åè®®çš„æœºåˆ¶æ¥ç®¡ç†åˆ†æ”¯äº‹åŠ¡çš„ä¸€ç§ äº‹åŠ¡æ¨¡å¼ã€‚</p><p>æ‰§è¡Œé˜¶æ®µï¼š</p><p>å¯å›æ»šï¼šä¸šåŠ¡ SQL æ“ä½œæ”¾åœ¨ XA åˆ†æ”¯ä¸­è¿›è¡Œï¼Œç”±èµ„æºå¯¹ XA åè®®çš„æ”¯æŒæ¥ä¿è¯ å¯å›æ»š<br>æŒä¹…åŒ–ï¼šXA åˆ†æ”¯å®Œæˆåï¼Œæ‰§è¡Œ XA prepareï¼ŒåŒæ ·ï¼Œç”±èµ„æºå¯¹ XA åè®®çš„æ”¯æŒæ¥ä¿è¯ æŒä¹…åŒ–ï¼ˆå³ï¼Œä¹‹åä»»ä½•æ„å¤–éƒ½ä¸ä¼šé€ æˆæ— æ³•å›æ»šçš„æƒ…å†µï¼‰</p><p>å®Œæˆé˜¶æ®µï¼š</p><p>åˆ†æ”¯æäº¤ï¼šæ‰§è¡Œ XA åˆ†æ”¯çš„ commit<br>åˆ†æ”¯å›æ»šï¼šæ‰§è¡Œ XA åˆ†æ”¯çš„ rollback</p><ul><li><p>é…ç½®application.yml ä½¿ç”¨XAæ¨¡å¼</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">seata:</span><br>  <span class="hljs-attr">data-source-proxy-mode:</span> <span class="hljs-string">XA</span><br>  <span class="hljs-attr">registry:</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">nacos</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-attr">application:</span> <span class="hljs-string">seata-server</span><br>      <span class="hljs-attr">server-addr:</span> <span class="hljs-string">localhost:8848</span><br>      <span class="hljs-attr">namespace:</span> <span class="hljs-string">&quot;&quot;</span><br>      <span class="hljs-attr">group:</span> <span class="hljs-string">DEFAULT_GROUP</span><br>      <span class="hljs-attr">username:</span> <span class="hljs-string">nacos</span><br>      <span class="hljs-attr">password:</span> <span class="hljs-string">nacos</span><br>  <span class="hljs-comment">#äº‹åŠ¡ç»„çš„åç§°</span><br>  <span class="hljs-attr">tx-service-group:</span> <span class="hljs-string">seata-demo</span><br>  <span class="hljs-attr">service:</span><br>    <span class="hljs-comment">#äº‹åŠ¡ç»„å’Œclusterçš„æ˜ å°„å…³ç³»</span><br>    <span class="hljs-attr">vgroup-mapping:</span><br>    <span class="hljs-comment">#ä½ é…ç½®çš„seata/conf/application.ymlçš„ cluster</span><br>      <span class="hljs-attr">seata-demo:</span> <span class="hljs-string">default</span><br></code></pre></td></tr></table></figure></li><li><p>Seataé€šè¿‡å°è£…æ•°æ®åº“çš„XAæ¥å£ï¼Œå®ç°äº†åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†çš„æµç¨‹ï¼Œé™ä½äº†ä½¿ç”¨è€…çš„å¤æ‚åº¦ã€‚ç”¨æˆ·åªè¦åœ¨Seataå®¢æˆ·ç«¯è¿›è¡Œç®€å•çš„å¼€å¯XAæ¨¡å¼çš„é…ç½®ï¼Œå³å¯æˆåŠŸä½¿ç”¨Seataçš„XAæ¨¡å¼ã€‚XAæ¨¡å¼çš„æ€§èƒ½ä¹Ÿè¾ƒå·®ï¼Œåªé€‚ç”¨äºä¸€äº›å¯¹äº‹åŠ¡ä¸€è‡´æ€§è¦æ±‚éå¸¸é«˜çš„åœºæ™¯ã€‚</p><p>ç›´æ¥åœ¨serviceå¯¹ç”¨æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£@GlobalTransactionalï¼Œå³å¯ç”Ÿæ•ˆ</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308311843476.png" alt="image-20230831183911000"></p><p>xaæ¨¡å¼ä¸‹çš„æ—¥å¿—</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308311843190.png" alt="image-20230831182630307"></p></li></ul><h4 id="AT"><a href="#AT" class="headerlink" title="AT"></a>AT</h4><h5 id="å‰æ-1"><a href="#å‰æ-1" class="headerlink" title="å‰æ"></a>å‰æ</h5><ul><li>åŸºäºæ”¯æŒæœ¬åœ° ACID äº‹åŠ¡çš„å…³ç³»å‹æ•°æ®åº“ã€‚</li><li>Java åº”ç”¨ï¼Œé€šè¿‡ JDBC è®¿é—®æ•°æ®åº“ã€‚</li></ul><h5 id="æ•´ä½“æœºåˆ¶-1"><a href="#æ•´ä½“æœºåˆ¶-1" class="headerlink" title="æ•´ä½“æœºåˆ¶"></a>æ•´ä½“æœºåˆ¶</h5><p>ä¸¤é˜¶æ®µæäº¤åè®®çš„æ¼”å˜ï¼š</p><ul><li>ä¸€é˜¶æ®µï¼šä¸šåŠ¡æ•°æ®å’Œå›æ»šæ—¥å¿—è®°å½•åœ¨åŒä¸€ä¸ªæœ¬åœ°äº‹åŠ¡ä¸­æäº¤ï¼Œé‡Šæ”¾æœ¬åœ°é”å’Œè¿æ¥èµ„æºã€‚</li><li>äºŒé˜¶æ®µï¼š<ul><li>æäº¤å¼‚æ­¥åŒ–ï¼Œéå¸¸å¿«é€Ÿåœ°å®Œæˆã€‚</li><li>å›æ»šé€šè¿‡ä¸€é˜¶æ®µçš„å›æ»šæ—¥å¿—è¿›è¡Œåå‘è¡¥å¿ã€‚</li></ul></li></ul><ul><li><p>mysqlæ•°æ®æ–°å¢undo_logè¡¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE TABLE `undo_log` (<br>  `id` bigint(20) NOT NULL AUTO_INCREMENT,<br>  `branch_id` bigint(20) NOT NULL,<br>  `xid` varchar(100) NOT NULL,<br>  `context` varchar(128) NOT NULL,<br>  `rollback_info` longblob NOT NULL,<br>  `log_status` int(11) NOT NULL,<br>  `log_created` datetime NOT NULL,<br>  `log_modified` datetime NOT NULL,<br>  PRIMARY KEY (`id`),<br>  UNIQUE KEY `ux_undo_log` (`xid`,`branch_id`)<br>) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;<br></code></pre></td></tr></table></figure></li><li><p>data-source-proxy-modeä¿®æ”¹æˆATæ¨¡å¼</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">seata:</span><br>  <span class="hljs-attr">data-source-proxy-mode:</span> <span class="hljs-string">AT</span><br></code></pre></td></tr></table></figure></li><li><p>ATä¸‹çš„æ—¥å¿—</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202309011026520.png" alt="image-20230901101219676"></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å½“æ¶‰åŠå¤šä¸ªä¸åŒçš„è®¡ç®—æœºæˆ–ç³»ç»Ÿä¹‹é—´çš„æ“ä½œæ—¶ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡æ˜¯ç¡®ä¿è¿™äº›æ“ä½œåœ¨ä¸€ç»„ç›¸å…³çš„äº‹åŠ¡ä¸­ä¿æŒä¸€è‡´æ€§å’Œéš”ç¦»æ€§çš„æœºåˆ¶ã€‚åœ¨ä¼ ç»Ÿçš„å•æœºäº‹åŠ¡ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ•°æ®åº“çš„äº‹åŠ¡æ¥ç¡®ä¿æ“ä½œçš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§ã€‚ç„¶è€Œï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ•°æ®åˆ†å¸ƒåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œå¯èƒ½æ¶‰åŠç½‘ç»œé—®é¢˜ã€èŠ‚ç‚¹æ•…éšœç­‰ï¼Œä½¿å¾—ä¿æŒä¸€è‡´æ€§å˜å¾—æ›´åŠ </summary>
      
    
    
    
    <category term="SpringCloud" scheme="https://cason.work/categories/SpringCloud/"/>
    
    
  </entry>
  
  <entry>
    <title>ç†”æ–­é™çº§é™æµ-Sentinelç®€å•å®è·µ</title>
    <link href="https://cason.work/2023/08/25/%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7%E9%99%90%E6%B5%81-Sentinel%E7%AE%80%E5%8D%95%E5%AE%9E%E8%B7%B5/"/>
    <id>https://cason.work/2023/08/25/%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7%E9%99%90%E6%B5%81-Sentinel%E7%AE%80%E5%8D%95%E5%AE%9E%E8%B7%B5/</id>
    <published>2023-08-25T07:09:15.000Z</published>
    <updated>2023-09-05T07:11:00.263Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç†”æ–­ã€é™çº§å’Œé™æµæ˜¯ä¸‰ç§å¸¸è§çš„ä¿æŠ¤ç­–ç•¥ï¼Œç”¨äºç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç”¨æ€§ã€‚</p><p><strong>ç†”æ–­ï¼š</strong> ç†”æ–­æ˜¯ä¸€ç§é’ˆå¯¹ç‰¹å®šæœåŠ¡æˆ–èµ„æºçš„ä¿æŠ¤æœºåˆ¶ã€‚å½“è¯¥æœåŠ¡æˆ–èµ„æºå‡ºç°å¼‚å¸¸ã€æ•…éšœæˆ–æ€§èƒ½ä¸‹é™æ—¶ï¼Œç†”æ–­æœºåˆ¶ä¼šè¿…é€Ÿåœæ­¢å‘è¯¥æœåŠ¡æˆ–èµ„æºå‘é€è¯·æ±‚ï¼Œé¿å…ç»§ç»­çš„è¯·æ±‚å¯èƒ½åŠ é‡é—®é¢˜ã€‚ç†”æ–­é€šå¸¸åŸºäºä¸€äº›æŒ‡æ ‡ï¼ˆå¦‚é”™è¯¯ç‡ã€å“åº”æ—¶é—´ç­‰ï¼‰è¿›è¡Œè§¦å‘ï¼Œå¦‚æœè¿™äº›æŒ‡æ ‡è¶…è¿‡äº†é¢„è®¾çš„é˜ˆå€¼ï¼Œç³»ç»Ÿä¼šå°†è¯¥æœåŠ¡ç†”æ–­ï¼Œå³æš‚åœå¯¹å®ƒçš„è¯·æ±‚ï¼Œç›´åˆ°ä¸€æ®µæ—¶é—´åé‡æ–°å°è¯•ã€‚ç†”æ–­æœ‰åŠ©äºé˜²æ­¢æ•…éšœæ‰©æ•£ï¼Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚</p><p><strong>é™çº§ï¼š</strong> é™çº§æ˜¯ä¸€ç§åœ¨ç³»ç»Ÿå‹åŠ›å‰§å¢ã€èµ„æºä¸è¶³æˆ–å¼‚å¸¸æƒ…å†µä¸‹çš„åº”å¯¹ç­–ç•¥ã€‚ä¸ºäº†ä¿æŒæ ¸å¿ƒåŠŸèƒ½çš„å¯ç”¨æ€§ï¼Œç³»ç»Ÿå¯ä»¥ä¸»åŠ¨æ”¾å¼ƒä¸€äº›éæ ¸å¿ƒæˆ–æ¬¡è¦åŠŸèƒ½ï¼Œä»è€Œå‡è½»ç³»ç»Ÿçš„è´Ÿè½½ã€‚ä¾‹å¦‚ï¼Œåœ¨é«˜æµé‡æœŸé—´ï¼Œç³»ç»Ÿå¯ä»¥é™çº§ä¸ºæä¾›åŸºæœ¬çš„æœåŠ¡ï¼Œç¦ç”¨æŸäº›é«˜æˆæœ¬æˆ–èµ„æºå¯†é›†å‹çš„åŠŸèƒ½ã€‚è¿™å¯ä»¥ç¡®ä¿ç³»ç»Ÿçš„å…³é”®éƒ¨åˆ†ä»ç„¶æ­£å¸¸å·¥ä½œï¼Œå³ä½¿åœ¨èµ„æºæœ‰é™çš„æƒ…å†µä¸‹ä¹Ÿèƒ½ä¿æŒè¾ƒå¥½çš„å“åº”æ€§èƒ½ã€‚</p><p><strong>é™æµï¼š</strong> é™æµæ˜¯ä¸€ç§æ§åˆ¶ç³»ç»Ÿè®¿é—®é‡çš„ç­–ç•¥ï¼Œç”¨äºé˜²æ­¢ç³»ç»Ÿè¿‡è½½ã€‚é€šè¿‡é™åˆ¶å¯¹æŸä¸ªç‰¹å®šæœåŠ¡ã€æ¥å£æˆ–èµ„æºçš„å¹¶å‘è®¿é—®æ•°é‡ï¼Œé™æµå¯ä»¥é˜²æ­¢è¿‡å¤šçš„è¯·æ±‚å½±å“ç³»ç»Ÿçš„æ€§èƒ½å’Œå¯ç”¨æ€§ã€‚é™æµå¯ä»¥åŸºäºå¤šç§æ¡ä»¶è¿›è¡Œï¼Œå¦‚è®¾ç½®æ¯ç§’æŸ¥è¯¢æ•°ï¼ˆQPSï¼‰é™åˆ¶ã€å¹¶å‘è¿æ¥æ•°ã€è¯·æ±‚é¢‘ç‡ç­‰ã€‚è¿™æœ‰åŠ©äºç»´æŠ¤ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œç¡®ä¿ç³»ç»Ÿåœ¨å…¶å¯æ‰¿å—çš„è´Ÿè½½èŒƒå›´å†…è¿è¡Œã€‚</p><h2 id="Sentinel"><a href="#Sentinel" class="headerlink" title="Sentinel"></a>Sentinel</h2><p>Sentinelæ—¨åœ¨è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸è§çš„æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§å’Œä¿æŠ¤é—®é¢˜ï¼Œå¸®åŠ©å¼€å‘äººå‘˜æ„å»ºç¨³å®šã€å¯é çš„å¾®æœåŠ¡æ¶æ„ã€‚ä»¥ä¸‹æ˜¯Sentinelçš„ä¸€äº›é‡è¦æ–¹é¢ï¼š</p><ol><li><p><strong>æµé‡æ§åˆ¶ï¼š</strong> Sentinelå¯ä»¥æ ¹æ®ç³»ç»Ÿçš„è´Ÿè½½æƒ…å†µå’Œèµ„æºçš„å¯ç”¨æ€§ï¼Œé™åˆ¶å¯¹æŸä¸ªç‰¹å®šèµ„æºçš„è®¿é—®ã€‚é€šè¿‡è®¾å®šé˜ˆå€¼ï¼Œå¼€å‘äººå‘˜å¯ä»¥é™åˆ¶èµ„æºçš„å¹¶å‘è®¿é—®æ•°ã€QPSç­‰ï¼Œé˜²æ­¢è¿‡å¤šçš„è¯·æ±‚å¯¼è‡´èµ„æºè€—å°½æˆ–æ€§èƒ½ä¸‹é™ã€‚</p></li><li><p><strong>ç†”æ–­é™çº§ï¼š</strong> Sentinelå¯ä»¥ç›‘æ§èµ„æºçš„é”™è¯¯ç‡ã€å¼‚å¸¸ç‡ç­‰æƒ…å†µã€‚å¦‚æœé”™è¯¯ç‡è¶…è¿‡äº†è®¾å®šçš„é˜ˆå€¼ï¼ŒSentinelå¯ä»¥è‡ªåŠ¨è§¦å‘ç†”æ–­æ“ä½œï¼Œåœæ­¢å¯¹è¯¥èµ„æºçš„è¯·æ±‚ä¸€æ®µæ—¶é—´ï¼Œä»¥é˜²æ­¢æ•…éšœæ‰©æ•£ã€‚ç†”æ–­æœºåˆ¶æœ‰åŠ©äºä¿æŠ¤ç³»ç»Ÿå…å—æ•…éšœçš„å½±å“ã€‚</p></li><li><p><strong>ç³»ç»Ÿä¿æŠ¤ï¼š</strong> Sentinelå¯ä»¥ç›‘æ§æ•´ä¸ªç³»ç»Ÿçš„å¥åº·çŠ¶æ€ï¼ŒåŒ…æ‹¬ç³»ç»Ÿè´Ÿè½½ã€èµ„æºåˆ©ç”¨ç‡ç­‰ã€‚å½“ç³»ç»Ÿè´Ÿè½½è¿‡é«˜æˆ–å‡ºç°å¼‚å¸¸æƒ…å†µæ—¶ï¼ŒSentinelå¯ä»¥é‡‡å–æªæ–½ï¼Œå¦‚é™åˆ¶æŸäº›èµ„æºçš„è®¿é—®ï¼Œä»¥ä¿æŠ¤æ•´ä¸ªç³»ç»Ÿå…å—è¿‡è½½çš„å½±å“ã€‚</p></li><li><p><strong>å®æ—¶ç›‘æ§å’Œç»Ÿè®¡ï¼š</strong> Sentinelæä¾›å®æ—¶çš„ç›‘æ§é¢æ¿å’Œç»Ÿè®¡ä¿¡æ¯ï¼Œå¼€å‘äººå‘˜å¯ä»¥é€šè¿‡è¿™äº›ä¿¡æ¯äº†è§£èµ„æºçš„ä½¿ç”¨æƒ…å†µã€å¼‚å¸¸æƒ…å†µå’Œç³»ç»Ÿçš„æ•´ä½“çŠ¶æ€ã€‚è¿™äº›æ•°æ®æœ‰åŠ©äºåŠæ—¶å‘ç°é—®é¢˜å¹¶é‡‡å–æªæ–½ã€‚</p></li><li><p><strong>è§„åˆ™é…ç½®ï¼š</strong> Sentinelå…è®¸å¼€å‘äººå‘˜é…ç½®æµé‡æ§åˆ¶å’Œç†”æ–­é™çº§çš„è§„åˆ™ã€‚è§„åˆ™å¯ä»¥åŸºäºèµ„æºçš„åç§°ã€è·¯å¾„ã€HTTPæ–¹æ³•ç­‰è¿›è¡Œé…ç½®ï¼Œä»¥é€‚åº”ä¸åŒçš„åœºæ™¯å’Œéœ€æ±‚ã€‚</p></li><li><p><strong>é›†æˆå’Œé€‚ç”¨æ€§ï¼š</strong> Sentinelå¯ä»¥ä¸å„ç§ç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œé€‚ç”¨äºå¾®æœåŠ¡æ¶æ„ä¸­çš„å„ç§åœºæ™¯ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„APIå’Œæ’ä»¶ï¼Œä»¥ä¾¿ä¸ç°æœ‰ç³»ç»Ÿé›†æˆã€‚</p></li></ol><h3 id="ç®€å•å®è·µ"><a href="#ç®€å•å®è·µ" class="headerlink" title="ç®€å•å®è·µ"></a>ç®€å•å®è·µ</h3><ul><li><p>ä¸‹è½½sentinel</p><blockquote><p>åœ°å€ï¼š<a href="https://github.com/alibaba/Sentinel">https://github.com/alibaba/Sentinel</a></p></blockquote></li><li><p>å¯åŠ¨sentinel</p><figure class="highlight shell"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs shell">java -jar sentinel-dashboard-1.8.6.jar <br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308251829872.png" alt="image-20230825182945267"></p></li><li><p><strong>å¼•å…¥ä¾èµ–ï¼š</strong> åœ¨ä½ çš„Spring Booté¡¹ç›®çš„ <code>pom.xml</code> æ–‡ä»¶ä¸­ï¼Œæ·»åŠ Sentinelçš„ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-sentinel<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p><strong>é…ç½®ï¼š</strong> åœ¨ä½ çš„ <code>application.properties</code> æˆ– <code>application.yml</code> æ–‡ä»¶ä¸­ï¼Œå¯ä»¥è¿›è¡Œä¸€äº›åŸºæœ¬çš„é…ç½®ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">sentinel:</span><br>      <span class="hljs-attr">transport:</span><br>        <span class="hljs-attr">dashboard:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8080</span><br></code></pre></td></tr></table></figure></li><li><p>å¯åŠ¨é¡¹ç›®å³å¯åœ¨é¡µé¢ä¸­å®æ—¶ç›‘æ§ã€é…ç½®æµæ§è§„åˆ™ç­‰</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308251825142.png" alt="image-20230825182546927"></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç†”æ–­ã€é™çº§å’Œé™æµæ˜¯ä¸‰ç§å¸¸è§çš„ä¿æŠ¤ç­–ç•¥ï¼Œç”¨äºç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç”¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç†”æ–­ï¼š&lt;/strong&gt; ç†”æ–­æ˜¯ä¸€ç§é’ˆå¯¹ç‰¹å®šæœåŠ¡æˆ–èµ„æºçš„ä¿æŠ¤æœºåˆ¶ã€‚å½“è¯¥æœåŠ¡æˆ–èµ„æºå‡ºç°å¼‚å¸¸ã€æ•…éšœæˆ–æ€§èƒ½ä¸‹é™æ—¶ï¼Œç†”æ–­æœºåˆ¶ä¼šè¿…é€Ÿåœæ­¢å‘è¯¥æœåŠ¡æˆ–èµ„æºå‘é€è¯·æ±‚ï¼Œé¿å…ç»§ç»­</summary>
      
    
    
    
    <category term="SpringCloud" scheme="https://cason.work/categories/SpringCloud/"/>
    
    
    <category term="åˆ†å¸ƒå¼ç³»ç»Ÿ" scheme="https://cason.work/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"/>
    
    <category term="Sentinel" scheme="https://cason.work/tags/Sentinel/"/>
    
    <category term="ç†”æ–­" scheme="https://cason.work/tags/%E7%86%94%E6%96%AD/"/>
    
    <category term="é™çº§" scheme="https://cason.work/tags/%E9%99%8D%E7%BA%A7/"/>
    
    <category term="é™æµ" scheme="https://cason.work/tags/%E9%99%90%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ-Nacosç®€å•å®è·µ</title>
    <link href="https://cason.work/2023/08/23/%E5%88%86%E5%B8%83%E5%BC%8F%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83-Nacos%E7%AE%80%E5%8D%95%E5%AE%9E%E8%B7%B5/"/>
    <id>https://cason.work/2023/08/23/%E5%88%86%E5%B8%83%E5%BC%8F%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83-Nacos%E7%AE%80%E5%8D%95%E5%AE%9E%E8%B7%B5/</id>
    <published>2023-08-23T08:07:15.000Z</published>
    <updated>2023-09-05T07:10:12.830Z</updated>
    
    <content type="html"><![CDATA[<p>åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒæ˜¯ä¸€ç§ç”¨äºç®¡ç†å’Œé›†ä¸­å­˜å‚¨åº”ç”¨ç¨‹åºé…ç½®çš„ç³»ç»Ÿï¼Œç‰¹åˆ«é€‚ç”¨äºå¤§è§„æ¨¡ã€å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚å®ƒçš„ä¸»è¦ç›®æ ‡æ˜¯å°†åº”ç”¨ç¨‹åºçš„é…ç½®ä¿¡æ¯ä»ä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä½¿å¾—é…ç½®å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡ŒåŠ¨æ€ä¿®æ”¹å’Œç®¡ç†ï¼Œè€Œæ— éœ€é‡æ–°éƒ¨ç½²åº”ç”¨ç¨‹åºã€‚</p><p>ä»¥ä¸‹æ˜¯åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒçš„ä¸€äº›å…³é”®ç‰¹ç‚¹å’Œä¼˜åŠ¿ï¼š</p><ol><li><strong>é›†ä¸­ç®¡ç†ï¼š</strong> åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒå…è®¸å°†æ‰€æœ‰åº”ç”¨ç¨‹åºçš„é…ç½®é›†ä¸­å­˜å‚¨åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œä»è€Œæ–¹ä¾¿ç»Ÿä¸€ç®¡ç†å’Œä¿®æ”¹é…ç½®ï¼Œé¿å…äº†åœ¨æ¯ä¸ªåº”ç”¨ç¨‹åºå®ä¾‹ä¸­æ‰‹åŠ¨æ›´æ”¹é…ç½®ã€‚</li><li><strong>åŠ¨æ€æ›´æ–°ï¼š</strong> é…ç½®ä¸­å¿ƒæ”¯æŒåœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€æ›´æ–°é…ç½®ï¼Œè€Œæ— éœ€é‡æ–°å¯åŠ¨æˆ–é‡æ–°éƒ¨ç½²åº”ç”¨ã€‚è¿™å¯¹äºéœ€è¦é¢‘ç¹å˜æ›´é…ç½®çš„åœºæ™¯éå¸¸æœ‰ç”¨ã€‚</li><li><strong>ç‰ˆæœ¬æ§åˆ¶ï¼š</strong> é…ç½®ä¸­å¿ƒé€šå¸¸æ”¯æŒé…ç½®ç‰ˆæœ¬æ§åˆ¶ï¼Œä½¿å¾—å¯ä»¥è·Ÿè¸ªé…ç½®çš„å˜æ›´å†å²ï¼Œæ–¹ä¾¿å›é€€æˆ–æ¢å¤é…ç½®ã€‚</li><li><strong>ç¯å¢ƒéš”ç¦»ï¼š</strong> é…ç½®ä¸­å¿ƒå…è®¸å°†ä¸åŒç¯å¢ƒï¼ˆå¦‚å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰çš„é…ç½®éš”ç¦»å¼€æ¥ï¼Œä»è€Œç¡®ä¿åœ¨ä¸åŒç¯å¢ƒä¸­ä½¿ç”¨ä¸åŒçš„é…ç½®ã€‚</li><li><strong>åŠ¨æ€æ‰©å±•ï¼š</strong> é…ç½®ä¸­å¿ƒå¯ä»¥æ”¯æŒå¤šä¸ªåº”ç”¨ç¨‹åºå®ä¾‹å’Œå¤šä¸ªå›¢é˜ŸåŒæ—¶è®¿é—®ï¼Œå¹¶èƒ½å¤Ÿå¤„ç†é«˜å¹¶å‘çš„é…ç½®è¯·æ±‚ã€‚</li><li><strong>å®‰å…¨æ€§ï¼š</strong> é…ç½®ä¸­å¿ƒé€šå¸¸æä¾›æƒé™æ§åˆ¶ï¼Œç¡®ä¿åªæœ‰æˆæƒç”¨æˆ·å¯ä»¥è®¿é—®å’Œä¿®æ”¹é…ç½®ã€‚</li><li><strong>é›†æˆæ”¯æŒï¼š</strong> é…ç½®ä¸­å¿ƒå¯ä»¥ä¸å…¶ä»–å·¥å…·å’Œæ¡†æ¶é›†æˆï¼Œå¦‚ç›‘æ§ç³»ç»Ÿã€CI&#x2F;CDæµæ°´çº¿ç­‰ï¼Œä»è€Œæ›´å¥½åœ°æ”¯æŒè‡ªåŠ¨åŒ–å’Œè¿ç»´æµç¨‹ã€‚</li></ol><h2 id="Nacos"><a href="#Nacos" class="headerlink" title="Nacos"></a>Nacos</h2><p>Nacosï¼ˆNaming and Configuration Serviceï¼‰æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€ä¸ªç”¨äºæœåŠ¡å‘ç°ã€åŠ¨æ€é…ç½®ç®¡ç†å’Œå¯è§†åŒ–å¹³å°çš„é¡¹ç›®ã€‚å®ƒç»“åˆäº†æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’Œå¥åº·ç›‘æµ‹ç­‰åŠŸèƒ½ï¼Œæ˜¯ä¸€ä¸ªç»¼åˆçš„å¾®æœåŠ¡åŸºç¡€è®¾æ–½ç»„ä»¶ã€‚å…¶ä¸­ï¼ŒNacosçš„é…ç½®ç®¡ç†éƒ¨åˆ†å¯ä»¥è¢«ç”¨ä½œåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒã€‚</p><ul><li><p>æ·»åŠ nacosé…ç½®ç®¡ç†ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><pre><code class="hljs xml">  <span class="hljs-comment">&lt;!-- nacosçš„é…ç½®ç®¡ç†ä¾èµ– --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>åœ¨resourceä¸‹åˆ›å»ºbootstrap.yamlé…ç½®æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">gateway</span><br>  <span class="hljs-attr">profiles:</span><br>    <span class="hljs-comment"># ç¯å¢ƒ</span><br>    <span class="hljs-attr">active:</span> <span class="hljs-string">dev</span> <br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-comment"># nacosåœ°å€</span><br>      <span class="hljs-attr">server-addr:</span> <span class="hljs-string">localhost:8848</span> <br>      <span class="hljs-attr">config:</span><br>        <span class="hljs-comment"># æ–‡ä»¶åç¼€</span><br>        <span class="hljs-attr">file-extension:</span> <span class="hljs-string">yaml</span> <br></code></pre></td></tr></table></figure><ol><li><strong>é…ç½®åŠ è½½é¡ºåºï¼š</strong> åœ¨Spring Bootåº”ç”¨ç¨‹åºä¸­ï¼Œé…ç½®æ–‡ä»¶çš„åŠ è½½é¡ºåºæ˜¯æœ‰ä¸€å®šè§„åˆ™çš„ã€‚<code>bootstrap.yaml</code> é…ç½®æ–‡ä»¶åœ¨åŠ è½½é¡ºåºä¸Šä½äºå…¶ä»–é…ç½®æ–‡ä»¶ï¼ˆå¦‚ <code>application.yaml</code> æˆ– <code>application.properties</code>ï¼‰ä¹‹å‰ã€‚è¿™æ„å‘³ç€å®ƒå¯ä»¥ç”¨äºé…ç½®ä¸€äº›åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨ä¹‹å‰å°±éœ€è¦çš„å±æ€§ï¼Œä¾‹å¦‚è¿æ¥åˆ°é…ç½®æœåŠ¡å™¨çš„å±æ€§ã€‚</li><li><strong>å¤–éƒ¨é…ç½®åŠ è½½ï¼š</strong> é€šå¸¸ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„åº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦ä»é…ç½®ä¸­å¿ƒï¼ˆå¦‚Nacosã€Consulç­‰ï¼‰è·å–é…ç½®ä¿¡æ¯ã€‚<code>bootstrap.yaml</code> é…ç½®æ–‡ä»¶å¯ä»¥ç”¨æ¥é…ç½®ä¸é…ç½®ä¸­å¿ƒçš„è¿æ¥å’Œèº«ä»½éªŒè¯ç­‰ä¿¡æ¯ï¼Œä»¥ä¾¿åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶èƒ½å¤Ÿæ­£ç¡®åœ°åŠ è½½é…ç½®ã€‚</li></ol></li><li><p>åœ¨nacosä¸­ä»¥&lt;spring.application.name&gt;-&lt;spring.profiles.active&gt;.yamlä½œä¸ºdata idåœ¨DEFAULT_GROUPæ–°å»ºé…ç½®ï¼Œä¾‹å¦‚ï¼šgateway-dev.yaml</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308231648127.png" alt="image-20230823161911507"></p></li></ul><p>é¡¹ç›®å¯åŠ¨åï¼Œæ— éœ€é‡æ–°å¯åŠ¨æˆ–åœæœºå°±ä¼šä»nacosä¸­åŠ¨æ€åŠ è½½é…ç½®ä¸‹æ¥ï¼Œé€šè¿‡@Valueå³å¯è·å–å¯¹åº”çš„å€¼ã€‚å¦‚æœæ‚¨å°†é…ç½®å±æ€§æ³¨å…¥åˆ°äº†Springç®¡ç†çš„Beanä¸­ï¼Œè€Œä¸”å¸Œæœ›åœ¨é…ç½®å‘ç”Ÿå˜åŒ–æ—¶åŠ¨æ€åˆ·æ–°Beançš„çŠ¶æ€ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <code>@RefreshScope</code> æ³¨è§£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@RefreshScope</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyService</span> &#123;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;config.hello&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String helloConfig;<br><br>    <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒæ˜¯ä¸€ç§ç”¨äºç®¡ç†å’Œé›†ä¸­å­˜å‚¨åº”ç”¨ç¨‹åºé…ç½®çš„ç³»ç»Ÿï¼Œç‰¹åˆ«é€‚ç”¨äºå¤§è§„æ¨¡ã€å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚å®ƒçš„ä¸»è¦ç›®æ ‡æ˜¯å°†åº”ç”¨ç¨‹åºçš„é…ç½®ä¿¡æ¯ä»ä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä½¿å¾—é…ç½®å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡ŒåŠ¨æ€ä¿®æ”¹å’Œç®¡ç†ï¼Œè€Œæ— éœ€é‡æ–°éƒ¨ç½²åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒçš„ä¸€äº›å…³é”®ç‰¹ç‚¹å’Œä¼˜åŠ¿ï¼š&lt;/p</summary>
      
    
    
    
    <category term="SpringCloud" scheme="https://cason.work/categories/SpringCloud/"/>
    
    
    <category term="åˆ†å¸ƒå¼ç³»ç»Ÿ" scheme="https://cason.work/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"/>
    
    <category term="Nacos" scheme="https://cason.work/tags/Nacos/"/>
    
    <category term="é…ç½®ä¸­å¿ƒ" scheme="https://cason.work/tags/%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/"/>
    
  </entry>
  
  <entry>
    <title>APIç½‘å…³-SpringCloud Gateway</title>
    <link href="https://cason.work/2023/08/17/API%E7%BD%91%E5%85%B3-SpringCloud-Gateway/"/>
    <id>https://cason.work/2023/08/17/API%E7%BD%91%E5%85%B3-SpringCloud-Gateway/</id>
    <published>2023-08-17T12:31:24.000Z</published>
    <updated>2023-09-05T07:11:42.611Z</updated>
    
    <content type="html"><![CDATA[<p>Spring Cloud Gatewayæ˜¯ä¸€ä¸ªåŸºäºSpring Frameworkçš„å¼€æºAPIç½‘å…³ï¼Œç”¨äºæ„å»ºå¾®æœåŠ¡æ¶æ„ä¸­çš„ç»Ÿä¸€è®¿é—®å±‚ã€‚å®ƒå……å½“äº†åº”ç”¨ç¨‹åºå’Œåç«¯æœåŠ¡ä¹‹é—´çš„ä»£ç†ï¼Œæä¾›äº†è·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€å®‰å…¨æ€§ã€ç›‘æ§ç­‰åŠŸèƒ½ï¼Œä»¥ç®€åŒ–å¾®æœåŠ¡æ¶æ„ä¸­çš„ç½‘ç»œè¯·æ±‚ç®¡ç†å’Œæµé‡æ§åˆ¶ã€‚</p><p>Spring Cloud Gatewayçš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p><ol><li><strong>åŠ¨æ€è·¯ç”±ï¼š</strong> å¯ä»¥æ ¹æ®è¯·æ±‚çš„ä¿¡æ¯å°†æµé‡è·¯ç”±åˆ°ä¸åŒçš„åç«¯æœåŠ¡ï¼Œæ”¯æŒåŠ¨æ€æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹è·¯ç”±è§„åˆ™ã€‚</li><li><strong>è´Ÿè½½å‡è¡¡ï¼š</strong> å¯ä»¥è‡ªåŠ¨åˆ†é…æµé‡åˆ°å¤šä¸ªå®ä¾‹ï¼Œä»¥æé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œæ€§èƒ½ã€‚</li><li><strong>æ–­è·¯å™¨æ¨¡å¼ï¼š</strong> æä¾›äº†æ–­è·¯å™¨æ¨¡å¼æ¥å¤„ç†åç«¯æœåŠ¡çš„æ•…éšœï¼Œé˜²æ­¢æ•…éšœæœåŠ¡å¯¹æ•´ä¸ªç³»ç»Ÿçš„å½±å“ã€‚</li><li><strong>è¿‡æ»¤å™¨ï¼š</strong> å¯ä»¥åœ¨è¯·æ±‚å’Œå“åº”ä¹‹é—´åº”ç”¨ä¸€ç³»åˆ—çš„è¿‡æ»¤å™¨ï¼Œç”¨äºä¿®æ”¹è¯·æ±‚ã€å“åº”æˆ–æ‰§è¡Œä¸€äº›é¢„å¤„ç†&#x2F;åå¤„ç†æ“ä½œã€‚</li><li><strong>é™æµå’Œé€Ÿç‡æ§åˆ¶ï¼š</strong> å¯ä»¥é€šè¿‡é…ç½®é™åˆ¶æ¯ä¸ªè·¯ç”±æˆ–æœåŠ¡çš„è¯·æ±‚é€Ÿç‡ï¼Œä»¥é˜²æ­¢è¿‡è½½å’Œæ»¥ç”¨ã€‚</li><li><strong>å®‰å…¨æ€§ï¼š</strong> å¯ä»¥é›†æˆSpring Securityç­‰å®‰å…¨æ¡†æ¶ï¼Œå¯¹è¯·æ±‚è¿›è¡Œè®¤è¯å’Œæˆæƒã€‚</li><li><strong>ç›‘æ§å’Œæ—¥å¿—ï¼š</strong> æä¾›äº†ç›‘æ§å’Œæ—¥å¿—åŠŸèƒ½ï¼Œå¸®åŠ©å¼€å‘äººå‘˜äº†è§£æµé‡å’Œç³»ç»Ÿçš„çŠ¶æ€ã€‚</li><li><strong>æ˜“äºæ‰©å±•ï¼š</strong> ç”±äºåŸºäºSpring Frameworkæ„å»ºï¼Œå› æ­¤å¯ä»¥é€šè¿‡è‡ªå®šä¹‰æ’ä»¶å’Œè¿‡æ»¤å™¨æ¥æ‰©å±•å…¶åŠŸèƒ½ã€‚</li></ol><h2 id="SpringCloud-Gatewayç®€å•ä½¿ç”¨"><a href="#SpringCloud-Gatewayç®€å•ä½¿ç”¨" class="headerlink" title="SpringCloud Gatewayç®€å•ä½¿ç”¨"></a>SpringCloud Gatewayç®€å•ä½¿ç”¨</h2><ul><li><p><strong>æ·»åŠ ä¾èµ–ï¼š</strong> åœ¨ç”Ÿæˆçš„<code>pom.xml</code>æ–‡ä»¶ä¸­ï¼Œæ·»åŠ Spring Cloud Gatewayçš„ä¾èµ–ã€‚é€šå¸¸ï¼Œæ‚¨éœ€è¦æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†nacoså®ç°æœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°ï¼Œæ‰€ä»¥ä¹Ÿè¦å¼•å…¥nacosç›¸å…³çš„ä¾èµ–ï¼Œå¦‚æœä¸éœ€è¦å¯ä»¥ä¸å¼•å…¥ï¼Œroutes.uriç›´æ¥æŒ‡å®šç›®æ ‡æœåŠ¡çš„å®Œæ•´URLå­—ç¬¦ä¸²ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml">  <span class="hljs-comment">&lt;!--nacosæœåŠ¡å‘ç°ä¾èµ–--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p><strong>é…ç½®è·¯ç”±ï¼š</strong> åœ¨<code>application.yml</code>æˆ–<code>application.properties</code>ä¸­é…ç½®æ‚¨çš„è·¯ç”±è§„åˆ™ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">10010</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">gateway</span><br>    <span class="hljs-attr">gateway:</span><br>      <span class="hljs-attr">routes:</span><br>        <span class="hljs-comment"># è·¯ç”±æ ‡ç¤ºï¼Œå¿…é¡»å”¯ä¸€</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">user-service</span><br>          <span class="hljs-comment"># è·¯ç”±çš„ç›®æ ‡åœ°å€</span><br>          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://user-service</span><br>          <span class="hljs-comment"># è·¯ç”±æ–­è¨€ï¼Œåˆ¤æ–­è¯·æ±‚æ˜¯å¦ç¬¦åˆè§„åˆ™</span><br>          <span class="hljs-attr">predicates:</span><br>            <span class="hljs-comment"># è·¯å¾„æ–­è¨€ï¼Œåˆ¤æ–­è·¯å¾„æ˜¯å¦æ˜¯ä»¥/userå¼€å¤´ï¼Œå¦‚æœæ˜¯åˆ™ç¬¦åˆ</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/user/**</span><br>          <span class="hljs-attr">filter:</span><br>          <span class="hljs-comment">#æ·»åŠ è·¯ç”±è¿‡æ»¤å™¨</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">AddRequestHeader=Tag,userRequest</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">order-service</span><br>          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://order-service</span><br>          <span class="hljs-attr">predicates:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/order/**</span><br>      <span class="hljs-comment">#æ·»åŠ defaultè¿‡æ»¤å™¨</span><br>      <span class="hljs-attr">default-filters:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-string">AddRequestHeader=origin,gateway</span><br></code></pre></td></tr></table></figure><blockquote><ol><li><p><strong>ç›´æ¥URLå­—ç¬¦ä¸²ï¼š</strong> æœ€ç®€å•çš„å†™æ³•å°±æ˜¯ç›´æ¥æŒ‡å®šç›®æ ‡æœåŠ¡çš„å®Œæ•´URLå­—ç¬¦ä¸²ã€‚</p><p><code>  uri: http://example.com</code></p></li><li><p><strong>lbåè®®ï¼š</strong> ä½¿ç”¨<code>lb</code>åè®®å¯ä»¥é€šè¿‡æœåŠ¡å‘ç°æ¥è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°ä¸åŒå®ä¾‹ã€‚</p><p> <code> uri: lb://service-name</code></p></li><li><p><strong>lbåè®® + è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š</strong> å¯ä»¥åœ¨<code>lb</code>åè®®åé¢æ·»åŠ è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¦‚<code>lb://service-name?lbMethod=ROUND_ROBIN</code>ã€‚</p><p><code> uri: lb://service-name?lbMethod=ROUND_ROBIN</code></p></li><li><p><strong>ä½¿ç”¨è‡ªå®šä¹‰åè®®ï¼š</strong> æ‚¨å¯ä»¥å®šä¹‰è‡ªå·±çš„åè®®å‰ç¼€ï¼Œç„¶ååœ¨ç›®æ ‡URIä¸­ä½¿ç”¨ã€‚</p><p><code>uri: custom://destination</code></p></li><li><p><strong>ä½¿ç”¨è¡¨è¾¾å¼ï¼š</strong> æ‚¨å¯ä»¥åœ¨<code>routes.uri</code>ä¸­ä½¿ç”¨SpELè¡¨è¾¾å¼æ¥åŠ¨æ€ç”Ÿæˆç›®æ ‡URIã€‚</p><p><code>uri: &quot;&#39;http://dynamic-&#39; + #serviceId + &#39;.example.com&#39;&quot;</code></p></li></ol></blockquote></li><li><p><strong>æµ‹è¯•è·¯ç”±ï¼š</strong> å¯åŠ¨åº”ç”¨ç¨‹åºåï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æˆ–å·¥å…·ï¼ˆå¦‚curlæˆ–Postmanï¼‰æ¥æµ‹è¯•é…ç½®çš„è·¯ç”±ã€‚è®¿é—®<code>http://localhost:10010/user/1</code>åº”è¯¥å°†è¯·æ±‚ä»£ç†åˆ°<code>http://user-service/user/1</code>ã€‚</p><p>![image-20230817210750025](..&#x2F;..&#x2F;..&#x2F;..&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230817210750025.png)</p></li><li><p>æ·»åŠ GlobalFilterç®€å•å®ç°è®¿é—®é‰´æƒ</p><blockquote><p><code>GlobalFilter</code>æ˜¯Spring Cloud Gatewayä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå®ƒå…è®¸æ‚¨åœ¨è¯·æ±‚å’Œå“åº”çš„ç”Ÿå‘½å‘¨æœŸä¸­æ‰§è¡Œå…¨å±€æ“ä½œã€‚è¿™äº›æ“ä½œå¯ä»¥ç”¨äºå„ç§ç›®çš„ï¼Œå¦‚èº«ä»½éªŒè¯ã€æ—¥å¿—è®°å½•ã€æ·»åŠ è¯·æ±‚å¤´ã€å¤„ç†å¼‚å¸¸ç­‰ã€‚<code>GlobalFilter</code>å¯ä»¥åœ¨æ•´ä¸ªç½‘å…³çš„è¯·æ±‚å¤„ç†æµç¨‹ä¸­åº”ç”¨ï¼Œæ— è®ºæ˜¯åœ¨è·¯ç”±åŒ¹é…ä¹‹å‰è¿˜æ˜¯ä¹‹åã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AuthorizeFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">GlobalFilter</span>, Ordered &#123;<br><br>    <span class="hljs-meta">@SneakyThrows(Exception.class)</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Mono&lt;Void&gt; <span class="hljs-title function_">filter</span><span class="hljs-params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> &#123;<br>        <span class="hljs-type">ServerHttpRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> exchange.getRequest();<br>        MultiValueMap&lt;String, String&gt; params = request.getQueryParams();<br>        <span class="hljs-comment">//è·å–å‚æ•°ä¸­çš„ authorization å‚æ•° ã€‚é€šå¸¸æ˜¯è·å–headeré‡Œçš„authorization</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">authorization</span> <span class="hljs-operator">=</span> params.getFirst(<span class="hljs-string">&quot;authorization&quot;</span>);<br>        <span class="hljs-comment">//è¿™é‡Œdemoç®€å•å¤„ç† åˆ¤æ–­æ•°å€¼æ˜¯å¦ç­‰äº admin</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;admin&quot;</span>.equals(authorization)) &#123;<br>            <span class="hljs-comment">//æ”¾è¡Œ</span><br>            <span class="hljs-keyword">return</span> chain.filter(exchange);<br>        &#125;<br>        <span class="hljs-comment">//å…ˆè®¾ç½®çŠ¶æ€ç </span><br>        <span class="hljs-type">ServerHttpResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> exchange.getResponse();<br>        response.setStatusCode(HttpStatus.UNAUTHORIZED);<br>        <span class="hljs-type">DataBufferFactory</span> <span class="hljs-variable">bufferFactory</span> <span class="hljs-operator">=</span> response.bufferFactory();<br>        <span class="hljs-type">ObjectMapper</span> <span class="hljs-variable">objectMapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();<br>        <span class="hljs-type">DataBuffer</span> <span class="hljs-variable">wrap</span> <span class="hljs-operator">=</span> bufferFactory.wrap(objectMapper.writeValueAsBytes(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RestResult</span>&lt;&gt;(<span class="hljs-number">401</span>, <span class="hljs-string">&quot;unauthrize&quot;</span>)));<br>        <span class="hljs-keyword">return</span> response.writeWith(Mono.fromSupplier(() -&gt; wrap));<br><span class="hljs-comment">//        //æ‹¦æˆªè¯·æ±‚</span><br><span class="hljs-comment">//        return exchange.getResponse().setComplete();</span><br>    &#125;<br><br>    <span class="hljs-comment">//è®¾ç½®ä¼˜å…ˆçº§ä¸º-1</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getOrder</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç é€šè¿‡å¯¹è¯·æ±‚å‚æ•°é‡Œçš„authorizationæ˜¯å¦ç­‰äºadminç®€å•å®ç°äº†é‰´æƒï¼Œæ˜¯adminåˆ™é€šè¿‡</p><p>![image-20230817211428288](..&#x2F;..&#x2F;..&#x2F;..&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230817211428288.png)</p><p>å¦åˆ™è¿”å›401 httpstatuså’Œjson responsebodyæç¤º</p><p>![image-20230817211437210](..&#x2F;..&#x2F;..&#x2F;..&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230817211437210.png)</p></li></ul><h3 id="é›†æˆnacosé…ç½®ä¸­å¿ƒå®ç°åŠ¨æ€è·¯ç”±"><a href="#é›†æˆnacosé…ç½®ä¸­å¿ƒå®ç°åŠ¨æ€è·¯ç”±" class="headerlink" title="é›†æˆnacosé…ç½®ä¸­å¿ƒå®ç°åŠ¨æ€è·¯ç”±"></a>é›†æˆnacosé…ç½®ä¸­å¿ƒå®ç°åŠ¨æ€è·¯ç”±</h3><ul><li><p><strong>æ·»åŠ ä¾èµ–</strong>ï¼šåœ¨ä¸Šé¢é…ç½®çš„ä¾èµ–çš„åŸºç¡€ä¸Šæ·»åŠ nacos-configç›¸å…³çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- nacosçš„é…ç½®ç®¡ç†ä¾èµ– --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p><strong>é…ç½®Nacosä½œä¸ºé…ç½®ä¸­å¿ƒï¼š</strong> åœ¨<code>bootstrap.yaml</code>æˆ–<code>bootstrap.properties</code>ä¸­é…ç½®Nacosçš„é…ç½®ä¸­å¿ƒä¿¡æ¯ï¼ŒåŒ…æ‹¬Nacos Serverçš„åœ°å€å’Œé…ç½®çš„Data IDã€Groupç­‰ä¿¡æ¯ã€‚</p><p>bootstrap.yaml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">gateway</span><br>  <span class="hljs-attr">profiles:</span><br>    <span class="hljs-attr">active:</span> <span class="hljs-string">dev</span> <span class="hljs-comment"># ç¯å¢ƒ</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-attr">server-addr:</span> <span class="hljs-string">localhost:8848</span> <span class="hljs-comment"># nacosåœ°å€</span><br>      <span class="hljs-attr">config:</span><br>        <span class="hljs-attr">file-extension:</span> <span class="hljs-string">yaml</span> <span class="hljs-comment"># æ–‡ä»¶åç¼€</span><br></code></pre></td></tr></table></figure><p>application.yaml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">10010</span><br><span class="hljs-attr">logging:</span><br>  <span class="hljs-attr">level:</span><br>    <span class="hljs-attr">com.cason:</span> <span class="hljs-string">debug</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-attr">server-addr:</span> <span class="hljs-string">localhost:8848</span><br></code></pre></td></tr></table></figure></li><li><p><strong>é…ç½®åŠ¨æ€è·¯ç”±ï¼š</strong> åœ¨Nacosé…ç½®ä¸­å¿ƒä¸­åˆ›å»ºé…ç½®ï¼Œç”¨äºå®šä¹‰åŠ¨æ€è·¯ç”±è§„åˆ™ã€‚é…ç½®çš„Data IDå¯ä»¥æ ¹æ®æ‚¨çš„å®é™…æƒ…å†µè¿›è¡Œå®šä¹‰ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯&lt;spring.application.name&gt;-&lt;spring.profiles.active&gt;.yamlä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹é…ç½®ï¼š</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308172132323.png" alt="image-20230817212606004"></p></li><li><p><strong>æµ‹è¯•</strong></p><ul><li><p>è®¿é—®userï¼Œorderç›¸å…³è·¯ç”±æ²¡æœ‰é—®é¢˜</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308172133265.png" alt="image-20230817213157261"></p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308172133225.png" alt="image-20230817213209689"></p></li><li><p>ç§»é™¤userç›¸å…³çš„è·¯ç”±ï¼Œè¯·æ±‚userç›¸å…³è·¯ç”±404ï¼Œè¯·æ±‚orderç›¸å…³è·¯ç”±æ²¡æœ‰é—®é¢˜</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308172133551.png" alt="image-20230817213049030"></p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308172133941.png" alt="image-20230817213130551"></p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308180955610.png" alt="image-20230817213238702"></p></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Spring Cloud Gatewayæ˜¯ä¸€ä¸ªåŸºäºSpring Frameworkçš„å¼€æºAPIç½‘å…³ï¼Œç”¨äºæ„å»ºå¾®æœåŠ¡æ¶æ„ä¸­çš„ç»Ÿä¸€è®¿é—®å±‚ã€‚å®ƒå……å½“äº†åº”ç”¨ç¨‹åºå’Œåç«¯æœåŠ¡ä¹‹é—´çš„ä»£ç†ï¼Œæä¾›äº†è·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€å®‰å…¨æ€§ã€ç›‘æ§ç­‰åŠŸèƒ½ï¼Œä»¥ç®€åŒ–å¾®æœåŠ¡æ¶æ„ä¸­çš„ç½‘ç»œè¯·æ±‚ç®¡ç†å’Œæµé‡æ§åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="SpringCloud" scheme="https://cason.work/categories/SpringCloud/"/>
    
    
    <category term="Gateway" scheme="https://cason.work/tags/Gateway/"/>
    
    <category term="APIç½‘å…³" scheme="https://cason.work/tags/API%E7%BD%91%E5%85%B3/"/>
    
    <category term="åˆ†å¸ƒå¼ç³»ç»Ÿ" scheme="https://cason.work/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>OpenFeignå®è·µ</title>
    <link href="https://cason.work/2023/08/16/OpenFeign%E5%AE%9E%E8%B7%B5/"/>
    <id>https://cason.work/2023/08/16/OpenFeign%E5%AE%9E%E8%B7%B5/</id>
    <published>2023-08-16T12:23:44.000Z</published>
    <updated>2023-08-16T13:05:22.925Z</updated>
    
    <content type="html"><![CDATA[<p>OpenFeignæ˜¯ä¸€ä¸ªç”¨äºå£°æ˜å¼RESTå®¢æˆ·ç«¯çš„Javaæ¡†æ¶ï¼Œå®ƒæ˜¯ç”±Netflixå¼€å‘çš„ï¼Œç”¨äºç®€åŒ–åœ¨Javaåº”ç”¨ç¨‹åºä¸­è°ƒç”¨HTTP APIçš„è¿‡ç¨‹ã€‚å®ƒä¸Spring Cloudé›†æˆå¾—å¾ˆå¥½ï¼Œç‰¹åˆ«é€‚ç”¨äºå¾®æœåŠ¡æ¶æ„ä¸­çš„æœåŠ¡é—´é€šä¿¡ã€‚</p><p>OpenFeignçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å®šä¹‰æ¥å£çš„æ–¹å¼æ¥æè¿°è¿œç¨‹APIçš„è°ƒç”¨ã€‚ä½ å¯ä»¥ä½¿ç”¨æ³¨è§£åœ¨æ¥å£æ–¹æ³•ä¸ŠæŒ‡å®šHTTPè¯·æ±‚çš„æ–¹å¼ã€URLã€è¯·æ±‚å‚æ•°ã€è¯·æ±‚ä½“ã€å“åº”å¤„ç†ç­‰ä¿¡æ¯ï¼Œè€Œä¸å¿…æ‰‹åŠ¨ç¼–å†™å¤§é‡çš„HTTPè¯·æ±‚ä»£ç ã€‚è¿™ç§æ–¹å¼ä½¿å¾—ä»£ç æ›´åŠ æ¸…æ™°ã€å¯è¯»æ€§æ›´é«˜ï¼Œå¹¶ä¸”å¯ä»¥æ–¹ä¾¿åœ°ç»´æŠ¤å’Œæ‰©å±•ã€‚</p><p>ä¸»è¦ç‰¹ç‚¹å’Œä¼˜åŠ¿åŒ…æ‹¬ï¼š</p><ol><li><strong>å£°æ˜å¼æ¥å£å®šä¹‰ï¼š</strong> ä½¿ç”¨Javaæ¥å£æ¥æè¿°APIè°ƒç”¨ï¼Œé€šè¿‡æ³¨è§£æ¥é…ç½®è¯·æ±‚çš„æ–¹å¼ã€è·¯å¾„ç­‰ä¿¡æ¯ï¼Œä½¿ä»£ç å…·æœ‰æ›´é«˜çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li><li><strong>é›†æˆè´Ÿè½½å‡è¡¡ï¼š</strong> OpenFeignä¸Ribbonç­‰è´Ÿè½½å‡è¡¡ç»„ä»¶é›†æˆï¼Œå¯ä»¥è‡ªåŠ¨åœ°åœ¨å¤šä¸ªæœåŠ¡å®ä¾‹ä¸­è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œæé«˜äº†ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œæ€§èƒ½ã€‚</li><li><strong>å†…å»ºHystrixæ”¯æŒï¼š</strong> OpenFeigné›†æˆäº†Hystrixï¼Œå¯ä»¥æ–¹ä¾¿åœ°ä¸ºæ¥å£æ–¹æ³•æ·»åŠ å®¹é”™å’Œé™çº§çš„é€»è¾‘ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„å¯é æ€§ã€‚</li><li><strong>ä¸Spring Cloudé›†æˆï¼š</strong> OpenFeignä¸Spring Cloudæ¡†æ¶æ— ç¼é›†æˆï¼Œå¯ä»¥ä¸Eurekaã€Configã€Zuulç­‰ç»„ä»¶ååŒå·¥ä½œï¼Œæ„å»ºå‡ºå®Œæ•´çš„å¾®æœåŠ¡æ¶æ„ã€‚</li><li><strong>ç®€åŒ–HTTPè°ƒç”¨ï¼š</strong> OpenFeignè‡ªåŠ¨å¤„ç†HTTPè¯·æ±‚å’Œå“åº”ï¼Œå‡å°‘äº†æ‰‹åŠ¨ç¼–å†™HTTPè¯·æ±‚ä»£ç çš„å¤æ‚æ€§ã€‚</li><li><strong>æ˜“äºæµ‹è¯•ï¼š</strong> ç”±äºOpenFeignæ¥å£æ˜¯åŸºäºJavaæ¥å£å®šä¹‰çš„ï¼Œå› æ­¤å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨å•å…ƒæµ‹è¯•æ¥æµ‹è¯•æ¥å£æ–¹æ³•ã€‚</li></ol><p>OpenFeignåœ¨å¾®æœåŠ¡æ¶æ„ä¸­å‘æŒ¥ç€é‡è¦çš„ä½œç”¨ï¼Œé€šè¿‡ç®€åŒ–æœåŠ¡é—´é€šä¿¡çš„å®ç°ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡å¹¶ä¿ƒè¿›äº†ç³»ç»Ÿçš„å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h2 id="OpenFeignç®€å•ä½¿ç”¨"><a href="#OpenFeignç®€å•ä½¿ç”¨" class="headerlink" title="OpenFeignç®€å•ä½¿ç”¨"></a>OpenFeignç®€å•ä½¿ç”¨</h2><h4 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--OpenFeign--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="å¯åŠ¨ç±»æ·»åŠ -EnableFeignClientsæ³¨è§£"><a href="#å¯åŠ¨ç±»æ·»åŠ -EnableFeignClientsæ³¨è§£" class="headerlink" title="å¯åŠ¨ç±»æ·»åŠ @EnableFeignClientsæ³¨è§£"></a>å¯åŠ¨ç±»æ·»åŠ <code>@EnableFeignClients</code>æ³¨è§£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@EnableFeignClients</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderApplication</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SpringApplication.run(OrderApplication.class, args);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="è¿œç¨‹æœåŠ¡å®¢æˆ·ç«¯"><a href="#è¿œç¨‹æœåŠ¡å®¢æˆ·ç«¯" class="headerlink" title="è¿œç¨‹æœåŠ¡å®¢æˆ·ç«¯"></a>è¿œç¨‹æœåŠ¡å®¢æˆ·ç«¯</h4><ul><li><p>Useré¡¹ç›®ä¸‹åˆ›å»ºUserController.javaå’ŒUserService.java é€šè¿‡&#x2F;user&#x2F;{id}æä¾›æœåŠ¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> &#123;<br><br>    <span class="hljs-keyword">public</span> UserEntity <span class="hljs-title function_">getUser</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-type">UserEntity</span> <span class="hljs-variable">userEntity</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserEntity</span>();<br>        userEntity.setId(id);<br>        userEntity.setName(<span class="hljs-string">&quot;ç”¨æˆ·&quot;</span>+id);<br>        <span class="hljs-keyword">return</span> userEntity;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserClient</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserService userService;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> UserEntity <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> &#123;<br>        <span class="hljs-keyword">return</span> userService.getUser(id);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Orderé¡¹ç›®ä¸‹åˆ›å»ºUserClient.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FeignClient(&quot;user-service&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserClient</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/user/&#123;id&#125;&quot;)</span><br>    UserEntity <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><p>@FeignClientæ³¨è§£å£°æ˜å¼RESTå®¢æˆ·ç«¯æ¥å£ä¸Šæ ‡è®°ï¼Œä»¥æŒ‡ç¤ºè¯¥æ¥å£å°†è¢«OpenFeignç”¨ä½œè¿œç¨‹æœåŠ¡è°ƒç”¨çš„å®¢æˆ·ç«¯ã€‚</p><p>ä¸»è¦å±æ€§åŒ…æ‹¬ï¼š</p><ol><li><strong>nameï¼š</strong> ç”¨äºæŒ‡å®šè¿œç¨‹æœåŠ¡çš„åç§°ã€‚è¿™é€šå¸¸æ˜¯Eurekaæ³¨å†Œä¸­å¿ƒä¸­çš„æœåŠ¡åç§°ï¼Œä»¥ä¾¿OpenFeignèƒ½å¤Ÿæ ¹æ®åç§°æ‰¾åˆ°å¯¹åº”çš„æœåŠ¡å®ä¾‹ã€‚ä¾‹å¦‚ï¼š<code>@FeignClient(name = &quot;user-service&quot;)</code>ã€‚</li><li><strong>urlï¼š</strong> å¦‚æœä¸ä½¿ç”¨æœåŠ¡å‘ç°ï¼ˆä¾‹å¦‚Eurekaï¼‰æ¥å®šä½æœåŠ¡ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šæœåŠ¡çš„URLã€‚ä¾‹å¦‚ï¼š<code>@FeignClient(url = &quot;http://localhost:8080&quot;)</code>ã€‚</li><li><strong>valueï¼š</strong> ä¸<code>name</code>å±æ€§ç›¸åŒï¼Œç”¨äºæŒ‡å®šè¿œç¨‹æœåŠ¡çš„åç§°ã€‚</li><li><strong>pathï¼š</strong> ç”¨äºæŒ‡å®šåŸºç¡€è·¯å¾„ï¼Œå®ƒä¼šè¢«æ·»åŠ åˆ°æ‰€æœ‰æ¥å£æ–¹æ³•çš„URLå‰é¢ã€‚ä¾‹å¦‚ï¼š<code>@FeignClient(name = &quot;user-service&quot;, path = &quot;/api&quot;)</code>ã€‚</li><li><strong>fallbackï¼š</strong> æŒ‡å®šä¸€ä¸ªé™çº§å¤„ç†çš„ç±»ï¼Œå½“è¿œç¨‹æœåŠ¡è°ƒç”¨å¤±è´¥æ—¶ä¼šæ‰§è¡Œé™çº§é€»è¾‘ã€‚è¿™ä¸ªç±»éœ€è¦å®ç°ç›¸åº”çš„æ¥å£ï¼Œå¹¶æ·»åŠ <code>@Component</code>æ³¨è§£ä»¥è®©Springèƒ½å¤Ÿæ‰«æåˆ°ã€‚ä¾‹å¦‚ï¼š<code>@FeignClient(name = &quot;user-service&quot;, fallback = UserServiceFallback.class)</code>ã€‚</li><li><strong>fallbackFactoryï¼š</strong> ä¸<code>fallback</code>ç±»ä¼¼ï¼Œä½†æ˜¯è¿™é‡ŒæŒ‡å®šçš„æ˜¯ä¸€ä¸ªé™çº§å¤„ç†å·¥å‚ï¼Œç”¨äºåˆ›å»ºé™çº§å¤„ç†ç±»çš„å®ä¾‹ã€‚è¿™é€šå¸¸ç”¨äºå®ç°æ›´å¤æ‚çš„é™çº§é€»è¾‘ã€‚ä¾‹å¦‚ï¼š<code>@FeignClient(name = &quot;user-service&quot;, fallbackFactory = UserServiceFallbackFactory.class)</code>ã€‚</li></ol><h4 id="è°ƒç”¨æ–¹"><a href="#è°ƒç”¨æ–¹" class="headerlink" title="è°ƒç”¨æ–¹"></a>è°ƒç”¨æ–¹</h4><ul><li><p>Orderé¡¹ç›®ä¸‹åˆ›å»ºOrderService.java </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserClient userClient;<br><br><br>    <span class="hljs-keyword">public</span> OrderEntity <span class="hljs-title function_">getOrder</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-type">OrderEntity</span> <span class="hljs-variable">orderEntity</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderEntity</span>();<br>        orderEntity.setUser(userClient.getUser(id));<br>        orderEntity.setId(id);<br>        orderEntity.setTitle(<span class="hljs-string">&quot;è®¢å•&quot;</span>+id);<br><br>        <span class="hljs-keyword">return</span> orderEntity;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Orderé¡¹ç›®ä¸‹åˆ›å»ºOrderController.java </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/order&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderController</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> OrderService orderService;<br>    <span class="hljs-meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> OrderEntity <span class="hljs-title function_">getOrder</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> &#123;<br>        <span class="hljs-keyword">return</span> orderService.getOrder(id);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h4 id="æ‰§è¡Œ"><a href="#æ‰§è¡Œ" class="headerlink" title="æ‰§è¡Œ"></a>æ‰§è¡Œ</h4><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308162052859.png" alt="image-20230816204051210"></p><h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h2><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308162052726.png" alt="image-20230816204027091"></p><p>RPC æ¥å£å’Œå®ç°å„è‡ªæ”¾åœ¨ç‹¬ç«‹çš„æ¨¡å—ä¸­ï¼Œæ–¹ä¾¿æœåŠ¡è°ƒç”¨æ–¹é‡ç”¨æœåŠ¡æ¥å£ï¼ŒæœåŠ¡æ¥å£æ¨¡å—åªèƒ½åŒ…æ‹¬æœ€åŸºæœ¬çš„æ¨¡å—ä¾é ï¼ˆè¿‡å¤šä¼šå¯¼è‡´ä¾é ä¼ é€’ï¼‰ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">user</span>:<br><span class="hljs-keyword">user</span><span class="hljs-operator">-</span>service<br><span class="hljs-keyword">user</span><span class="hljs-operator">-</span>api<br><span class="hljs-keyword">order</span>:<br><span class="hljs-keyword">order</span><span class="hljs-operator">-</span>service<br><span class="hljs-keyword">order</span><span class="hljs-operator">-</span>api<br></code></pre></td></tr></table></figure><p>xxx-api æ¨¡å—ä¸­æ”¾æœåŠ¡è°ƒç”¨æ–¹éœ€æ±‚ç”¨åˆ°çš„ä¸œè¥¿ï¼Œapiæ¥å£ï¼Œvoï¼Œå…¥å‚ç­‰ç­‰ã€‚</p><p>xxx-service å®ç° account-api ä¾›ç»™çš„æ¥å£ã€‚</p><ul><li><p>user-api</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FeignClient(&quot;user-service&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserClient</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/user/&#123;id&#125;&quot;)</span><br>    UserEntity <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>user-service</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserClient</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserService userService;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> UserEntity <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> &#123;<br>        <span class="hljs-keyword">return</span> userService.getUser(id);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure></li><li><p>Order-serviceå¼•å…¥user-api</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.cason<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>user-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>æŒ‡å®šclientæ³¨å…¥å®¹å™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@EnableFeignClients(clients = &#123;UserClient.class&#125;)</span><br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;OpenFeignæ˜¯ä¸€ä¸ªç”¨äºå£°æ˜å¼RESTå®¢æˆ·ç«¯çš„Javaæ¡†æ¶ï¼Œå®ƒæ˜¯ç”±Netflixå¼€å‘çš„ï¼Œç”¨äºç®€åŒ–åœ¨Javaåº”ç”¨ç¨‹åºä¸­è°ƒç”¨HTTP APIçš„è¿‡ç¨‹ã€‚å®ƒä¸Spring Cloudé›†æˆå¾—å¾ˆå¥½ï¼Œç‰¹åˆ«é€‚ç”¨äºå¾®æœåŠ¡æ¶æ„ä¸­çš„æœåŠ¡é—´é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;OpenFeignçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡</summary>
      
    
    
    
    
    <category term="SpringCloud" scheme="https://cason.work/tags/SpringCloud/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†å¸ƒå¼æ³¨å†Œä¸­å¿ƒ-Nacos</title>
    <link href="https://cason.work/2023/08/16/%E5%88%86%E5%B8%83%E5%BC%8F%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83-Nacos/"/>
    <id>https://cason.work/2023/08/16/%E5%88%86%E5%B8%83%E5%BC%8F%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83-Nacos/</id>
    <published>2023-08-16T02:22:27.000Z</published>
    <updated>2023-09-05T07:10:34.442Z</updated>
    
    <content type="html"><![CDATA[<p>åˆ†å¸ƒå¼æ³¨å†Œä¸­å¿ƒæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€ç§å…³é”®ç»„ä»¶ï¼Œç”¨äºç®¡ç†å’Œç»´æŠ¤å„ä¸ªåˆ†å¸ƒå¼æœåŠ¡å®ä¾‹çš„æ³¨å†Œã€å‘ç°å’ŒçŠ¶æ€ä¿¡æ¯ã€‚å®ƒæä¾›äº†ä¸€ç§é›†ä¸­åŒ–çš„æœºåˆ¶ï¼Œä½¿å¾—ä¸åŒçš„æœåŠ¡èƒ½å¤Ÿåœ¨ä¸€ä¸ªå…±äº«çš„åœ°æ–¹æ³¨å†Œè‡ªå·±çš„ä¿¡æ¯ï¼Œå¹¶èƒ½å¤ŸåŠ¨æ€åœ°å‘ç°å…¶ä»–æœåŠ¡ï¼Œä»è€Œå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æœåŠ¡æ²»ç†å’Œé€šä¿¡ã€‚</p><p>åœ¨åˆ†å¸ƒå¼æ¶æ„ä¸­ï¼ŒæœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°æ˜¯ä¸¤ä¸ªå…³é”®çš„æ¦‚å¿µï¼Œç”¨äºç®¡ç†å’Œç»´æŠ¤ç³»ç»Ÿä¸­å„ä¸ªåˆ†å¸ƒå¼ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ã€‚</p><p><strong>æœåŠ¡æ³¨å†Œï¼š</strong> æœåŠ¡æ³¨å†Œæ˜¯æŒ‡å°†æœåŠ¡çš„ç½‘ç»œåœ°å€å’Œå…ƒæ•°æ®æ³¨å†Œåˆ°ä¸€ä¸ªä¸­å¿ƒåŒ–çš„æœåŠ¡æ³¨å†Œè¡¨ä¸­ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå„ä¸ªæœåŠ¡æä¾›è€…å°†è‡ªå·±çš„æœåŠ¡æ³¨å†Œåˆ°è¿™ä¸ªæ³¨å†Œè¡¨ï¼Œä½¿å¾—å…¶ä»–ç»„ä»¶æˆ–æœåŠ¡èƒ½å¤Ÿæ‰¾åˆ°å¹¶ä¸å…¶é€šä¿¡ã€‚è¿™ç§æ³¨å†Œå¯ä»¥åŒ…æ‹¬æœåŠ¡çš„åç§°ã€ç‰ˆæœ¬ã€IPåœ°å€ã€ç«¯å£å·ç­‰ä¿¡æ¯ï¼Œä»¥ä¾¿å…¶ä»–æœåŠ¡èƒ½å¤Ÿå‡†ç¡®åœ°å®šä½å’Œè¿æ¥åˆ°è¿™äº›æœåŠ¡ã€‚</p><p><strong>æœåŠ¡å‘ç°ï¼š</strong> æœåŠ¡å‘ç°æ˜¯æŒ‡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªæœåŠ¡æˆ–ç»„ä»¶èƒ½å¤ŸåŠ¨æ€åœ°æ‰¾åˆ°å’Œè¯†åˆ«å…¶ä»–æœåŠ¡çš„è¿‡ç¨‹ã€‚é€šè¿‡æœåŠ¡å‘ç°ï¼ŒæœåŠ¡æ¶ˆè´¹è€…èƒ½å¤ŸæŸ¥è¯¢æœåŠ¡æ³¨å†Œè¡¨ï¼Œæ‰¾åˆ°æ‰€éœ€çš„æœåŠ¡çš„ç½‘ç»œåœ°å€å’Œå…¶ä»–ä¿¡æ¯ï¼Œä»è€Œèƒ½å¤Ÿä¸å…¶å»ºç«‹é€šä¿¡å’Œäº¤äº’ã€‚æœåŠ¡å‘ç°å¯ä»¥å¸®åŠ©ç³»ç»Ÿè‡ªåŠ¨é€‚åº”ç»„ä»¶çš„å˜åŒ–ï¼Œå¦‚æ–°å¢ã€åˆ é™¤æˆ–æ›¿æ¢æœåŠ¡ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨æ›´æ–°é…ç½®ã€‚</p><p><strong>Zookeeperï¼š</strong> Zookeeperæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„åè°ƒæœåŠ¡ï¼Œå¯ä»¥ç”¨äºæœåŠ¡æ³¨å†Œä¸å‘ç°ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå±‚æ¬¡åŒ–çš„å‘½åç©ºé—´ç»“æ„ï¼Œå…è®¸æœåŠ¡æ³¨å†Œå’Œå‘ç°ï¼Œå¹¶èƒ½å¤Ÿå¤„ç†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€è‡´æ€§é—®é¢˜ã€‚Zookeeperé€‚ç”¨äºä¸€äº›éœ€è¦é«˜ä¸€è‡´æ€§å’Œç¨³å®šæ€§çš„åœºæ™¯</p><p><strong>Eurekaï¼š</strong> Eurekaæ˜¯Netflixå¼€æºçš„ä¸€ä¸ªæœåŠ¡å‘ç°ç»„ä»¶ï¼Œç‰¹åˆ«é€‚ç”¨äºåŸºäºå¾®æœåŠ¡æ¶æ„çš„ç³»ç»Ÿã€‚å®ƒå…è®¸æœåŠ¡æ³¨å†Œå’Œå‘ç°ï¼Œå¹¶æä¾›äº†ä¸€äº›é«˜çº§çš„è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»æœºåˆ¶ã€‚Eurekaä¸€èˆ¬ç”¨äºå†…éƒ¨æœåŠ¡å‘ç°ï¼Œä¸å¤ªé€‚åˆå¤æ‚çš„å¤šæ•°æ®ä¸­å¿ƒåœºæ™¯ã€‚</p><p><strong>Nacosï¼š</strong> Nacosæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€ä¸ªç»¼åˆæ€§æœåŠ¡å‘ç°å’Œé…ç½®ç®¡ç†å¹³å°ï¼Œæ”¯æŒæœåŠ¡æ³¨å†Œã€é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°å’ŒåŠ¨æ€é…ç½®æ›´æ–°ç­‰åŠŸèƒ½ã€‚å®ƒèƒ½å¤Ÿæ»¡è¶³å¤šç§åˆ†å¸ƒå¼ç³»ç»Ÿçš„éœ€æ±‚ï¼ŒåŒ…æ‹¬å¾®æœåŠ¡å’Œäº‘åŸç”Ÿåº”ç”¨ã€‚</p><h2 id="Nacos-å®ç°ç®€å•çš„æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°"><a href="#Nacos-å®ç°ç®€å•çš„æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°" class="headerlink" title="Nacos å®ç°ç®€å•çš„æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°"></a>Nacos å®ç°ç®€å•çš„æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°</h2><h3 id="å¯åŠ¨åˆ†å¸ƒå¼æ³¨å†Œä¸­å¿ƒ"><a href="#å¯åŠ¨åˆ†å¸ƒå¼æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="å¯åŠ¨åˆ†å¸ƒå¼æ³¨å†Œä¸­å¿ƒ"></a>å¯åŠ¨åˆ†å¸ƒå¼æ³¨å†Œä¸­å¿ƒ</h3><blockquote><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://nacos.io/zh-cn/docs/what-is-nacos.html">ä»€ä¹ˆæ˜¯ Nacos</a></p></blockquote><p>å¯åŠ¨nacos</p><figure class="highlight shell"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">å‰å¾€è§£å‹çš„nacosæ–‡ä»¶å¤¹å†…</span><br>cd bin<br>./startup.sh -m standalone<br></code></pre></td></tr></table></figure><p>å¯åŠ¨æˆåŠŸ</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308161114188.png" alt="image-20230816103800624"></p><p>è®¿é—®åœ°å€ï¼š<a href="http://localhost:8848/nacos/#/login">http://localhost:8848/nacos/#/login</a></p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308161114059.png" alt="image-20230816103746727"></p><p>è´¦å·å¯†ç ï¼šnacos&#x2F;nacos</p><h2 id="æ³¨å†ŒæœåŠ¡"><a href="#æ³¨å†ŒæœåŠ¡" class="headerlink" title="æ³¨å†ŒæœåŠ¡"></a>æ³¨å†ŒæœåŠ¡</h2><p>é¡¹ç›®æ ¹ç›®å½•pom.xmlæ·»åŠ springcloudï¼Œspringcloud alibabaä¾èµ–ç®¡ç†</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>         <span class="hljs-comment">&lt;!-- springCloud --&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>         <span class="hljs-comment">&lt;!-- alibaba nacos--&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.5.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span><br></code></pre></td></tr></table></figure><p>Moduleé¡¹ç›®pom.xmlæ·»åŠ nacos discoveryä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- nacoså®¢æˆ·ç«¯ä¾èµ–åŒ… --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>application.yamlæ·»åŠ nacosç›¸å…³é…ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">user-service</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>    <span class="hljs-comment"># nacosæœåŠ¡åœ°å€</span><br>      <span class="hljs-attr">server-addr:</span> <span class="hljs-string">localhost:8848</span> <br>      <span class="hljs-attr">discovery:</span><br>      <span class="hljs-comment"># cluster-name å±æ€§æ¥æŒ‡å®šé›†ç¾¤åç§°ï¼Œä»è€Œæ›´å¥½åœ°ç®¡ç†å’ŒåŒºåˆ†ä¸åŒçš„æœåŠ¡å‘ç°é›†ç¾¤ã€‚</span><br>        <span class="hljs-attr">cluster-name:</span> <span class="hljs-string">HZ</span><br>        <span class="hljs-comment"># å‘½åç©ºé—´ï¼šå‘½åç©ºé—´å¯ä»¥ç”¨æ¥éš”ç¦»ä¸åŒçš„åº”ç”¨æˆ–å›¢é˜Ÿçš„é…ç½®ã€‚ä¸åŒçš„å‘½åç©ºé—´å¯ä»¥åœ¨ä¸åŒçš„ Nacos å®ä¾‹ä¸­ã€‚</span><br>        <span class="hljs-attr">namespace:</span> <span class="hljs-string">7a5618ff-a674-46dd-99a7-33da5f094f7f</span> <span class="hljs-comment"># å‘½åç©ºé—´ID</span><br>        <span class="hljs-comment"># æ˜¯å¦æ˜¯ä¸´æ—¶å®ä¾‹</span><br>        <span class="hljs-attr">ephemeral:</span> <span class="hljs-literal">true</span> <br></code></pre></td></tr></table></figure><p>å¯åŠ¨é¡¹ç›®</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308161114223.png" alt="image-20230816111101326"></p><p>æ³¨å†Œåˆ° Nacos åï¼Œæ‚¨çš„å¾®æœåŠ¡å°†è¢«è‡ªåŠ¨æ³¨å†Œåˆ° Nacos æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œå¹¶ä¸”å…¶ä»–å¾®æœåŠ¡å¯ä»¥ä½¿ç”¨ Nacos è¿›è¡ŒæœåŠ¡å‘ç°ã€‚è¿™ä½¿å¾—å¾®æœåŠ¡å¯ä»¥è½»æ¾åœ°æ‰¾åˆ°å…¶ä»–æœåŠ¡çš„å®ä¾‹ï¼Œå¹¶è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œä»è€Œå®ç°æ›´é«˜çš„å¯ç”¨æ€§å’Œæ€§èƒ½ã€‚Nacos æ”¯æŒåŠ¨æ€æ³¨å†Œå’Œæ³¨é”€å¾®æœåŠ¡ï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°æ·»åŠ ã€æ›´æ–°æˆ–åˆ é™¤æœåŠ¡å®ä¾‹ï¼Œè€Œæ— éœ€é‡å¯åº”ç”¨ã€‚è¿™ä½¿å¾—æœåŠ¡çš„ç®¡ç†å’Œç»´æŠ¤æ›´åŠ çµæ´»å’Œé«˜æ•ˆã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åˆ†å¸ƒå¼æ³¨å†Œä¸­å¿ƒæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€ç§å…³é”®ç»„ä»¶ï¼Œç”¨äºç®¡ç†å’Œç»´æŠ¤å„ä¸ªåˆ†å¸ƒå¼æœåŠ¡å®ä¾‹çš„æ³¨å†Œã€å‘ç°å’ŒçŠ¶æ€ä¿¡æ¯ã€‚å®ƒæä¾›äº†ä¸€ç§é›†ä¸­åŒ–çš„æœºåˆ¶ï¼Œä½¿å¾—ä¸åŒçš„æœåŠ¡èƒ½å¤Ÿåœ¨ä¸€ä¸ªå…±äº«çš„åœ°æ–¹æ³¨å†Œè‡ªå·±çš„ä¿¡æ¯ï¼Œå¹¶èƒ½å¤ŸåŠ¨æ€åœ°å‘ç°å…¶ä»–æœåŠ¡ï¼Œä»è€Œå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æœåŠ¡æ²»ç†å’Œé€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨åˆ†å¸ƒå¼æ¶æ„ä¸­ï¼Œæœ</summary>
      
    
    
    
    <category term="SpringCloud" scheme="https://cason.work/categories/SpringCloud/"/>
    
    
    <category term="åˆ†å¸ƒå¼ç³»ç»Ÿ" scheme="https://cason.work/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"/>
    
    <category term="Nacos" scheme="https://cason.work/tags/Nacos/"/>
    
    <category term="æ³¨å†Œä¸­å¿ƒ" scheme="https://cason.work/tags/%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83/"/>
    
    <category term="æœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°" scheme="https://cason.work/tags/%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>Github actionæŒç»­éƒ¨ç½²springboot+vueå‰åç«¯åˆ†ç¦»é¡¹ç›®</title>
    <link href="https://cason.work/2023/08/15/Github-action%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2springboot-vue%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE/"/>
    <id>https://cason.work/2023/08/15/Github-action%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2springboot-vue%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE/</id>
    <published>2023-08-15T02:09:24.000Z</published>
    <updated>2023-08-15T02:56:51.456Z</updated>
    
    <content type="html"><![CDATA[<p>å› ä¸ºè´­ä¹°çš„é˜¿é‡Œäº‘æœåŠ¡å™¨æ€§èƒ½æ¯”è¾ƒæ‹‰å®ï¼Œå®‰è£…jenkinsåšæŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²ä¼šå ç”¨æ¯”è¾ƒå¤§é‡çš„æœåŠ¡å™¨èµ„æºã€‚å› ä¸ºå®ä¹ çš„æ—¶å€™å½“æ—¶è´Ÿè´£çš„ä¸€ä¸ªé¡¹ç›®å°±æ˜¯æŠŠjenkinsè¿ç§»åˆ°github actionï¼Œæ‰€ä»¥å°±ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨Github action.</p><p>GitHub Actions æ˜¯ä¸€ä¸ªç”± GitHub æä¾›çš„æŒç»­é›†æˆï¼ˆCIï¼‰å’ŒæŒç»­éƒ¨ç½²ï¼ˆCDï¼‰å¹³å°ï¼Œå®ƒå…è®¸å¼€å‘è€…åœ¨ä»£ç ä»“åº“ä¸­è®¾ç½®è‡ªåŠ¨åŒ–çš„å·¥ä½œæµç¨‹ã€‚è¿™äº›å·¥ä½œæµç¨‹å¯ä»¥åœ¨ä»£ç çš„ä¸åŒäº‹ä»¶è§¦å‘æ—¶è‡ªåŠ¨æ‰§è¡Œï¼Œä¾‹å¦‚æ¨é€ä»£ç ã€åˆ›å»º Pull Requestã€å‘å¸ƒ Release ç­‰ã€‚</p><h2 id="Secreté…ç½®"><a href="#Secreté…ç½®" class="headerlink" title="Secreté…ç½®"></a>Secreté…ç½®</h2><p>éœ€è¦æå‰é…ç½®ä¸€äº›github action secretï¼Œæ‰“å¼€å¯¹åº”é¡¹ç›®setting</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202308151056837.png" alt="image-20230815103929921"></p><p>é…ç½®åå³å¯åœ¨yamlæ–‡ä»¶ä¸­ä½¿ç”¨$ä½¿ç”¨å¯¹åº”å€¼</p><h2 id="vueé¡¹ç›®"><a href="#vueé¡¹ç›®" class="headerlink" title="vueé¡¹ç›®"></a>vueé¡¹ç›®</h2><p>åœ¨é¡¹ç›®é‡Œç¼–å†™.github&#x2F;workflows&#x2F;node.js.yml</p><p>åœ¨github actioné‡Œå®ç°äº†</p><p>1ã€checkoutä»£ç </p><p>2ã€å°†æºä»£ç è¿›è¡Œæ‰“åŒ…ã€å‹ç¼©å’Œä¼˜åŒ–ï¼Œç”Ÿæˆé€‚åˆéƒ¨ç½²çš„ç”Ÿäº§ç¯å¢ƒä»£ç </p><p>3ã€å‹ç¼©å¹¶scpå‘é€åˆ°æœåŠ¡å™¨æŒ‡å®šåœ°å€å¹¶è§£å‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></div></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Node.js</span> <span class="hljs-string">CI</span><br><br><span class="hljs-attr">on:</span><br>  <span class="hljs-attr">push:</span><br>    <span class="hljs-attr">branches:</span> [ <span class="hljs-string">&quot;master&quot;</span> ]<br>  <span class="hljs-attr">pull_request:</span><br>    <span class="hljs-attr">branches:</span> [ <span class="hljs-string">&quot;master&quot;</span> ]<br><br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">build:</span><br><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br><br>    <span class="hljs-attr">strategy:</span><br>      <span class="hljs-attr">matrix:</span><br>        <span class="hljs-attr">node-version:</span> [ <span class="hljs-number">16.</span><span class="hljs-string">x</span> ]<br>        <span class="hljs-comment"># See supported Node.js release schedule at https://nodejs.org/en/about/releases/</span><br><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Use</span> <span class="hljs-string">Node.js</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.node-version</span> <span class="hljs-string">&#125;&#125;</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v3</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-attr">node-version:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.node-version</span> <span class="hljs-string">&#125;&#125;</span><br>          <span class="hljs-attr">cache:</span> <span class="hljs-string">&#x27;npm&#x27;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">ci</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span> <span class="hljs-string">--if-present</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">zip</span> <span class="hljs-string">-r</span> <span class="hljs-string">ui.zip</span> <span class="hljs-string">ui/</span><br><br>      <span class="hljs-comment"># éƒ¨ç½²åˆ°æœåŠ¡å™¨</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">ğŸš€</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">cross-the-world/ssh-scp-ssh-pipelines@latest</span> <br>        <span class="hljs-attr">env:</span><br>         <span class="hljs-attr">WELCOME:</span> <span class="hljs-string">&quot;ssh scp ssh pipelines&quot;</span><br>         <span class="hljs-attr">LASTSSH:</span> <span class="hljs-string">&quot;Doing something after copying&quot;</span><br>        <span class="hljs-attr">with:</span><br>         <span class="hljs-attr">host:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.HOST</span> <span class="hljs-string">&#125;&#125;</span><br>         <span class="hljs-attr">user:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.USERNAME</span> <span class="hljs-string">&#125;&#125;</span><br>         <span class="hljs-attr">pass:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.PASSWORD</span> <span class="hljs-string">&#125;&#125;</span><br>         <span class="hljs-attr">port:</span> <span class="hljs-number">22</span><br>         <span class="hljs-attr">first_ssh:</span> <span class="hljs-string">|</span><br><span class="hljs-string">            ls -a</span><br><span class="hljs-string"></span>         <span class="hljs-attr">scp:</span> <span class="hljs-string">|</span><br><span class="hljs-string">           &#x27;./ui.zip&#x27; =&gt; /www/wwwroot/default/x-springboot/</span><br><span class="hljs-string"></span>         <span class="hljs-attr">last_ssh:</span> <span class="hljs-string">|</span><br><span class="hljs-string">           cd /www/wwwroot/default/x-springboot/</span><br><span class="hljs-string">           unzip ui.zip</span><br></code></pre></td></tr></table></figure><h2 id="Springbooté¡¹ç›®"><a href="#Springbooté¡¹ç›®" class="headerlink" title="Springbooté¡¹ç›®"></a>Springbooté¡¹ç›®</h2><p>åœ¨é¡¹ç›®ä¸­ç¼–å†™.github&#x2F;workflows&#x2F;maven.yml</p><p>1ã€checkoutä»£ç </p><p>2ã€ä½¿ç”¨mavenæ‰“åŒ…é¡¹ç›®æˆjarbao</p><p>3ã€scpå‘é€åˆ°æœåŠ¡å™¨æŒ‡å®šåœ°å€</p><p>4ã€å®å¡”é‡æ–°å¯åŠ¨é¡¹ç›®ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨yamlä¸­ç¼–å†™last_ssh: æ‰§è¡Œjava -jarå¯åŠ¨é¡¹ç›®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Java</span> <span class="hljs-string">CI</span> <span class="hljs-string">with</span> <span class="hljs-string">Maven</span><br><br><span class="hljs-attr">on:</span><br>  <span class="hljs-attr">push:</span><br>    <span class="hljs-attr">branches:</span> [ <span class="hljs-string">&quot;master&quot;</span> ]<br>  <span class="hljs-attr">pull_request:</span><br>    <span class="hljs-attr">branches:</span> [ <span class="hljs-string">&quot;master&quot;</span> ]<br><br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">build:</span><br><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br><br>    <span class="hljs-attr">steps:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Set</span> <span class="hljs-string">up</span> <span class="hljs-string">JDK</span> <span class="hljs-number">17</span><br>      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-java@v3</span><br>      <span class="hljs-attr">with:</span><br>        <span class="hljs-attr">java-version:</span> <span class="hljs-string">&#x27;17&#x27;</span><br>        <span class="hljs-attr">distribution:</span> <span class="hljs-string">&#x27;temurin&#x27;</span><br>        <span class="hljs-attr">cache:</span> <span class="hljs-string">maven</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">with</span> <span class="hljs-string">Maven</span><br>      <span class="hljs-attr">run:</span> <span class="hljs-string">mvn</span> <span class="hljs-string">-B</span> <span class="hljs-string">package</span> <span class="hljs-string">--file</span> <span class="hljs-string">pom.xml</span><br><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">copy</span> <span class="hljs-string">jar</span><br>      <span class="hljs-attr">uses:</span> <span class="hljs-string">cross-the-world/ssh-scp-ssh-pipelines@latest</span><br>      <span class="hljs-attr">with:</span><br>        <span class="hljs-attr">host:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.HOST</span> <span class="hljs-string">&#125;&#125;</span><br>        <span class="hljs-attr">user:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.USERNAME</span> <span class="hljs-string">&#125;&#125;</span><br>        <span class="hljs-attr">pass:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.PASSWORD</span> <span class="hljs-string">&#125;&#125;</span><br>        <span class="hljs-attr">port:</span> <span class="hljs-number">22</span><br>        <span class="hljs-attr">scp:</span> <span class="hljs-string">|</span><br><span class="hljs-string">          ./target/x-springboot.jar =&gt; /www/wwwroot/default/x-springboot/</span><br><span class="hljs-string"></span><span class="hljs-comment">#å‚è€ƒä»¥ä¸‹åœ¨scpä¸Šä¼ åŒ…ä»¥åæ‰§è¡Œ</span><br><span class="hljs-comment">#        last_ssh: |</span><br><span class="hljs-comment">#        nohup java -jar /www/wwwroot/default/x-springboot/x-springboot.jar &gt;temp.txt &amp; </span><br></code></pre></td></tr></table></figure><h2 id="Nginxé…ç½®"><a href="#Nginxé…ç½®" class="headerlink" title="Nginxé…ç½®"></a>Nginxé…ç½®</h2><p>å½“ç„¶è¿™é‡Œæ¯ä¸ªäººçš„é¡¹ç›®ä¸ä¸€æ ·nginxé…ç½®éƒ½ä¸ä¸€æ ·ï¼Œæˆ‘åªæ˜¯ç”¨æ¥è®°å½•ä¸€ä¸‹æ–¹ä¾¿ä»¥åæ¢å¤ç¯å¢ƒ</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl http2;<br>    <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">443</span> ssl http2;<br>    <span class="hljs-attribute">server_name</span> &lt;åŸŸå&gt;;<br>    <span class="hljs-attribute">client_max_body_size</span> <span class="hljs-number">100m</span>;<br><br>    <span class="hljs-attribute">ssl_certificate</span> &lt;path&gt;_bundle.crt;<br>    <span class="hljs-attribute">ssl_certificate_key</span> &lt;path&gt;.key;<br>    <span class="hljs-attribute">ssl_trusted_certificate</span> &lt;path&gt;_bundle.pem;<br><br>    <span class="hljs-comment"># SSLé…ç½®</span><br>    <span class="hljs-attribute">ssl_session_timeout</span> <span class="hljs-number">1d</span>;<br>    <span class="hljs-attribute">ssl_session_cache</span> shared:MozSSL:<span class="hljs-number">10m</span>;<br>    <span class="hljs-attribute">ssl_session_tickets</span> <span class="hljs-literal">off</span>;<br><br>    <span class="hljs-comment"># SSLåŠ å¯†æ–¹å¼ï¼Œä½¿ç”¨ç°ä»£åŒ–çš„åŠ å¯†å¥—ä»¶</span><br>    <span class="hljs-attribute">ssl_protocols</span> TLSv1.<span class="hljs-number">2</span> TLSv1.<span class="hljs-number">3</span>;<br>    <span class="hljs-attribute">ssl_ciphers</span> ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDSA-AES256-SHA384:RSA-AES256-SHA384:ECDSA-AES256-SHA:RSA-AES256-SHA:ECDSA-AES128-SHA256:RSA-AES128-SHA256:ECDSA-AES128-SHA:RSA-AES128-SHA:!DSS;<br><br><br>    <span class="hljs-section">location</span> / &#123;<br>        <span class="hljs-comment"># UIç›®å½•</span><br>        <span class="hljs-attribute">root</span> /www/wwwroot/default/x-springboot/ui/;<br>        <span class="hljs-comment">#åŠ¨æ€é¡µé¢</span><br>        <span class="hljs-attribute">proxy_set_header</span> X-forwarded-for <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;<br>        <span class="hljs-attribute">proxy_set_header</span> X-Real-IP <span class="hljs-variable">$remote_addr</span>;<br>        <span class="hljs-attribute">if</span> ( !-e <span class="hljs-variable">$request_filename</span> ) &#123;<br>            <span class="hljs-attribute">proxy_pass</span> http://127.0.0.1:8080;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-section">location</span><span class="hljs-regexp"> ^~//</span> &#123;<br>        <span class="hljs-attribute">proxy_set_header</span> X-forwarded-for <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;<br>        <span class="hljs-attribute">proxy_set_header</span> X-Real-IP <span class="hljs-variable">$remote_addr</span>;<br>        <span class="hljs-attribute">proxy_pass</span> http://127.0.0.1:8080;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å› ä¸ºè´­ä¹°çš„é˜¿é‡Œäº‘æœåŠ¡å™¨æ€§èƒ½æ¯”è¾ƒæ‹‰å®ï¼Œå®‰è£…jenkinsåšæŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²ä¼šå ç”¨æ¯”è¾ƒå¤§é‡çš„æœåŠ¡å™¨èµ„æºã€‚å› ä¸ºå®ä¹ çš„æ—¶å€™å½“æ—¶è´Ÿè´£çš„ä¸€ä¸ªé¡¹ç›®å°±æ˜¯æŠŠjenkinsè¿ç§»åˆ°github actionï¼Œæ‰€ä»¥å°±ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨Github action.&lt;/p&gt;
&lt;p&gt;GitHub Actio</summary>
      
    
    
    
    
    <category term="CI/CD" scheme="https://cason.work/tags/CI-CD/"/>
    
  </entry>
  
  <entry>
    <title>ä»è¾“å…¥URLåˆ°é¡µé¢å±•ç¤ºå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</title>
    <link href="https://cason.work/2023/08/10/%E4%BB%8E%E8%BE%93%E5%85%A5URL%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%A4%BA%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F/"/>
    <id>https://cason.work/2023/08/10/%E4%BB%8E%E8%BE%93%E5%85%A5URL%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%A4%BA%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F/</id>
    <published>2023-08-10T11:37:36.000Z</published>
    <updated>2023-08-10T11:53:15.619Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€ä¸ªURLä»æµè§ˆå™¨è¾“å…¥åˆ°åº”ç”¨æœåŠ¡å¤„ç†çš„å®Œæ•´è¯·æ±‚è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€è¦çš„æ¦‚è¿°ï¼š</p><ol><li><p><strong>URLè§£æå’Œåˆ†æ</strong>ï¼š ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥URLï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰ã€‚æµè§ˆå™¨éœ€è¦è§£æè¿™ä¸ªURLï¼Œå®ƒåŒ…æ‹¬åè®®ï¼ˆå¦‚httpã€httpsï¼‰ã€åŸŸåï¼ˆä¾‹å¦‚<a href="http://www.example.com)ã€è·¯å¾„ã€æŸ¥è¯¢å‚æ•°ç­‰ç­‰./">www.example.comï¼‰ã€è·¯å¾„ã€æŸ¥è¯¢å‚æ•°ç­‰ç­‰ã€‚</a></p></li><li><p><strong>DNSè§£æ</strong>ï¼š æµè§ˆå™¨éœ€è¦å°†åŸŸåè§£æä¸ºIPåœ°å€ï¼Œè¿™ä¸€è¿‡ç¨‹ç§°ä¸ºDNSè§£æã€‚æµè§ˆå™¨å‘æœ¬åœ°DNSæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œæœ¬åœ°DNSæœåŠ¡å™¨å¯èƒ½ä¼šæŸ¥è¯¢å…¶ç¼“å­˜ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå®ƒä¼šå‘æ ¹DNSæœåŠ¡å™¨é€æ­¥æŸ¥è¯¢ï¼Œæœ€ç»ˆæ‰¾åˆ°å¯¹åº”çš„IPåœ°å€ã€‚</p></li><li><p><strong>å»ºç«‹TCPè¿æ¥</strong>ï¼š é€šè¿‡è§£æå¾—åˆ°çš„IPåœ°å€ï¼Œæµè§ˆå™¨ä¸ç›®æ ‡æœåŠ¡å™¨å»ºç«‹TCPè¿æ¥ã€‚è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠTCPçš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œç¡®ä¿æµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´å¯ä»¥è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚</p></li><li><p><strong>å‘èµ·HTTPè¯·æ±‚</strong>ï¼š ä¸€æ—¦TCPè¿æ¥å»ºç«‹ï¼Œæµè§ˆå™¨ä¼šå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªHTTPè¯·æ±‚ã€‚è¿™ä¸ªè¯·æ±‚ä¸­åŒ…å«äº†ä¹‹å‰è§£æå¾—åˆ°çš„è·¯å¾„ã€æŸ¥è¯¢å‚æ•°ã€è¯·æ±‚æ–¹æ³•ï¼ˆGETã€POSTç­‰ï¼‰ã€Headersï¼ˆä¾‹å¦‚User-Agentã€Cookieç­‰ï¼‰ç­‰ä¿¡æ¯ã€‚</p><blockquote><p>:authority:cason.work</p><p>:method:GET</p><p>:path:&#x2F;api&#x2F;user&#x2F;sysInfo</p><p>:scheme:https</p><p>Accept:application&#x2F;json, text&#x2F;plain, <em>&#x2F;</em></p><p>Accept-Encoding:gzip, deflate, br</p><p>Accept-Language:zh-CN,zh;q&#x3D;0.9,en;q&#x3D;0.8,en-US;q&#x3D;0.7,en-GB;q&#x3D;0.6</p><p>Cache-Control:no-cache</p><p>Cookie:na me&#x3D;1691121971; </p><p>Pragma:no-cache</p><p>Referer:<a href="https://cason.work/">https://cason.work/</a></p><p>Sec-Fetch-Dest:empty</p><p>Sec-Fetch-Mode:cors</p><p>Sec-Fetch-Site:same-origin</p><p>Token:***</p><p>User-Agent:Mozilla&#x2F;5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit&#x2F;605.1.15 (KHTML, like Gecko) Version&#x2F;13.0.3 Mobile&#x2F;15E148 Safari&#x2F;604.1 Edg&#x2F;115.0.0.0</p></blockquote></li><li><p><strong>æœåŠ¡å™¨å¤„ç†è¯·æ±‚</strong>ï¼š æœåŠ¡å™¨æ¥æ”¶åˆ°HTTPè¯·æ±‚åï¼Œä¼šæ ¹æ®è¯·æ±‚çš„å†…å®¹è¿›è¡Œå¤„ç†ã€‚å¦‚æœè¯·æ±‚çš„æ˜¯é™æ€èµ„æºï¼ˆä¾‹å¦‚HTMLæ–‡ä»¶ã€å›¾ç‰‡ç­‰ï¼‰ï¼ŒæœåŠ¡å™¨ä¼šä»æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–èµ„æºå¹¶è¿”å›ç»™æµè§ˆå™¨ã€‚å¦‚æœè¯·æ±‚éœ€è¦åº”ç”¨é€»è¾‘å¤„ç†ï¼ˆä¾‹å¦‚é€šè¿‡æŸç§ç¼–ç¨‹è¯­è¨€ç”ŸæˆåŠ¨æ€å†…å®¹ï¼‰ï¼ŒæœåŠ¡å™¨ä¼šå°†è¯·æ±‚è½¬å‘ç»™ç›¸åº”çš„åº”ç”¨æœåŠ¡ã€‚</p></li><li><p><strong>åº”ç”¨æœåŠ¡å¤„ç†</strong>ï¼š åº”ç”¨æœåŠ¡æ¥æ”¶åˆ°è¯·æ±‚åï¼Œæ ¹æ®è¯·æ±‚çš„å†…å®¹æ‰§è¡Œç›¸åº”çš„é€»è¾‘ã€‚è¿™å¯èƒ½åŒ…æ‹¬ä»æ•°æ®åº“ä¸­æ£€ç´¢æ•°æ®ã€å¤„ç†ä¸šåŠ¡é€»è¾‘ã€ç”ŸæˆåŠ¨æ€å†…å®¹ç­‰ã€‚</p></li><li><p><strong>ç”ŸæˆHTTPå“åº”</strong>ï¼š åº”ç”¨æœåŠ¡å¤„ç†å®Œè¯·æ±‚åï¼Œä¼šç”Ÿæˆä¸€ä¸ªHTTPå“åº”ã€‚è¿™ä¸ªå“åº”åŒ…æ‹¬äº†çŠ¶æ€ç ï¼ˆä¾‹å¦‚200è¡¨ç¤ºæˆåŠŸã€404è¡¨ç¤ºèµ„æºæœªæ‰¾åˆ°ç­‰ï¼‰ã€Headersï¼ˆä¾‹å¦‚Content-Typeã€Cache-Controlç­‰ï¼‰ä»¥åŠå®é™…çš„å“åº”å†…å®¹ã€‚</p><blockquote><details open=""><devtools-response-header-section style="display: block;"><devtools-header-section-row data-index="0" style="display: block; --override-error-background-color: #d93025; margin-top: 2px;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">Cache-Control:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">no-cache, no-store, max-age=0, must-revalidate<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 0; visibility: hidden; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row><devtools-header-section-row data-index="1" style="display: block; --override-error-background-color: #d93025;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">Content-Type:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">application/json<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 0; visibility: hidden; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row><devtools-header-section-row data-index="2" style="display: block; --override-error-background-color: #d93025;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">Date:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">Thu, 10 Aug 2023 11:47:23 GMT<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 0; visibility: hidden; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row><devtools-header-section-row data-index="3" style="display: block; --override-error-background-color: #d93025;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">Expires:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">0<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 0; visibility: hidden; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row><devtools-header-section-row data-index="4" style="display: block; --override-error-background-color: #d93025;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">Pragma:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">no-cache<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 1; visibility: visible; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row><devtools-header-section-row data-index="5" style="display: block; --override-error-background-color: #d93025;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">Server:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">nginx<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 0; visibility: hidden; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row><devtools-header-section-row data-index="6" style="display: block; --override-error-background-color: #d93025;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">Vary:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">Access-Control-Request-Headers<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 0; visibility: hidden; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row><devtools-header-section-row data-index="7" style="display: block; --override-error-background-color: #d93025;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">Vary:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">Access-Control-Request-Method<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 0; visibility: hidden; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row><devtools-header-section-row data-index="8" style="display: block; --override-error-background-color: #d93025;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">Vary:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">Origin<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 0; visibility: hidden; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row><devtools-header-section-row data-index="9" style="display: block; --override-error-background-color: #d93025;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">X-Content-Type-Options:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">nosniff<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 0; visibility: hidden; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row><devtools-header-section-row data-index="10" style="display: block; --override-error-background-color: #d93025;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">X-Frame-Options:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">DENY<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 0; visibility: hidden; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row><devtools-header-section-row data-index="11" style="display: block; --override-error-background-color: #d93025; margin-bottom: 10px;"><div class=" row " style="display: flex; line-height: 20px; padding-left: 8px; gap: 12px; user-select: text;"><div class=" header-name " style="color: var(--color-text-primary); font-weight: 400; width: 160px; flex-shrink: 0; text-transform: capitalize; overflow-wrap: break-word;">X-Xss-Protection:</div><div class=" header-value " style="display: flex; overflow-wrap: anywhere;">1; mode=block<devtools-button class="enable-editing inline-button" role="presentation" title="æ›¿ä»£æ ‡å¤´" style="display: inline-flex; flex-direction: row; vertical-align: middle; opacity: 0; visibility: hidden; transition: opacity 200ms ease 0s; padding-left: 2px;"><button class=" round only-icon small tiny explicit-size " style="margin: 0px; padding: 0px; box-sizing: border-box; --button-has-right-border-radius: calc(1 - var(--override-button-no-right-border-radius, 0)); --button-border-size: 1px; --button-height: 18px; --button-width: 18px; align-items: center; border-radius: 100%; display: inline-flex; font-family: inherit; font-size: 12px; font-weight: 500; height: var(--button-height); line-height: 14px; justify-content: center; width: var(--button-width); white-space: nowrap; background: transparent; border: none; overflow: hidden;"><devtools-icon style="display: inline-block; white-space: nowrap; position: relative; margin: 0px; padding: 0px; box-sizing: border-box; width: unset; height: unset; --icon-color: var(--icon-default);"><div class="icon-basic" style="width: 16px; height: 16px; display: block; -webkit-mask-image: url(&quot;devtools://devtools/bundled/Images/edit.svg&quot;); -webkit-mask-position: center center; -webkit-mask-repeat: no-repeat; -webkit-mask-size: 99%; background-color: var(--icon-color, var(--color-background));"></div></devtools-icon><slot style="margin: 0px; padding: 0px; box-sizing: border-box;"></slot></button></devtools-button></div></div></devtools-header-section-row></devtools-response-header-section></details></blockquote></li><li><p><strong>ä¼ è¾“HTTPå“åº”</strong>ï¼š æœåŠ¡å™¨å°†ç”Ÿæˆçš„HTTPå“åº”é€šè¿‡ä¹‹å‰å»ºç«‹çš„TCPè¿æ¥ä¼ è¾“å›æµè§ˆå™¨ã€‚</p></li><li><p><strong>æµè§ˆå™¨æ¥æ”¶å“åº”</strong>ï¼š æµè§ˆå™¨æ¥æ”¶åˆ°æœåŠ¡å™¨ä¼ å›çš„HTTPå“åº”ã€‚å®ƒä¼šæ ¹æ®å“åº”ä¸­çš„ä¿¡æ¯è¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚è§£æHTMLå†…å®¹ã€æ¸²æŸ“é¡µé¢ã€æ‰§è¡ŒJavaScriptä»£ç ç­‰ã€‚</p></li><li><p><strong>å…³é—­è¿æ¥</strong>ï¼š ä¸€æ—¦å“åº”ä¼ è¾“å®Œæ¯•ï¼Œæµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´çš„TCPè¿æ¥ä¼šè¢«å…³é—­ã€‚è¿™ä¸€æ­¥ç¡®ä¿è¿æ¥èµ„æºè¢«é‡Šæ”¾ã€‚</p></li></ol><p>æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªè¿‡ç¨‹æ¶‰åŠäº†å¤šä¸ªå…³é”®æ­¥éª¤ï¼ŒåŒ…æ‹¬URLè§£æã€DNSè§£æã€å»ºç«‹TCPè¿æ¥ã€å‘èµ·HTTPè¯·æ±‚ã€æœåŠ¡å™¨å¤„ç†ã€åº”ç”¨æœåŠ¡å¤„ç†ã€ç”ŸæˆHTTPå“åº”ã€ä¼ è¾“å“åº”ã€æµè§ˆå™¨å¤„ç†ç­‰ï¼Œæœ€ç»ˆå°†ç”¨æˆ·è¾“å…¥çš„URLè½¬åŒ–ä¸ºæµè§ˆå™¨ä¸Šå¯è§çš„ç½‘é¡µå†…å®¹ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¸€ä¸ªURLä»æµè§ˆå™¨è¾“å…¥åˆ°åº”ç”¨æœåŠ¡å¤„ç†çš„å®Œæ•´è¯·æ±‚è¿‡ç¨‹æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€è¦çš„æ¦‚è¿°ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;URLè§£æå’Œåˆ†æ&lt;/strong&gt;ï¼š ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥URLï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰ã€‚æµè§ˆå™¨éœ€è¦è§£æè¿™ä¸ªURLï¼Œå®ƒåŒ…æ‹¬åè®®ï¼ˆå¦‚httpã€htt</summary>
      
    
    
    
    
    <category term="é¢è¯•é—®é¢˜" scheme="https://cason.work/tags/%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98/"/>
    
    <category term="ç½‘ç»œ" scheme="https://cason.work/tags/%E7%BD%91%E7%BB%9C/"/>
    
  </entry>
  
  <entry>
    <title>obsidian git ios å¤šå¹³å°åŒæ­¥</title>
    <link href="https://cason.work/2023/04/20/obsidian-git-ios-%E5%A4%9A%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5/"/>
    <id>https://cason.work/2023/04/20/obsidian-git-ios-%E5%A4%9A%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5/</id>
    <published>2023-04-20T03:36:55.000Z</published>
    <updated>2023-04-23T14:22:09.563Z</updated>
    
    <content type="html"><![CDATA[<p>Obsidian æä¾›äº†å¤šç§æ•°æ®åŒæ­¥æ–¹å¼ï¼Œå…¶ä¸­å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹æ’ä»¶å®ç° Git åŒæ­¥ã€‚é€šè¿‡ Git åŒæ­¥ï¼Œä½ å¯ä»¥å°† Obsidian ä¸­çš„ç¬”è®°æ•°æ®ä¸Šä¼ åˆ° GitHubã€GitLabã€Bitbucket ç­‰ Git ä»“åº“ä¸­ï¼Œä»è€Œå®ç°åœ¨ iOS å’Œ Mac ç­‰ä¸åŒè®¾å¤‡ä¹‹é—´åŒæ­¥ç¬”è®°ã€‚</p><p>ä»¥ä¸‹æ˜¯å®ç° Obsidian Git åŒæ­¥çš„æ­¥éª¤ï¼š</p><h4 id="Macï¼š"><a href="#Macï¼š" class="headerlink" title="Macï¼š"></a>Macï¼š</h4><ol><li><p>åœ¨ä½ çš„ Git ä»“åº“ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œå¹¶å°†å…¶å…‹éš†åˆ°æœ¬åœ°è®¡ç®—æœºä¸Šã€‚</p></li><li><p>åœ¨ Obsidian ä¸­æ‰“å¼€è®¾ç½®ç•Œé¢ï¼Œé€‰æ‹©ã€Œç¬¬ä¸‰æ–¹æ’ä»¶ã€é€‰é¡¹å¡ï¼Œå®‰è£…å¹¶å¯ç”¨ã€ŒObsidian Gitã€æ’ä»¶ã€‚</p><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202304201140960.png" alt="image-20230420114013073"></p></li><li><p>åœ¨ Obsidian Gitè®¾ç½®ç•Œé¢ä¸­ï¼Œç‚¹å‡»å¼€å¯è‡ªåŠ¨commitå’Œpushï¼Œå¹¶è®¾ç½®æ—¶é—´ã€‚</p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202304201142184.png" alt="image-20230420114154147" style="zoom:50%;" /></li></ol><p>æ­¤æ—¶ï¼ŒObsidian ä¸­çš„ç¬”è®°æ•°æ®å°†è¢«åŒæ­¥åˆ° Git ä»“åº“ä¸­</p><h4 id="IOS"><a href="#IOS" class="headerlink" title="IOS"></a>IOS</h4><ol><li>apple storeä¸‹è½½ISH</li></ol><p><img src="https://raw.githubusercontent.com/CasonMo/pic-go/master/img/202304201146055.png" alt="image-20230420114624522"></p><ol start="2"><li><p>æ‰“å¼€ISHæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><ol><li>å®‰è£…git</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs shell">apk add git<br></code></pre></td></tr></table></figure><ol start="2"><li>ç”¨äºåœ¨å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º â€œobsidianâ€ çš„æ–°æ–‡ä»¶å¤¹</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd ~ &amp;&amp; mkdir obsidian<br></code></pre></td></tr></table></figure><ol start="3"><li>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¼šæ‰“å¼€æ‰‹æœºæ–‡ä»¶ç®¡ç†å™¨ï¼Œä¹‹åéœ€è¦é€‰ä¸­æœ¬åœ°çš„obsidianæ–‡ä»¶å¤¹ï¼Œç‚¹å‡»å®Œæˆã€‚è¿™æ ·å°±è®©obsidianè½¯ä»¶ä¸­çš„mathæ–‡ä»¶å¤¹ï¼Œè£…è½½åˆ°ishä¸Šçš„obsidianæ–‡ä»¶å¤¹å†… ï¼Œä¹‹åå¯¹äºobsidianè½¯ä»¶å†…mathæ–‡ä»¶çš„ä¿®æ”¹ï¼ŒiSHä¸Šä¹ŸåŒæ­¥ä¿®æ”¹</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mount -t ios . obsidian<br></code></pre></td></tr></table></figure><ol start="4"><li>é€šè¿‡cdå‘½ä»¤ï¼Œè¿›å…¥obsidianæ–‡ä»¶å¤¹å†…</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd ~/obsidian<br></code></pre></td></tr></table></figure><ol start="5"><li>Git å…‹éš†ä»“åº“åˆ°obsidianç›®å½•,è¾“å…¥è´¦å·å’Œå¯†ç ï¼ˆgithub personal access keyï¼‰</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git clone https://xxxxxx.git<br></code></pre></td></tr></table></figure></li><li><p>æ‰“å¼€obsidianå°±ä¼šçœ‹åˆ°ä½ çš„ä»“åº“å’¯ï¼Œç„¶åæ‰“å¼€Obsidian Gité…ç½®ï¼Œgitè´¦å·å¯†ç </p></li></ol><h4 id="å¼‚å¸¸è§£å†³"><a href="#å¼‚å¸¸è§£å†³" class="headerlink" title="å¼‚å¸¸è§£å†³"></a>å¼‚å¸¸è§£å†³</h4><p>å¦‚æœé‡åˆ°git clone ä¸€ç›´å¡ç€ å¤šæ¬¡å°è¯•éƒ½æ— æ³•cloneæˆåŠŸçš„</p><ol><li>å…ˆåˆ›å»ºç›®å½•å¹¶è¿›å…¥ç›®å½•</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir ï½/obsidian/ç›®å½•å<br>cd ï½/obsidian/ç›®å½•å<br></code></pre></td></tr></table></figure><ol start="2"><li>åˆå§‹åŒ–gitä»“åº“</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git init<br></code></pre></td></tr></table></figure><ol start="3"><li>å°†ä¸€ä¸ªåä¸º â€œsafe.directoryâ€ çš„ Git å…¨å±€é…ç½®è®¾ç½®æ·»åŠ åˆ°æ‚¨çš„ Git ç¯å¢ƒä¸­ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸º â€œ <del>&#x2F;obsidian&#x2F;ç›®å½•åâ€ ç›®å½•ã€‚è¿™ä¸ªå…¨å±€é…ç½®è®¾ç½®è¢«æ·»åŠ åˆ°æ‚¨çš„ â€œ</del>&#x2F;.gitconfigâ€ æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å¯ä»¥è¢«æ‰€æœ‰åœ¨æ‚¨çš„æœ¬åœ°æœºå™¨ä¸Šè¿è¡Œçš„ Git ä»“åº“ä½¿ç”¨ï¼Œä»¥ç¡®ä¿å®ƒä»¬éƒ½çŸ¥é“æ‚¨é€‰æ‹©çš„å®‰å…¨ç›®å½•çš„ä½ç½®ã€‚è¿™ä¸ªå‘½ä»¤æ˜¯ä¸ºäº†å¸®åŠ©æ‚¨ä¿æŠ¤æ‚¨çš„ä¸ªäººã€æ•æ„Ÿæˆ–é‡è¦çš„ Git ä»“åº“ï¼Œä»¥é˜²æ­¢åœ¨é”™è¯¯çš„ä½ç½®æˆ–å—åˆ°æ”»å‡»çš„è®¡ç®—æœºä¸Šæ³„éœ²ã€‚</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git config --global --add safe.directory ~/obsidian/ç›®å½•å<br></code></pre></td></tr></table></figure><ol start="4"><li>å½“ Git æ‰“åŒ…ä¸€ä¸ªä»“åº“çš„å¯¹è±¡æ—¶ï¼Œä¼šå°†è¿™äº›å¯¹è±¡å‹ç¼©æˆä¸€ä¸ªæ–‡ä»¶å­˜å‚¨åœ¨ Git å¯¹è±¡åº“ä¸­ã€‚è¿™ä¸ªæ“ä½œéå¸¸è€—è´¹èµ„æºï¼Œå› æ­¤ä½¿ç”¨å¤šçº¿ç¨‹å¤„ç†å¯ä»¥åŠ é€Ÿæ‰“åŒ…è¿‡ç¨‹ã€‚è®¾ç½® â€œpack.threadsâ€ ä¸º 1 æ„å‘³ç€ Git å°†ä½¿ç”¨å•çº¿ç¨‹è¿›è¡Œæ‰“åŒ…æ“ä½œï¼Œè¿™æ ·å¯èƒ½ä¼šå‡ç¼“æ‰“åŒ…é€Ÿåº¦ï¼Œä½†æ˜¯ä¹Ÿèƒ½å¤Ÿå‡å°‘è®¡ç®—æœºçš„ CPU å’Œå†…å­˜è´Ÿè½½ã€‚</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git config pack.threads 1<br></code></pre></td></tr></table></figure><ol start="5"><li>ä»è¿œç¨‹ä»“åº“è·å–æœ€æ–°çš„æäº¤å’Œå¯¹è±¡ï¼Œä½†æ˜¯ä¸ä¼šå°†å®ƒä»¬åˆå¹¶åˆ°å½“å‰çš„æœ¬åœ°åˆ†æ”¯ä¸­ã€‚å®ƒé€šå¸¸è¢«ç”¨æ¥æ£€æŸ¥è¿œç¨‹ä»“åº“ä¸­çš„æœ€æ–°å˜æ›´ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°è¿›è¡Œæ›´æ–°æˆ–è€…åˆå¹¶æ“ä½œä¹‹å‰å…ˆäº†è§£è¿™äº›å˜æ›´ã€‚</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git fetch<br></code></pre></td></tr></table></figure><ol start="7"><li>å¦‚æœæƒ³è¦æ‹‰å–æœ€æ–°çš„ä»£ç å¹¶è‡ªåŠ¨å°†å…¶åˆå¹¶åˆ°æœ¬åœ°åˆ†æ”¯ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>git pull</code> å‘½ä»¤ã€‚ä½†æ˜¯å¦‚æœåªæ˜¯æƒ³è¦çŸ¥é“è¿œç¨‹ä»“åº“çš„æœ€æ–°çŠ¶æ€ï¼Œè€Œä¸ä¼šæ”¹å˜å½“å‰çš„æœ¬åœ°åˆ†æ”¯çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨ <code>git fetch</code>ã€‚è¿™æ ·å¯ä»¥é¿å…ä¸å¿…è¦çš„åˆå¹¶å†²çªï¼Œæé«˜å·¥ä½œæ•ˆç‡ã€‚</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git pull<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Obsidian æä¾›äº†å¤šç§æ•°æ®åŒæ­¥æ–¹å¼ï¼Œå…¶ä¸­å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹æ’ä»¶å®ç° Git åŒæ­¥ã€‚é€šè¿‡ Git åŒæ­¥ï¼Œä½ å¯ä»¥å°† Obsidian ä¸­çš„ç¬”è®°æ•°æ®ä¸Šä¼ åˆ° GitHubã€GitLabã€Bitbucket ç­‰ Git ä»“åº“ä¸­ï¼Œä»è€Œå®ç°åœ¨ iOS å’Œ Mac ç­‰ä¸åŒè®¾å¤‡ä¹‹é—´åŒæ­¥ç¬”è®°</summary>
      
    
    
    
    <category term="obsidian" scheme="https://cason.work/categories/obsidian/"/>
    
    
    <category term="obsidian" scheme="https://cason.work/tags/obsidian/"/>
    
  </entry>
  
  <entry>
    <title>Mysqläº‹åŠ¡</title>
    <link href="https://cason.work/2023/04/17/Mysql%E4%BA%8B%E5%8A%A1/"/>
    <id>https://cason.work/2023/04/17/Mysql%E4%BA%8B%E5%8A%A1/</id>
    <published>2023-04-17T09:28:00.000Z</published>
    <updated>2023-04-19T08:12:49.251Z</updated>
    
    <content type="html"><![CDATA[<p>æ•°æ®åº“äº‹åŠ¡æ˜¯æŒ‡ä¸€ç»„æ•°æ®åº“æ“ä½œï¼Œå®ƒä»¬ä½œä¸ºä¸€ä¸ªé€»è¾‘å•å…ƒä¸€èµ·æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚åœ¨æ•°æ®åº“ä¸­ï¼Œäº‹åŠ¡é€šå¸¸ç”¨äºæ‰§è¡Œä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œï¼Œæ¯”å¦‚æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤å¤šæ¡è®°å½•ç­‰ã€‚</p><h3 id="äº‹åŠ¡ç‰¹æ€§"><a href="#äº‹åŠ¡ç‰¹æ€§" class="headerlink" title="äº‹åŠ¡ç‰¹æ€§"></a>äº‹åŠ¡ç‰¹æ€§</h3><p>äº‹åŠ¡å…·æœ‰ä»¥ä¸‹å››ä¸ªç‰¹æ€§ï¼Œé€šå¸¸ç§°ä¸º ACID ç‰¹æ€§ï¼š</p><ol><li>åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œï¼Œä¸å…è®¸å‡ºç°éƒ¨åˆ†æ‰§è¡Œçš„æƒ…å†µã€‚</li><li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡æ‰§è¡Œå‰å’Œæ‰§è¡Œåï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§çº¦æŸæ²¡æœ‰è¢«ç ´åã€‚</li><li>éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šå¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ï¼Œæ¯ä¸ªäº‹åŠ¡éƒ½åº”è¯¥æ„Ÿè§‰ä¸åˆ°å…¶ä»–äº‹åŠ¡çš„å­˜åœ¨ï¼Œå„ä¸ªäº‹åŠ¡ä¹‹é—´åº”è¯¥ç›¸äº’éš”ç¦»ã€‚</li><li>æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡ä¸€æ—¦æäº¤æˆåŠŸï¼Œå…¶ç»“æœå°±åº”è¯¥æ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå³ä½¿å‡ºç°ç³»ç»Ÿæ•…éšœä¹Ÿä¸åº”è¯¥ä¸¢å¤±ã€‚</li></ol><h3 id="è„è¯»"><a href="#è„è¯»" class="headerlink" title="è„è¯»"></a>è„è¯»</h3><p>è„è¯»ï¼ˆDirty Readï¼‰æ˜¯æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¯»å–äº†å¦ä¸€ä¸ªäº‹åŠ¡å°šæœªæäº¤çš„æ•°æ®ã€‚åœ¨è„è¯»çš„æƒ…å†µä¸‹ï¼Œè¯»å–åˆ°çš„æ•°æ®å¯èƒ½æ˜¯ä¸å‡†ç¡®çš„ï¼Œå› ä¸ºè¿™äº›æ•°æ®å¯èƒ½ä¼šè¢«å¦ä¸€ä¸ªäº‹åŠ¡æ’¤é”€æˆ–ä¿®æ”¹ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸¤ä¸ªäº‹åŠ¡ A å’Œ Bï¼Œäº‹åŠ¡ A åœ¨è¯»å–äº†ä¸€æ¡æ•°æ®ä¹‹åï¼Œäº‹åŠ¡ B ä¿®æ”¹äº†è¯¥æ•°æ®ï¼Œä½†æ˜¯å°šæœªæäº¤ã€‚å¦‚æœæ­¤æ—¶äº‹åŠ¡ A å†æ¬¡è¯»å–è¯¥æ•°æ®ï¼Œé‚£ä¹ˆå°±ä¼šè¯»å–åˆ°äº‹åŠ¡ B ä¿®æ”¹åçš„æ•°æ®ï¼Œè€Œè¿™ä¸ªæ•°æ®å¯èƒ½æ˜¯ä¸å‡†ç¡®çš„ã€‚</p><h3 id="ä¸å¯é‡å¤è¯»"><a href="#ä¸å¯é‡å¤è¯»" class="headerlink" title="ä¸å¯é‡å¤è¯»"></a>ä¸å¯é‡å¤è¯»</h3><p>åœ¨æ•°æ®åº“äº‹åŠ¡ä¸­ï¼Œä¸å¯é‡å¤è¯»æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå¤šæ¬¡è¯»å–åŒä¸€ä¸ªæ•°æ®æ—¶å¾—åˆ°çš„ç»“æœå¯èƒ½ä¸åŒã€‚è¿™é€šå¸¸æ˜¯ç”±äºåœ¨äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œå¦ä¸€ä¸ªå¹¶å‘çš„äº‹åŠ¡ä¿®æ”¹äº†åŒä¸€ä¸ªæ•°æ®æ‰€å¯¼è‡´çš„ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œè¯´æ˜ä¸å¯é‡å¤è¯»çš„æƒ…å†µï¼š</p><ol><li>äº‹åŠ¡T1è¯»å–æ•°æ®Xï¼Œè·å¾—ç»“æœAã€‚</li><li>åœ¨T1è¯»å–æ•°æ®Xä¹‹åï¼Œäº‹åŠ¡T2ä¿®æ”¹äº†æ•°æ®Xï¼Œå°†å…¶æ›´æ”¹ä¸ºBã€‚</li><li>äº‹åŠ¡T1å†æ¬¡è¯»å–æ•°æ®Xï¼Œæ­¤æ—¶è·å¾—ç»“æœBï¼Œä¸ç¬¬ä¸€æ¬¡è¯»å–æ—¶çš„ç»“æœä¸åŒã€‚</li></ol><h3 id="å¹»è¯»"><a href="#å¹»è¯»" class="headerlink" title="å¹»è¯»"></a>å¹»è¯»</h3><p>åœ¨æ•°æ®åº“äº‹åŠ¡ä¸­ï¼Œå¹»è¯»æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡è¯»å–åŒä¸€ä¸ªèŒƒå›´å†…çš„è®°å½•æ—¶ï¼Œå¾—åˆ°çš„ç»“æœå¯èƒ½ä¸åŒã€‚è¿™é€šå¸¸æ˜¯ç”±äºåœ¨äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œå¦ä¸€ä¸ªå¹¶å‘çš„äº‹åŠ¡æ’å…¥æˆ–åˆ é™¤äº†ä¸€äº›è®°å½•æ‰€å¯¼è‡´çš„ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œè¯´æ˜å¹»è¯»çš„æƒ…å†µï¼š</p><ol><li>äº‹åŠ¡T1è¯»å–æ•°æ®é›†Xï¼Œè·å¾—ç»“æœAã€‚</li><li>åœ¨T1è¯»å–æ•°æ®é›†Xä¹‹åï¼Œäº‹åŠ¡T2åœ¨æ•°æ®é›†Xä¸­æ’å…¥äº†ä¸€æ¡æ–°çš„è®°å½•ï¼Œè¿™æ¡è®°å½•ä¸åœ¨T1çš„ç»“æœé›†ä¸­ã€‚</li><li>äº‹åŠ¡T1å†æ¬¡è¯»å–æ•°æ®é›†Xï¼Œæ­¤æ—¶è·å¾—ç»“æœBï¼Œå…¶ä¸­åŒ…å«äº†T2æ’å…¥çš„æ–°è®°å½•ã€‚</li></ol><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼ŒT1çš„ä¸¤æ¬¡è¯»å–ä¹‹é—´çš„å·®å¼‚å°±æ˜¯å¹»è¯»çš„ç»“æœã€‚</p><h3 id="äº‹åŠ¡éš”ç¦»çº§åˆ«"><a href="#äº‹åŠ¡éš”ç¦»çº§åˆ«" class="headerlink" title="äº‹åŠ¡éš”ç¦»çº§åˆ«"></a>äº‹åŠ¡éš”ç¦»çº§åˆ«</h3><p>æ•°æ®åº“äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯æŒ‡å¤šä¸ªäº‹åŠ¡ä¹‹é—´ç›¸äº’éš”ç¦»çš„ç¨‹åº¦ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®éš”ç¦»çº§åˆ«æ¥æ§åˆ¶äº‹åŠ¡ä¹‹é—´çš„å¹¶å‘æ€§å’Œæ•°æ®ä¸€è‡´æ€§ã€‚å¸¸è§çš„éš”ç¦»çº§åˆ«æœ‰å››ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ol><li>è¯»æœªæäº¤ï¼ˆRead Uncommittedï¼‰ï¼šåœ¨è¿™ä¸ªéš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»å–å¦ä¸€ä¸ªäº‹åŠ¡å°šæœªæäº¤çš„æ•°æ®ï¼Œä¼šå‡ºç°è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»çš„é—®é¢˜ã€‚</li><li>è¯»å·²æäº¤ï¼ˆRead Committedï¼‰ï¼šåœ¨è¿™ä¸ªéš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸€ä¸ªäº‹åŠ¡åªèƒ½è¯»å–å¦ä¸€ä¸ªäº‹åŠ¡å·²ç»æäº¤çš„æ•°æ®ï¼Œå¯ä»¥é¿å…è„è¯»çš„é—®é¢˜ï¼Œä½†æ˜¯ä»ç„¶ä¼šå‡ºç°ä¸å¯é‡å¤è¯»å’Œå¹»è¯»çš„é—®é¢˜ã€‚</li><li>å¯é‡å¤è¯»ï¼ˆRepeatable Readï¼‰ï¼šåœ¨è¿™ä¸ªéš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸€ä¸ªäº‹åŠ¡åœ¨æ‰§è¡ŒæœŸé—´å¤šæ¬¡è¯»å–åŒä¸€æ¡è®°å½•çš„æ•°æ®æ—¶ï¼Œä¼šä¿è¯æ¯æ¬¡è¯»å–çš„æ•°æ®éƒ½ç›¸åŒï¼Œå¯ä»¥é¿å…è„è¯»å’Œä¸å¯é‡å¤è¯»çš„é—®é¢˜ï¼Œä½†æ˜¯ä»ç„¶ä¼šå‡ºç°å¹»è¯»çš„é—®é¢˜ã€‚</li><li>ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ï¼šåœ¨è¿™ä¸ªéš”ç¦»çº§åˆ«ä¸‹ï¼Œæ‰€æœ‰çš„äº‹åŠ¡éƒ½æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ï¼Œæ¯ä¸ªäº‹åŠ¡å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå®Œæˆåæ‰èƒ½æ‰§è¡Œï¼Œå¯ä»¥é¿å…è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»çš„é—®é¢˜ï¼Œä½†æ˜¯ä¼šé™ä½ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½ã€‚</li></ol><h3 id="log"><a href="#log" class="headerlink" title="log"></a>log</h3><h4 id="redo-log"><a href="#redo-log" class="headerlink" title="redo log"></a>redo log</h4><p>åœ¨ MySQL ä¸­ï¼Œredo log æ˜¯ä¸€ç§ç”¨äºå´©æºƒæ¢å¤å’Œäº‹åŠ¡æŒä¹…åŒ–çš„æœºåˆ¶ã€‚redo log è®°å½•äº†æ‰€æœ‰çš„ä¿®æ”¹æ“ä½œï¼Œå³äº‹åŠ¡å¯¹æ•°æ®åº“ä¸­æ•°æ®æ‰€åšçš„æ‰€æœ‰ä¿®æ”¹ã€‚å½“ MySQL åœ¨å´©æºƒåé‡æ–°å¯åŠ¨æ—¶ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ redo log æ¥æ¢å¤æœ€åä¸€æ¬¡å´©æºƒä¹‹å‰æäº¤çš„äº‹åŠ¡ã€‚</p><p>redo log æ˜¯åŸºäºç£ç›˜çš„æ—¥å¿—ï¼Œå®ƒæ˜¯å¾ªç¯å†™å…¥çš„ï¼Œå½“æ‰€æœ‰çš„ redo log è¢«å†™æ»¡ä¹‹åï¼ŒMySQL å°†ä» redo log çš„å¼€å¤´é‡æ–°å¼€å§‹å†™å…¥ã€‚redo log å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œå› æ­¤å®ƒä¸ä¼šæ¶ˆè€—è¿‡å¤šçš„å†…å­˜ã€‚</p><p>redo log çš„å·¥ä½œåŸç†æ˜¯ï¼šå½“ä¸€ä¸ªäº‹åŠ¡å¼€å§‹æ—¶ï¼Œæ‰€æœ‰çš„ä¿®æ”¹æ“ä½œéƒ½è¢«è®°å½•åˆ° redo log ä¸­ï¼Œä½†å®é™…çš„æ•°æ®ä¿®æ”¹æ“ä½œä¸ä¼šç«‹å³è¢«æ‰§è¡Œã€‚ç›¸åï¼Œå®ƒä»¬ä¼šè¢«æš‚æ—¶ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç­‰åˆ°äº‹åŠ¡æäº¤æ—¶ï¼ŒMySQL æ‰ä¼šå°†å…¶å†™å…¥ç£ç›˜ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†å‡å°‘ç£ç›˜å†™å…¥çš„æ¬¡æ•°ï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚</p><p>å½“ MySQL å‘ç”Ÿå´©æºƒæˆ–éæ­£å¸¸å…³é—­æ—¶ï¼Œredo log å°±å‘æŒ¥äº†é‡è¦çš„ä½œç”¨ã€‚MySQL åœ¨é‡æ–°å¯åŠ¨æ—¶ï¼Œä¼šæ£€æŸ¥ redo log ä¸­å°šæœªæäº¤çš„äº‹åŠ¡ï¼Œç„¶åå°†å…¶é‡æ–°æ‰§è¡Œï¼Œä»¥ä¿è¯æ•°æ®åº“çŠ¶æ€çš„ä¸€è‡´æ€§ã€‚</p><h4 id="undo-log"><a href="#undo-log" class="headerlink" title="undo log"></a>undo log</h4><p>åœ¨ MySQL ä¸­ï¼Œundo log æ˜¯ç”¨äºäº‹åŠ¡å›æ»šå’Œ MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰å®ç°çš„æœºåˆ¶ã€‚å½“ä¸€ä¸ªäº‹åŠ¡å¼€å§‹æ—¶ï¼ŒMySQL ä¼šåˆ›å»ºä¸€ä¸ª undo log æ¥è®°å½•è¯¥äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹æ“ä½œã€‚å½“äº‹åŠ¡è¢«å›æ»šæ—¶ï¼ŒMySQL å°±ä¼šä½¿ç”¨ undo log å°†æ•°æ®æ¢å¤åˆ°äº‹åŠ¡å¼€å§‹ä¹‹å‰çš„çŠ¶æ€ã€‚</p><p>ä¸ redo log ä¸åŒçš„æ˜¯ï¼Œundo log è®°å½•çš„æ˜¯åŸå§‹æ•°æ®çš„â€œæ—§å€¼â€ï¼Œè€Œä¸æ˜¯æ–°çš„ä¿®æ”¹å€¼ã€‚å› æ­¤ï¼Œåœ¨äº‹åŠ¡å›æ»šæ—¶ï¼ŒMySQL å¯ä»¥ä½¿ç”¨ undo log å°†æ•°æ®æ¢å¤åˆ°äº‹åŠ¡å¼€å§‹ä¹‹å‰çš„çŠ¶æ€ã€‚æ­¤å¤–ï¼Œundo log è¿˜å¯ä»¥ç”¨äºæ”¯æŒ MVCC å®ç°ï¼ŒMVCC å…è®¸å¤šä¸ªäº‹åŠ¡åŒæ—¶è¯»å–åŒä¸€ä¸ªæ•°æ®é¡¹ï¼Œè€Œä¸ä¼šäº’ç›¸å¹²æ‰°ã€‚</p><p>undo log å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œä½†å®ƒä»¬é€šå¸¸å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ä¸´æ—¶ç¼“å†²åŒºä¸­ã€‚å½“äº‹åŠ¡æäº¤æ—¶ï¼ŒMySQL ä¼šå°†å…¶å¯¹åº”çš„ undo log ä»å†…å­˜ä¸­å†™å…¥ç£ç›˜ä¸­çš„ undo log æ–‡ä»¶ä¸­ã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡è¿˜æ²¡æœ‰æäº¤ï¼Œé‚£ä¹ˆå®ƒçš„ undo log å°±ä¸ä¼šè¢«å†™å…¥ç£ç›˜ï¼Œè¿™æ ·å¯ä»¥é¿å…å†™å…¥ç£ç›˜çš„å¼€é”€ã€‚</p><h4 id="bin-log"><a href="#bin-log" class="headerlink" title="bin log"></a>bin log</h4><p>åœ¨ MySQL ä¸­ï¼Œbin log æ˜¯ç”¨äºæ•°æ®å¤‡ä»½ã€æ¢å¤ä»¥åŠå¤åˆ¶çš„æœºåˆ¶ã€‚bin log è®°å½•äº† MySQL ä¸­æ‰€æœ‰ä¿®æ”¹æ•°æ®çš„æ“ä½œï¼ŒåŒ…æ‹¬å¯¹æ•°æ®çš„æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤ç­‰æ“ä½œã€‚</p><p>bin log å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œå¯ä»¥ç”¨æ¥æ¢å¤æ•°æ®æˆ–å¤åˆ¶æ•°æ®åˆ°å…¶ä»– MySQL å®ä¾‹ã€‚å› æ­¤ï¼Œbin log å¯ä»¥ç”¨äºæ•°æ®å¤‡ä»½å’Œæ¢å¤ï¼Œä¹Ÿå¯ä»¥ç”¨äºä¸»ä»å¤åˆ¶ï¼Œå°†ä¸€ä¸ª MySQL å®ä¾‹çš„æ•°æ®å¤åˆ¶åˆ°å…¶ä»– MySQL å®ä¾‹ã€‚</p><p>bin log çš„å·¥ä½œåŸç†æ˜¯ï¼šå½“ä¸€ä¸ªäº‹åŠ¡å¼€å§‹æ—¶ï¼ŒMySQL ä¼šå°†æ‰€æœ‰çš„ä¿®æ”¹æ“ä½œè®°å½•åˆ° bin log ä¸­ã€‚å½“äº‹åŠ¡æäº¤æ—¶ï¼ŒMySQL å°†äº‹åŠ¡çš„æäº¤ä¿¡æ¯ä¸€å¹¶è®°å½•åˆ° bin log ä¸­ã€‚å› æ­¤ï¼Œbin log ä¸­ä¸ä»…åŒ…å«æ•°æ®çš„ä¿®æ”¹æ“ä½œï¼Œè¿˜åŒ…å«äº†äº‹åŠ¡æäº¤çš„æ—¶é—´ã€äº‹åŠ¡ ID ç­‰ä¿¡æ¯ã€‚</p><p>bin log æœ‰å¤šç§æ ¼å¼ï¼ŒåŒ…æ‹¬ statementã€row å’Œ mixed ç­‰æ ¼å¼ã€‚å…¶ä¸­ï¼Œstatement æ ¼å¼è®°å½•çš„æ˜¯ SQL è¯­å¥ï¼Œrow æ ¼å¼è®°å½•çš„æ˜¯è¡Œçº§åˆ«çš„å˜åŒ–ï¼Œmixed æ ¼å¼æ˜¯ä¸¤è€…çš„ç»“åˆã€‚</p><h4 id="äº‹åŠ¡ä¸­æ—¥å¿—æ‰§è¡Œæµç¨‹"><a href="#äº‹åŠ¡ä¸­æ—¥å¿—æ‰§è¡Œæµç¨‹" class="headerlink" title="äº‹åŠ¡ä¸­æ—¥å¿—æ‰§è¡Œæµç¨‹"></a>äº‹åŠ¡ä¸­æ—¥å¿—æ‰§è¡Œæµç¨‹</h4><ol><li><p>è®°å½•undo logï¼Œå°†ä¿®æ”¹å‰çš„æ•°æ®è®°å½•åˆ°undoLogä¸­ï¼Œä»¥ä¾¿åœ¨äº‹åŠ¡å›æ»šæ—¶æ¢å¤åŸæ¥çš„æ•°æ®ã€‚</p></li><li><p>æ‰§è¡Œäº‹åŠ¡ä¸­çš„SQLè¯­å¥ï¼Œè¿™äº›è¯­å¥ä¼šä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚</p></li><li><p>è®°å½•redo logï¼Œå°†ä¿®æ”¹åçš„æ•°æ®å†™å…¥åˆ°ç£ç›˜ä¸Šçš„æ•°æ®æ–‡ä»¶ä¸­ï¼Œä¿è¯äº‹åŠ¡çš„æŒä¹…æ€§ã€‚</p></li><li><p>è®°å½•bin logï¼Œå°†æ‰§è¡Œçš„SQLè¯­å¥è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼Œä»¥ä¾¿ç”¨äºä¸»ä»åŒæ­¥å’Œæ•°æ®æ¢å¤ç­‰ã€‚</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æ•°æ®åº“äº‹åŠ¡æ˜¯æŒ‡ä¸€ç»„æ•°æ®åº“æ“ä½œï¼Œå®ƒä»¬ä½œä¸ºä¸€ä¸ªé€»è¾‘å•å…ƒä¸€èµ·æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚åœ¨æ•°æ®åº“ä¸­ï¼Œäº‹åŠ¡é€šå¸¸ç”¨äºæ‰§è¡Œä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œï¼Œæ¯”å¦‚æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤å¤šæ¡è®°å½•ç­‰ã€‚&lt;/p&gt;
&lt;h3 id=&quot;äº‹åŠ¡ç‰¹æ€§&quot;&gt;&lt;a href=&quot;#äº‹åŠ¡ç‰¹æ€§&quot; class=&quot;headerlink</summary>
      
    
    
    
    <category term="mysql" scheme="https://cason.work/categories/mysql/"/>
    
    
    <category term="mysql" scheme="https://cason.work/tags/mysql/"/>
    
  </entry>
  
</feed>
